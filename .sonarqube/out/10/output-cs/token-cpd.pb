û'
KC:\Users\SWDEV\Source\Repos\SW10.SWMANAGER\NFe\NFe.Integracao\NFeBuilder.cs
	namespace** 	
NFe**
 
.** 

Integracao** 
{++ 
public00 

class00 

NFeBuilder00 
{11 
private22 
readonly22 
IList22 
<22 
Classes22 &
.22& '
NFe22' *
>22* +
_nFe22, 0
;220 1
public44 

NFeBuilder44 
(44 
string44  
pathArquivoXml44! /
,44/ 0

TipoXmlNFe441 ;
tipo44< @
)44@ A
{55 	
_nFe66 
=66 
new66 
List66 
<66 
Classes66 #
.66# $
NFe66$ '
>66' (
(66( )
)66) *
;66* +
try88 
{99 
var:: 
reader:: 
=:: 
new::  
StringReader::! -
(::- .
File::. 2
.::2 3
ReadAllText::3 >
(::> ?
pathArquivoXml::? M
)::M N
)::N O
;::O P
switch;; 
(;; 
tipo;; 
);; 
{<< 
case== 

TipoXmlNFe== #
.==# $
Destinatario==$ 0
:==0 1
{>> 
var?? 
desserializador??  /
=??0 1
new??2 5
XmlSerializer??6 C
(??C D
typeof??D J
(??J K
nfeProc??K R
)??R S
)??S T
;??T U
_nFe@@  
.@@  !
Add@@! $
(@@$ %
(@@% &
(@@& '
nfeProc@@' .
)@@. /
desserializador@@/ >
.@@> ?
Deserialize@@? J
(@@J K
reader@@K Q
)@@Q R
)@@R S
.@@S T
NFe@@T W
)@@W X
;@@X Y
}AA 
breakBB 
;BB 
caseCC 

TipoXmlNFeCC #
.CC# $
LoteCC$ (
:CC( )
{DD 
varEE 
desserializadorEE  /
=EE0 1
newEE2 5
XmlSerializerEE6 C
(EEC D
typeofEED J
(EEJ K
enviNFe3EEK S
)EES T
)EET U
;EEU V
_nFeFF  
=FF! "
(FF# $
(FF$ %
enviNFe3FF% -
)FF- .
desserializadorFF. =
.FF= >
DeserializeFF> I
(FFI J
readerFFJ P
)FFP Q
)FFQ R
.FFR S
NFeFFS V
;FFV W
}GG 
breakHH 
;HH 
caseII 

TipoXmlNFeII #
.II# $
NFeII$ '
:II' (
breakJJ 
;JJ 
defaultKK 
:KK 
{LL 
varMM 
desserializadorMM  /
=MM0 1
newMM2 5
XmlSerializerMM6 C
(MMC D
typeofMMD J
(MMJ K
ClassesMMK R
.MMR S
NFeMMS V
)MMV W
)MMW X
;MMX Y
_nFeNN  
.NN  !
AddNN! $
(NN$ %
(NN% &
(NN& '
ClassesNN' .
.NN. /
NFeNN/ 2
)NN2 3
desserializadorNN3 B
.NNB C
DeserializeNNC N
(NNN O
readerNNO U
)NNU V
)NNV W
)NNW X
;NNX Y
}OO 
breakPP 
;PP 
}QQ 
}RR 
catchSS 
(SS 
	ExceptionSS 
exSS 
)SS  
{TT 
throwUU 
newUU  
InvalidDataExceptionUU .
(UU. /
$strUU/ F
,UUF G
exUUH J
)UUJ K
;UUK L
}VV 
}WW 	
public]] 
Classes]] 
.]] 
NFe]] 
Build]]  
(]]  !
)]]! "
{^^ 	
if__ 
(__ 
_nFe__ 
.__ 
Count__ 
<=__ 
$num__ 
)__  
throw`` 
new`` %
InvalidOperationException`` 3
(``3 4
$str``4 g
)``g h
;``h i
varaa 
nfeaa 
=aa 
_nFeaa 
[aa 
_nFeaa 
.aa  
Countaa  %
-aa& '
$numaa( )
]aa) *
;aa* +
_nFebb 
.bb 
Removebb 
(bb 
nfebb 
)bb 
;bb 
returncc 
nfecc 
;cc 
}dd 	
publicjj 
IListjj 
<jj 
Classesjj 
.jj 
NFejj  
>jj  !
BuildAlljj" *
(jj* +
)jj+ ,
{kk 	
ifll 
(ll 
_nFell 
.ll 
Countll 
<=ll 
$numll 
)ll  
throwmm 
newmm %
InvalidOperationExceptionmm 3
(mm3 4
$strmm4 g
)mmg h
;mmh i
returnnn 
_nFenn 
;nn 
}oo 	
}pp 
}qq ¡Ô
HC:\Users\SWDEV\Source\Repos\SW10.SWMANAGER\NFe\NFe.Integracao\Program.cs
	namespace-- 	
NFe--
 
.-- 

Integracao-- 
{.. 
public// 

class// 
Program// 
{00 
public22 
static22 
void22 
Main22 
(22  
string22  &
[22& '
]22' (
args22) -
)22- .
{33 	
try99 
{:: 
var;; 
arg;; 
=;; 
args;; 
[;; 
$num;;  
];;  !
.;;! "
Length;;" (
==;;) +
$num;;, -
?;;. /
string;;0 6
.;;6 7
Empty;;7 <
:;;= >
args;;? C
[;;C D
$num;;D E
];;E F
;;;F G
var== 
command== 
=== 
string== $
.==$ %
IsNullOrWhiteSpace==% 7
(==7 8
arg==8 ;
)==; <
?=== >
string==? E
.==E F
Empty==F K
:==L M
arg==N Q
.==Q R
ToLower==R Y
(==Y Z
)==Z [
;==[ \
switch?? 
(?? 
command?? 
)??  
{@@ 
caseBB 
$strBB 
:BB 
caseCC 
$strCC 
:CC  
ImprimirHelpDD $
(DD$ %
)DD% &
;DD& '
breakEE 
;EE 
caseFF 
$strFF !
:FF! "
varGG 
param1GG "
=GG# $
stringGG% +
.GG+ ,
FormatGG, 2
(GG2 3
$strGG3 @
,GG@ A
argsGGB F
[GGF G
$numGGG H
]GGH I
,GGI J
argsGGK O
[GGO P
$numGGP Q
]GGQ R
,GGR S
argsGGT X
[GGX Y
$numGGY Z
]GGZ [
)GG[ \
;GG\ ]
	EnviarNFeHH !
(HH! "
param1HH" (
)HH( )
;HH) *
breakII 
;II 
caseJJ 
$strJJ !
:JJ! "
varKK 
param2KK "
=KK# $
stringKK% +
.KK+ ,
FormatKK, 2
(KK2 3
$strKK3 8
,KK8 9
argsKK: >
[KK> ?
$numKK? @
]KK@ A
)KKA B
;KKB C"
ConsultarReciboDeEnvioLL .
(LL. /
param2LL/ 5
)LL5 6
;LL6 7
breakMM 
;MM 
caseNN 
$strNN ,
:NN, -
varOO 
param3OO "
=OO# $
stringOO% +
.OO+ ,
FormatOO, 2
(OO2 3
$strOO3 <
,OO< =
argsOO> B
[OOB C
$numOOC D
]OOD E
,OOE F
argsOOG K
[OOK L
$numOOL M
]OOM N
)OON O
;OOO P
ConsultarCadastroPP )
(PP) *
param3PP* 0
)PP0 1
;PP1 2
breakQQ 
;QQ 
caseRR 
$strRR !
:RR! ""
ConsultarStatusServicoSS .
(SS. /
)SS/ 0
;SS0 1
breakTT 
;TT 
caseUU 
$strUU %
:UU% &
varVV 
param4VV "
=VV# $
stringVV% +
.VV+ ,
FormatVV, 2
(VV2 3
$strVV3 L
,VVL M
argsVVN R
[VVR S
$numVVS T
]VVT U
,VVU V
argsVVW [
[VV[ \
$numVV\ ]
]VV] ^
,VV^ _
argsWW  
[WW  !
$numWW! "
]WW" #
,WW# $
argsWW% )
[WW) *
$numWW* +
]WW+ ,
,WW, -
argsWW. 2
[WW2 3
$numWW3 4
]WW4 5
,WW5 6
argsWW7 ;
[WW; <
$numWW< =
]WW= >
)WW> ?
;WW? @
InutilizarNumeracaoXX +
(XX+ ,
param4XX, 2
)XX2 3
;XX3 4
breakXX5 :
;XX: ;
caseYY 
$strYY #
:YY# $
varZZ 
param5ZZ "
=ZZ# $
stringZZ% +
.ZZ+ ,
FormatZZ, 2
(ZZ2 3
$strZZ3 L
,ZZL M
argsZZN R
[ZZR S
$numZZS T
]ZZT U
,ZZU V
argsZZW [
[ZZ[ \
$numZZ\ ]
]ZZ] ^
,ZZ^ _
argsZZ` d
[ZZd e
$numZZe f
]ZZf g
,ZZg h
args[[  
[[[  !
$num[[! "
][[" #
,[[# $
args[[% )
[[[) *
$num[[* +
][[+ ,
,[[, -
args[[. 2
[[[2 3
$num[[3 4
][[4 5
)[[5 6
;[[6 7
CancelarNFe\\ #
(\\# $
param5\\$ *
)\\* +
;\\+ ,
break]] 
;]] 
case^^ 
$str^^ %
:^^% &
case__ 
$str__ !
:__! "

Configurar`` "
(``" #
)``# $
;``$ %
breakaa 
;aa 
casebb 
$strbb '
:bb' (
ExibirConfigcc $
(cc$ %
)cc% &
;cc& '
breakdd 
;dd 
defaultee 
:ee 
Consoleff 
.ff  
Writeff  %
(ff% &
$strff& v
)ffv w
;ffw x
breakgg 
;gg 
}hh 
}ii 
catchjj 
{kk 
Consolell 
.ll 
	WriteLinell !
(ll! "
$strll" Z
)llZ [
;ll[ \
}mm 
}nn 	
privaterr 
staticrr 
voidrr 
ExibirConfigrr (
(rr( )
)rr) *
{ss 	
trytt 
{uu 
Consolevv 
.vv 
Clearvv 
(vv 
)vv 
;vv  
varww 
listww 
=ww 
	NFeFacadeww $
.ww$ %
GetConfiguracaoww% 4
(ww4 5
)ww5 6
;ww6 7
foreachxx 
(xx 
varxx 
itemxx !
inxx" $
listxx% )
)xx) *
{yy 
Consolezz 
.zz 
	WriteLinezz %
(zz% &
itemzz& *
)zz* +
;zz+ ,
}{{ 
}|| 
catch}} 
(}} 
	Exception}} 
ex}} 
)}}  
{~~ 
Console 
. 
	WriteLine !
(! "
string" (
.( )
Format) /
(/ 0
$str0 k
,k l
exm o
.o p
Messagep w
)w x
)x y
;y z
}
ÄÄ 
}
ÇÇ 	
private
ÑÑ 
static
ÑÑ 
	NFeFacade
ÑÑ  
	GetFacade
ÑÑ! *
(
ÑÑ* +
)
ÑÑ+ ,
{
ÖÖ 	
try
ÜÜ 
{
áá 
Console
àà 
.
àà 
ForegroundColor
àà '
=
àà( )
ConsoleColor
àà* 6
.
àà6 7
Blue
àà7 ;
;
àà; <
Console
ââ 
.
ââ 
	WriteLine
ââ !
(
ââ! "
$str
ââ" Q
)
ââQ R
;
ââR S
Console
ää 
.
ää 

ResetColor
ää "
(
ää" #
)
ää# $
;
ää$ %
var
ãã 
	nfeFacade
ãã 
=
ãã 
new
ãã  #
	NFeFacade
ãã$ -
(
ãã- .
)
ãã. /
;
ãã/ 0
var
çç 
isconfig
çç 
=
çç 
	nfeFacade
çç (
.
çç( )
IsConfigured
çç) 5
(
çç5 6
)
çç6 7
;
çç7 8
if
éé 
(
éé 
!
éé 
isconfig
éé 
)
éé 
{
èè 
Console
êê 
.
êê 
Write
êê !
(
êê! "
$str
êê" $
)
êê$ %
;
êê% &
Console
ëë 
.
ëë 
	WriteLine
ëë %
(
ëë% &
$str
ëë& Z
+
ëë[ \
$str
íí 7
)
íí7 8
;
íí8 9

Configurar
ìì 
(
ìì 
)
ìì  
;
ìì  !
}
îî 
return
ññ 
	nfeFacade
ññ  
;
ññ  !
}
óó 
catch
òò 
(
òò 
	Exception
òò 
ex
òò 
)
òò  
{
ôô 
Console
õõ 
.
õõ 
	WriteLine
õõ !
(
õõ! "
$str
õõ" A
)
õõA B
;
õõB C
Console
úú 
.
úú 
	WriteLine
úú !
(
úú! "
$str
úú" 1
,
úú1 2
ex
úú3 5
.
úú5 6
Message
úú6 =
)
úú= >
;
úú> ?
return
ùù 
null
ùù 
;
ùù 
}
ûû 
}
üü 	
private
££ 
static
££ 
void
££ 

Configurar
££ &
(
££& '
)
££' (
{
§§ 	
Console
¶¶ 
.
¶¶ 
	WriteLine
¶¶ 
(
¶¶ 
$str
¶¶  
)
¶¶  !
;
¶¶! "
Console
ßß 
.
ßß 
	WriteLine
ßß 
(
ßß 
$str
ßß H
)
ßßH I
;
ßßI J
Console
™™ 
.
™™ 
	WriteLine
™™ 
(
™™ 
$str
™™ 7
)
™™7 8
;
™™8 9
var
´´ 
pathcertificado
´´ 
=
´´  !
Console
´´" )
.
´´) *
ReadLine
´´* 2
(
´´2 3
)
´´3 4
;
´´4 5
Console
¨¨ 
.
¨¨ 
	WriteLine
¨¨ 
(
¨¨ 
$str
¨¨ 4
)
¨¨4 5
;
¨¨5 6
var
≠≠ 
certificadosenha
≠≠  
=
≠≠! "
Console
≠≠# *
.
≠≠* +
ReadLine
≠≠+ 3
(
≠≠3 4
)
≠≠4 5
;
≠≠5 6
Console
ÆÆ 
.
ÆÆ 
	WriteLine
ÆÆ 
(
ÆÆ 
$str
ÆÆ M
)
ÆÆM N
;
ÆÆN O
var
ØØ 
pathxml
ØØ 
=
ØØ 
Console
ØØ !
.
ØØ! "
ReadLine
ØØ" *
(
ØØ* +
)
ØØ+ ,
;
ØØ, -
Console
∞∞ 
.
∞∞ 
	WriteLine
∞∞ 
(
∞∞ 
$str
∞∞ T
)
∞∞T U
;
∞∞U V
var
±± 
	pathchema
±± 
=
±± 
Console
±± #
.
±±# $
ReadLine
±±$ ,
(
±±, -
)
±±- .
;
±±. /
Console
≤≤ 
.
≤≤ 
	WriteLine
≤≤ 
(
≤≤ 
$str
≤≤ A
)
≤≤A B
;
≤≤B C
var
≥≥ 
emitente
≥≥ 
=
≥≥ 
Console
≥≥ "
.
≥≥" #
ReadLine
≥≥# +
(
≥≥+ ,
)
≥≥, -
;
≥≥- .
Console
¥¥ 
.
¥¥ 
	WriteLine
¥¥ 
(
¥¥ 
$str
¥¥ <
)
¥¥< =
;
¥¥= >
var
µµ 
modelodocumento
µµ 
=
µµ  !
Console
µµ" )
.
µµ) *
ReadLine
µµ* 2
(
µµ2 3
)
µµ3 4
;
µµ4 5
Console
∂∂ 
.
∂∂ 
	WriteLine
∂∂ 
(
∂∂ 
$str
∂∂ F
)
∂∂F G
;
∂∂G H
var
∑∑ 
salvarxmlservico
∑∑  
=
∑∑! "
Console
∑∑# *
.
∑∑* +
ReadLine
∑∑+ 3
(
∑∑3 4
)
∑∑4 5
;
∑∑5 6
Console
∏∏ 
.
∏∏ 
	WriteLine
∏∏ 
(
∏∏ 
$str
∏∏ \
)
∏∏\ ]
;
∏∏] ^
var
ππ 
timeout
ππ 
=
ππ 
Console
ππ !
.
ππ! "
ReadLine
ππ" *
(
ππ* +
)
ππ+ ,
;
ππ, -
Console
∫∫ 
.
∫∫ 
	WriteLine
∫∫ 
(
∫∫ 
$str
∫∫ H
)
∫∫H I
;
∫∫I J
var
ªª 
tmpamb
ªª 
=
ªª 
Console
ªª  
.
ªª  !
ReadLine
ªª! )
(
ªª) *
)
ªª* +
;
ªª+ ,
Console
ºº 
.
ºº 
	WriteLine
ºº 
(
ºº 
$strºº å
)ººå ç
;ººç é
var
ΩΩ 

tmpemissao
ΩΩ 
=
ΩΩ 
Console
ΩΩ $
.
ΩΩ$ %
ReadLine
ΩΩ% -
(
ΩΩ- .
)
ΩΩ. /
;
ΩΩ/ 0
	NFeFacade
¿¿ 
.
¿¿ 
SetConfiguracoes
¿¿ &
(
¿¿& '
pathcertificado
¿¿' 6
,
¿¿6 7
certificadosenha
¿¿8 H
,
¿¿H I
pathxml
¿¿J Q
,
¿¿Q R
	pathchema
¡¡ 
,
¡¡ 
emitente
¡¡ #
,
¡¡# $
modelodocumento
¡¡% 4
,
¡¡4 5
salvarxmlservico
¡¡6 F
,
¡¡F G
timeout
¡¡H O
,
¡¡O P
tmpamb
¡¡Q W
,
¡¡W X

tmpemissao
¡¡Y c
)
¡¡c d
;
¡¡d e
Console
√√ 
.
√√ 
Clear
√√ 
(
√√ 
)
√√ 
;
√√ 
Console
ƒƒ 
.
ƒƒ 
	WriteLine
ƒƒ 
(
ƒƒ 
$str
ƒƒ 4
)
ƒƒ4 5
;
ƒƒ5 6
}
≈≈ 	
private
   
static
   
void
   
CancelarNFe
   '
(
  ' (
string
  ( .!
dadosDoCancelamento
  / B
)
  B C
{
ÀÀ 	
var
ÃÃ 
	nfeFacade
ÃÃ 
=
ÃÃ 
	GetFacade
ÃÃ %
(
ÃÃ% &
)
ÃÃ& '
;
ÃÃ' (
if
ÕÕ 
(
ÕÕ 
	nfeFacade
ÕÕ 
==
ÕÕ 
null
ÕÕ !
)
ÕÕ! "
return
ÕÕ# )
;
ÕÕ) *
var
–– 
arrayStrDados
–– 
=
–– !
dadosDoCancelamento
––  3
.
––3 4
Split
––4 9
(
––9 :
$char
––: =
)
––= >
;
––> ?
var
““ 
strCnpj
““ 
=
““ 
string
““  
.
““  !
Empty
““! &
;
““& '
var
”” 
strJustificativa
””  
=
””! "
string
””# )
.
””) *
Empty
””* /
;
””/ 0
var
‘‘ 
strChaveAcesso
‘‘ 
=
‘‘  
string
‘‘! '
.
‘‘' (
Empty
‘‘( -
;
‘‘- .
var
’’ 
strProtocolo
’’ 
=
’’ 
string
’’ %
.
’’% &
Empty
’’& +
;
’’+ ,
var
◊◊ 
intNumeroLote
◊◊ 
=
◊◊ 
$num
◊◊  !
;
◊◊! "
Int16
ÿÿ  
intSequenciaEvento
ÿÿ $
=
ÿÿ% &
$num
ÿÿ' (
;
ÿÿ( )
try
⁄⁄ 
{
€€ 
strCnpj
‹‹ 
=
‹‹ 
arrayStrDados
‹‹ '
[
‹‹' (
$num
‹‹( )
]
‹‹) *
;
‹‹* +
strJustificativa
››  
=
››! "
arrayStrDados
››# 0
[
››0 1
$num
››1 2
]
››2 3
;
››3 4
strChaveAcesso
ﬁﬁ 
=
ﬁﬁ  
Convert
ﬁﬁ! (
.
ﬁﬁ( )
ToString
ﬁﬁ) 1
(
ﬁﬁ1 2
arrayStrDados
ﬁﬁ2 ?
[
ﬁﬁ? @
$num
ﬁﬁ@ A
]
ﬁﬁA B
)
ﬁﬁB C
;
ﬁﬁC D
strProtocolo
ﬂﬂ 
=
ﬂﬂ 
Convert
ﬂﬂ &
.
ﬂﬂ& '
ToString
ﬂﬂ' /
(
ﬂﬂ/ 0
arrayStrDados
ﬂﬂ0 =
[
ﬂﬂ= >
$num
ﬂﬂ> ?
]
ﬂﬂ? @
)
ﬂﬂ@ A
;
ﬂﬂA B
intNumeroLote
‡‡ 
=
‡‡ 
Convert
‡‡  '
.
‡‡' (
ToInt32
‡‡( /
(
‡‡/ 0
arrayStrDados
‡‡0 =
[
‡‡= >
$num
‡‡> ?
]
‡‡? @
)
‡‡@ A
;
‡‡A B 
intSequenciaEvento
·· "
=
··# $
Convert
··% ,
.
··, -
ToInt16
··- 4
(
··4 5
arrayStrDados
··5 B
[
··B C
$num
··C D
]
··D E
)
··E F
;
··F G
}
‚‚ 
catch
„„ 
{
‰‰ 
Console
ÂÂ 
.
ÂÂ 
	WriteLine
ÂÂ !
(
ÂÂ! "
$str
ÂÂ" K
)
ÂÂK L
;
ÂÂL M
}
ÊÊ 
try
ÎÎ 
{
ÏÏ 
var
ÌÌ 
booStatusOk
ÌÌ 
=
ÌÌ  !$
ConsultarStatusServico
ÌÌ" 8
(
ÌÌ8 9
)
ÌÌ9 :
;
ÌÌ: ;
if
ÔÔ 
(
ÔÔ 
!
ÔÔ 
booStatusOk
ÔÔ  
)
ÔÔ  !
{
 
return
ÒÒ 
;
ÒÒ 
}
ÚÚ 
Console
ÙÙ 
.
ÙÙ 
	WriteLine
ÙÙ !
(
ÙÙ! "
$str
ÙÙ" @
)
ÙÙ@ A
;
ÙÙA B
var
ıı !
retornoCancelamento
ıı '
=
ıı( )
	nfeFacade
ıı* 3
.
ıı3 4
CancelarNFe
ıı4 ?
(
ıı? @
strCnpj
ıı@ G
,
ııG H
intNumeroLote
ııI V
,
ııV W 
intSequenciaEvento
ııX j
,
ııj k
strChaveAcesso
ııl z
,
ıız {
strProtocoloıı| à
,ııà â 
strJustificativaııä ö
)ııö õ
;ııõ ú
Console
ˆˆ 
.
ˆˆ 
	WriteLine
ˆˆ !
(
ˆˆ! "
$str
ˆˆ" =
,
ˆˆ= >!
retornoCancelamento
ˆˆ? R
.
ˆˆR S
Retorno
ˆˆS Z
.
ˆˆZ [
	retEvento
ˆˆ[ d
[
ˆˆd e
$num
ˆˆe f
]
ˆˆf g
.
ˆˆg h
	infEvento
ˆˆh q
.
ˆˆq r
xMotivo
ˆˆr y
)
ˆˆy z
;
ˆˆz {
}
˜˜ 
catch
¯¯ 
(
¯¯ 
	Exception
¯¯ 
ex
¯¯ 
)
¯¯  
{
˘˘ 
Console
˙˙ 
.
˙˙ 
	WriteLine
˙˙ !
(
˙˙! "
$str
˙˙" A
)
˙˙A B
;
˙˙B C
Console
˚˚ 
.
˚˚ 
	WriteLine
˚˚ !
(
˚˚! "
string
˚˚" (
.
˚˚( )
Format
˚˚) /
(
˚˚/ 0
$str
˚˚0 >
,
˚˚> ?
ex
˚˚@ B
.
˚˚B C
Message
˚˚C J
)
˚˚J K
)
˚˚K L
;
˚˚L M
}
¸¸ 
}
ˇˇ 	
private
ÉÉ 
static
ÉÉ 
void
ÉÉ 
ImprimirHelp
ÉÉ (
(
ÉÉ( )
)
ÉÉ) *
{
ÑÑ 	
Console
ÖÖ 
.
ÖÖ 
Clear
ÖÖ 
(
ÖÖ 
)
ÖÖ 
;
ÖÖ 
Console
ÜÜ 
.
ÜÜ 
	WriteLine
ÜÜ 
(
ÜÜ 
$str
ÜÜ  
)
ÜÜ  !
;
ÜÜ! "
Console
áá 
.
áá 
ForegroundColor
áá #
=
áá$ %
ConsoleColor
áá& 2
.
áá2 3
Blue
áá3 7
;
áá7 8
Console
àà 
.
àà 
	WriteLine
àà 
(
àà 
$str
àà e
)
ààe f
;
ààf g
Console
ââ 
.
ââ 

ResetColor
ââ 
(
ââ 
)
ââ  
;
ââ  !
Console
ää 
.
ää 
	WriteLine
ää 
(
ää 
$str
ää  
)
ää  !
;
ää! "
Console
ãã 
.
ãã 
Write
ãã 
(
ãã 
$str
ãã %
)
ãã% &
;
ãã& '
Console
åå 
.
åå 
	WriteLine
åå 
(
åå 
$str
åå E
)
ååE F
;
ååF G
Console
çç 
.
çç 
	WriteLine
çç 
(
çç 
$str
çç  
)
çç  !
;
çç! "
Console
éé 
.
éé 
	WriteLine
éé 
(
éé 
$str
éé 4
)
éé4 5
;
éé5 6
Console
èè 
.
èè 
Write
èè 
(
èè 
$strèè á
)èèá à
;èèà â
Console
êê 
.
êê 
	WriteLine
êê 
(
êê 
$str
êê  
)
êê  !
;
êê! "
Console
ëë 
.
ëë 
	WriteLine
ëë 
(
ëë 
$str
ëë ;
)
ëë; <
;
ëë< =
Console
íí 
.
íí 
	WriteLine
íí 
(
íí 
$str
íí @
)
íí@ A
;
ííA B
Console
ìì 
.
ìì 
	WriteLine
ìì 
(
ìì 
$str
ìì Q
)
ììQ R
;
ììR S
Console
îî 
.
îî 
	WriteLine
îî 
(
îî 
$strîî É
)îîÉ Ñ
;îîÑ Ö
Console
ïï 
.
ïï 
	WriteLine
ïï 
(
ïï 
$strïï Ö
)ïïÖ Ü
;ïïÜ á
Console
ññ 
.
ññ 
	WriteLine
ññ 
(
ññ 
$str
ññ V
)
ññV W
;
ññW X
Console
óó 
.
óó 
	WriteLine
óó 
(
óó 
$str
óó K
)
óóK L
;
óóL M
Console
òò 
.
òò 
	WriteLine
òò 
(
òò 
$str
òò P
)
òòP Q
;
òòQ R
Console
ôô 
.
ôô 
	WriteLine
ôô 
(
ôô 
$strôô ã
)ôôã å
;ôôå ç
Console
öö 
.
öö 
Write
öö 
(
öö 
$str
öö 
)
öö 
;
öö 
Console
õõ 
.
õõ 
	WriteLine
õõ 
(
õõ 
$str
õõ @
)
õõ@ A
;
õõA B
Console
úú 
.
úú 
	WriteLine
úú 
(
úú 
$str
úú  
)
úú  !
;
úú! "
Console
ùù 
.
ùù 
	WriteLine
ùù 
(
ùù 
$str
ùù J
)
ùùJ K
;
ùùK L
Console
ûû 
.
ûû 
	WriteLine
ûû 
(
ûû 
$str
ûû  
)
ûû  !
;
ûû! "
Console
üü 
.
üü 
Write
üü 
(
üü 
$str
üü `
)
üü` a
;
üüa b
Console
†† 
.
†† 
	WriteLine
†† 
(
†† 
$str†† ç
)††ç é
;††é è
Console
°° 
.
°° 
	WriteLine
°° 
(
°° 
$str
°° O
)
°°O P
;
°°P Q
Console
¢¢ 
.
¢¢ 
	WriteLine
¢¢ 
(
¢¢ 
$str
¢¢  
)
¢¢  !
;
¢¢! "
Console
££ 
.
££ 
Write
££ 
(
££ 
$str
££ @
)
££@ A
;
££A B
Console
§§ 
.
§§ 
	WriteLine
§§ 
(
§§ 
$str
§§ 2
)
§§2 3
;
§§3 4
Console
•• 
.
•• 
	WriteLine
•• 
(
•• 
$str
•• C
)
••C D
;
••D E
Console
¶¶ 
.
¶¶ 
	WriteLine
¶¶ 
(
¶¶ 
$str
¶¶  
)
¶¶  !
;
¶¶! "
Console
ßß 
.
ßß 
Write
ßß 
(
ßß 
$str
ßß k
)
ßßk l
;
ßßl m
Console
®® 
.
®® 
	WriteLine
®® 
(
®® 
$str
®® i
)
®®i j
;
®®j k
Console
©© 
.
©© 
	WriteLine
©© 
(
©© 
$str
©© T
)
©©T U
;
©©U V
Console
™™ 
.
™™ 
	WriteLine
™™ 
(
™™ 
$str
™™  
)
™™  !
;
™™! "
Console
´´ 
.
´´ 
Write
´´ 
(
´´ 
$str
´´ d
)
´´d e
;
´´e f
Console
¨¨ 
.
¨¨ 
	WriteLine
¨¨ 
(
¨¨ 
$str¨¨ é
)¨¨é è
;¨¨è ê
Console
≠≠ 
.
≠≠ 
	WriteLine
≠≠ 
(
≠≠ 
$str
≠≠ h
)
≠≠h i
;
≠≠i j
Console
ÆÆ 
.
ÆÆ 
	WriteLine
ÆÆ 
(
ÆÆ 
$str
ÆÆ  
)
ÆÆ  !
;
ÆÆ! "
Console
ØØ 
.
ØØ 
Write
ØØ 
(
ØØ 
$str
ØØ b
)
ØØb c
;
ØØc d
Console
∞∞ 
.
∞∞ 
	WriteLine
∞∞ 
(
∞∞ 
$str
∞∞ z
)
∞∞z {
;
∞∞{ |
Console
±± 
.
±± 
	WriteLine
±± 
(
±± 
$str
±± v
)
±±v w
;
±±w x
Console
≤≤ 
.
≤≤ 
	WriteLine
≤≤ 
(
≤≤ 
$str≤≤ ã
)≤≤ã å
;≤≤å ç
}
≥≥ 	
private
ªª 
static
ªª 
void
ªª 
ConsultarCadastro
ªª -
(
ªª- .
string
ªª. 4
dadosconsulta
ªª5 B
)
ªªB C
{
ºº 	
var
ΩΩ 
	nfeFacade
ΩΩ 
=
ΩΩ 
	GetFacade
ΩΩ %
(
ΩΩ% &
)
ΩΩ& '
;
ΩΩ' (
if
ææ 
(
ææ 
	nfeFacade
ææ 
==
ææ 
null
ææ !
)
ææ! "
return
ææ# )
;
ææ) *
var
¿¿ 
arrayStrDados
¿¿ 
=
¿¿ 
dadosconsulta
¿¿  -
.
¿¿- .
Split
¿¿. 3
(
¿¿3 4
$char
¿¿4 7
)
¿¿7 8
;
¿¿8 9
var
¬¬ 
strUf
¬¬ 
=
¬¬ 
string
¬¬ 
.
¬¬ 
Empty
¬¬ $
;
¬¬$ %
var
√√ 
	documento
√√ 
=
√√ 
string
√√ "
.
√√" #
Empty
√√# (
;
√√( )
try
≈≈ 
{
∆∆ 
strUf
»» 
=
»» 
arrayStrDados
»» %
[
»»% &
$num
»»& '
]
»»' (
;
»»( )
	documento
…… 
=
…… 
arrayStrDados
…… )
[
……) *
$num
……* +
]
……+ ,
;
……, -
}
   
catch
ÀÀ 
{
ÃÃ 
Console
ÕÕ 
.
ÕÕ 
	WriteLine
ÕÕ !
(
ÕÕ! "
$str
ÕÕ" K
)
ÕÕK L
;
ÕÕL M
}
ŒŒ 
try
““ 
{
”” 
Console
’’ 
.
’’ 
	WriteLine
’’ !
(
’’! "
$str
’’" Y
)
’’Y Z
;
’’Z [
var
÷÷ 
tipodocumento
÷÷ !
=
÷÷" #
Console
÷÷$ +
.
÷÷+ ,
ReadLine
÷÷, 4
(
÷÷4 5
)
÷÷5 6
;
÷÷6 7
if
◊◊ 
(
◊◊ 
tipodocumento
◊◊ !
!=
◊◊" $
$str
◊◊% (
&
◊◊) *
tipodocumento
◊◊+ 8
!=
◊◊9 ;
$str
◊◊< ?
&
◊◊@ A
tipodocumento
◊◊B O
!=
◊◊P R
$str
◊◊S V
)
◊◊V W
return
ÿÿ 
;
ÿÿ 
Console
⁄⁄ 
.
⁄⁄ 
	WriteLine
⁄⁄ !
(
⁄⁄! "
$str
⁄⁄" H
)
⁄⁄H I
;
⁄⁄I J
if
€€ 
(
€€ 
tipodocumento
€€ !
==
€€" $
$str
€€% (
)
€€( )
	nfeFacade
‹‹ 
.
‹‹ 
ConsultaCadastro
‹‹ .
(
‹‹. /
strUf
‹‹/ 4
,
‹‹4 5+
ConsultaCadastroTipoDocumento
‹‹6 S
.
‹‹S T
Cnpj
‹‹T X
,
‹‹X Y
	documento
‹‹Z c
)
‹‹c d
;
‹‹d e
if
›› 
(
›› 
tipodocumento
›› !
==
››" $
$str
››% (
)
››( )
	nfeFacade
ﬁﬁ 
.
ﬁﬁ 
ConsultaCadastro
ﬁﬁ .
(
ﬁﬁ. /
strUf
ﬁﬁ/ 4
,
ﬁﬁ4 5+
ConsultaCadastroTipoDocumento
ﬁﬁ6 S
.
ﬁﬁS T
Cpf
ﬁﬁT W
,
ﬁﬁW X
	documento
ﬁﬁY b
)
ﬁﬁb c
;
ﬁﬁc d
if
ﬂﬂ 
(
ﬂﬂ 
tipodocumento
ﬂﬂ !
==
ﬂﬂ" $
$str
ﬂﬂ% (
)
ﬂﬂ( )
	nfeFacade
‡‡ 
.
‡‡ 
ConsultaCadastro
‡‡ .
(
‡‡. /
strUf
‡‡/ 4
,
‡‡4 5+
ConsultaCadastroTipoDocumento
‡‡6 S
.
‡‡S T
Ie
‡‡T V
,
‡‡V W
	documento
‡‡X a
)
‡‡a b
;
‡‡b c
}
·· 
catch
‚‚ 
(
‚‚ 
	Exception
‚‚ 
ex
‚‚ 
)
‚‚  
{
„„ 
Console
ÂÂ 
.
ÂÂ 
	WriteLine
ÂÂ !
(
ÂÂ! "
$str
ÂÂ" A
)
ÂÂA B
;
ÂÂB C
Console
ÊÊ 
.
ÊÊ 
	WriteLine
ÊÊ !
(
ÊÊ! "
string
ÊÊ" (
.
ÊÊ( )
Format
ÊÊ) /
(
ÊÊ/ 0
$str
ÊÊ0 ?
,
ÊÊ? @
ex
ÊÊA C
.
ÊÊC D
Message
ÊÊD K
)
ÊÊK L
)
ÊÊL M
;
ÊÊM N
}
ÁÁ 
}
ÍÍ 	
private
ÔÔ 
static
ÔÔ 
void
ÔÔ !
InutilizarNumeracao
ÔÔ /
(
ÔÔ/ 0
string
ÔÔ0 6!
dadosDaInutilizacao
ÔÔ7 J
)
ÔÔJ K
{
 	
var
ÒÒ 
	nfeFacade
ÒÒ 
=
ÒÒ 
	GetFacade
ÒÒ %
(
ÒÒ% &
)
ÒÒ& '
;
ÒÒ' (
if
ÚÚ 
(
ÚÚ 
	nfeFacade
ÚÚ 
==
ÚÚ 
null
ÚÚ !
)
ÚÚ! "
return
ÚÚ# )
;
ÚÚ) *
var
ÙÙ 
arrayStrDados
ÙÙ 
=
ÙÙ !
dadosDaInutilizacao
ÙÙ  3
.
ÙÙ3 4
Split
ÙÙ4 9
(
ÙÙ9 :
$char
ÙÙ: =
)
ÙÙ= >
;
ÙÙ> ?
var
ˆˆ 
strCnpj
ˆˆ 
=
ˆˆ 
string
ˆˆ  
.
ˆˆ  !
Empty
ˆˆ! &
;
ˆˆ& '
var
˜˜ 
strJustificativa
˜˜  
=
˜˜! "
string
˜˜# )
.
˜˜) *
Empty
˜˜* /
;
˜˜/ 0
var
˘˘ 
intNumeroInicial
˘˘  
=
˘˘! "
$num
˘˘# $
;
˘˘$ %
var
˙˙ 
intNumeroFinal
˙˙ 
=
˙˙  
$num
˙˙! "
;
˙˙" #
var
˚˚ 
intSerie
˚˚ 
=
˚˚ 
$num
˚˚ 
;
˚˚ 
var
¸¸ 
intAno
¸¸ 
=
¸¸ 
$num
¸¸ 
;
¸¸ 
try
˛˛ 
{
ˇˇ 
strCnpj
ÅÅ 
=
ÅÅ 
arrayStrDados
ÅÅ '
[
ÅÅ' (
$num
ÅÅ( )
]
ÅÅ) *
;
ÅÅ* +
strJustificativa
ÇÇ  
=
ÇÇ! "
arrayStrDados
ÇÇ# 0
[
ÇÇ0 1
$num
ÇÇ1 2
]
ÇÇ2 3
;
ÇÇ3 4
intNumeroInicial
ÉÉ  
=
ÉÉ! "
Convert
ÉÉ# *
.
ÉÉ* +
ToInt32
ÉÉ+ 2
(
ÉÉ2 3
arrayStrDados
ÉÉ3 @
[
ÉÉ@ A
$num
ÉÉA B
]
ÉÉB C
)
ÉÉC D
;
ÉÉD E
intNumeroFinal
ÑÑ 
=
ÑÑ  
Convert
ÑÑ! (
.
ÑÑ( )
ToInt32
ÑÑ) 0
(
ÑÑ0 1
arrayStrDados
ÑÑ1 >
[
ÑÑ> ?
$num
ÑÑ? @
]
ÑÑ@ A
)
ÑÑA B
;
ÑÑB C
intSerie
ÖÖ 
=
ÖÖ 
Convert
ÖÖ "
.
ÖÖ" #
ToInt32
ÖÖ# *
(
ÖÖ* +
arrayStrDados
ÖÖ+ 8
[
ÖÖ8 9
$num
ÖÖ9 :
]
ÖÖ: ;
)
ÖÖ; <
;
ÖÖ< =
intAno
ÜÜ 
=
ÜÜ 
Convert
ÜÜ  
.
ÜÜ  !
ToInt16
ÜÜ! (
(
ÜÜ( )
arrayStrDados
ÜÜ) 6
[
ÜÜ6 7
$num
ÜÜ7 8
]
ÜÜ8 9
)
ÜÜ9 :
;
ÜÜ: ;
}
áá 
catch
àà 
{
ââ 
Console
ää 
.
ää 
	WriteLine
ää !
(
ää! "
$str
ää" K
)
ääK L
;
ääL M
}
ãã 
try
êê 
{
ëë 
var
íí 
booStatusOk
íí 
=
íí  !$
ConsultarStatusServico
íí" 8
(
íí8 9
)
íí9 :
;
íí: ;
if
îî 
(
îî 
!
îî 
booStatusOk
îî  
)
îî  !
{
ïï 
return
ññ 
;
ññ 
}
óó 
Console
ôô 
.
ôô 
	WriteLine
ôô !
(
ôô! "
$str
ôô" @
)
ôô@ A
;
ôôA B
var
öö !
retornoInutilizacao
öö '
=
öö( )
	nfeFacade
öö* 3
.
öö3 4!
InutilizarNumeracao
öö4 G
(
ööG H
intAno
ööH N
,
ööN O
strCnpj
ööP W
,
ööW X
strJustificativa
ööY i
,
ööi j
intNumeroInicial
öök {
,
öö{ |
intNumeroFinalöö} ã
,ööã å
intSerieööç ï
)ööï ñ
;ööñ ó
if
úú 
(
úú !
retornoInutilizacao
úú '
.
úú' (
Retorno
úú( /
.
úú/ 0
infInut
úú0 7
.
úú7 8
cStat
úú8 =
==
úú> @
$num
úúA D
)
úúD E
{
ùù 
Console
ûû 
.
ûû 
	WriteLine
ûû %
(
ûû% &
$str
ûû& A
,
ûûA B!
retornoInutilizacao
ûûC V
.
ûûV W
Retorno
ûûW ^
.
ûû^ _
infInut
ûû_ f
.
ûûf g
nProt
ûûg l
)
ûûl m
;
ûûm n
}
üü 
else
†† 
{
°° 
Console
¢¢ 
.
¢¢ 
	WriteLine
¢¢ %
(
¢¢% &
$str
¢¢& 1
,
¢¢1 2!
retornoInutilizacao
¢¢3 F
.
¢¢F G
Retorno
¢¢G N
.
¢¢N O
infInut
¢¢O V
.
¢¢V W
xMotivo
¢¢W ^
)
¢¢^ _
;
¢¢_ `
}
££ 
}
§§ 
catch
•• 
(
•• 
	Exception
•• 
ex
•• 
)
••  
{
¶¶ 
Console
ßß 
.
ßß 
	WriteLine
ßß !
(
ßß! "
$str
ßß" A
)
ßßA B
;
ßßB C
Console
®® 
.
®® 
	WriteLine
®® !
(
®®! "
string
®®" (
.
®®( )
Format
®®) /
(
®®/ 0
$str
®®0 >
,
®®> ?
ex
®®@ B
.
®®B C
Message
®®C J
)
®®J K
)
®®K L
;
®®L M
}
©© 
}
¨¨ 	
private
±± 
static
±± 
bool
±± $
ConsultarStatusServico
±± 2
(
±±2 3
)
±±3 4
{
≤≤ 	
try
¥¥ 
{
µµ 
var
∂∂ 
	nfeFacade
∂∂ 
=
∂∂ 
	GetFacade
∂∂  )
(
∂∂) *
)
∂∂* +
;
∂∂+ ,
if
∑∑ 
(
∑∑ 
	nfeFacade
∑∑ 
==
∑∑  
null
∑∑! %
)
∑∑% &
return
∑∑' -
false
∑∑. 3
;
∑∑3 4
Console
∏∏ 
.
∏∏ 
	WriteLine
∏∏ !
(
∏∏! "
$str
∏∏" O
)
∏∏O P
;
∏∏P Q
var
∫∫ 
retorno
∫∫ 
=
∫∫ 
	nfeFacade
∫∫ '
.
∫∫' ($
ConsultarStatusServico
∫∫( >
(
∫∫> ?
)
∫∫? @
;
∫∫@ A
if
ºº 
(
ºº 
retorno
ºº 
.
ºº 
cStat
ºº !
==
ºº" $
$num
ºº% (
)
ºº( )
{
ΩΩ 
Console
ææ 
.
ææ 
	WriteLine
ææ %
(
ææ% &
$str
ææ& (
)
ææ( )
;
ææ) *
Console
øø 
.
øø 
ForegroundColor
øø +
=
øø, -
ConsoleColor
øø. :
.
øø: ;
Blue
øø; ?
;
øø? @
Console
¿¿ 
.
¿¿ 
	WriteLine
¿¿ %
(
¿¿% &
$str
¿¿& =
)
¿¿= >
;
¿¿> ?
Console
¡¡ 
.
¡¡ 

ResetColor
¡¡ &
(
¡¡& '
)
¡¡' (
;
¡¡( )
return
¬¬ 
true
¬¬ 
;
¬¬  
}
√√ 
Console
≈≈ 
.
≈≈ 
	WriteLine
≈≈ !
(
≈≈! "
$str
≈≈" $
)
≈≈$ %
;
≈≈% &
Console
∆∆ 
.
∆∆ 
ForegroundColor
∆∆ '
=
∆∆( )
ConsoleColor
∆∆* 6
.
∆∆6 7
Red
∆∆7 :
;
∆∆: ;
Console
«« 
.
«« 
	WriteLine
«« !
(
««! "
$str
««" :
)
««: ;
;
««; <
Console
»» 
.
»» 

ResetColor
»» "
(
»»" #
)
»»# $
;
»»$ %
return
…… 
false
…… 
;
…… 
}
   
catch
ÀÀ 
(
ÀÀ '
InvalidOperationException
ÀÀ ,
ex
ÀÀ- /
)
ÀÀ/ 0
{
ÃÃ 
Console
ÕÕ 
.
ÕÕ 
	WriteLine
ÕÕ !
(
ÕÕ! "
ex
ÕÕ" $
.
ÕÕ$ %
Message
ÕÕ% ,
)
ÕÕ, -
;
ÕÕ- .
return
ŒŒ 
false
ŒŒ 
;
ŒŒ 
}
œœ 
catch
–– 
(
–– 
	Exception
–– 
ex
–– 
)
––  
{
—— 
Console
““ 
.
““ 
	WriteLine
““ !
(
““! "
$str
““" A
)
““A B
;
““B C
Console
”” 
.
”” 
	WriteLine
”” !
(
””! "
string
””" (
.
””( )
Format
””) /
(
””/ 0
$str
””0 ?
,
””? @
ex
””A C
.
””C D
Message
””D K
)
””K L
)
””L M
;
””M N
return
‘‘ 
false
‘‘ 
;
‘‘ 
}
’’ 
}
÷÷ 	
private
€€ 
static
€€ 
void
€€ 
	EnviarNFe
€€ %
(
€€% &
string
€€& ,
dadosDoEnvio
€€- 9
)
€€9 :
{
‹‹ 	
var
›› 
	nfeFacade
›› 
=
›› 
	GetFacade
›› %
(
››% &
)
››& '
;
››' (
if
ﬁﬁ 
(
ﬁﬁ 
	nfeFacade
ﬁﬁ 
==
ﬁﬁ 
null
ﬁﬁ !
)
ﬁﬁ! "
return
ﬁﬁ# )
;
ﬁﬁ) *
string
‡‡ 
strPathArquivoXml
‡‡ $
;
‡‡$ %
int
·· 

numeroLote
·· 
;
·· 

TipoXmlNFe
‚‚ 
tipoXml
‚‚ 
;
‚‚ 
try
‰‰ 
{
ÂÂ 
var
ÊÊ 
arrayStrDados
ÊÊ !
=
ÊÊ" #
dadosDoEnvio
ÊÊ$ 0
.
ÊÊ0 1
Split
ÊÊ1 6
(
ÊÊ6 7
$char
ÊÊ7 :
)
ÊÊ: ;
;
ÊÊ; <
strPathArquivoXml
ÁÁ !
=
ÁÁ" #
arrayStrDados
ÁÁ$ 1
[
ÁÁ1 2
$num
ÁÁ2 3
]
ÁÁ3 4
;
ÁÁ4 5

numeroLote
ËË 
=
ËË 
int
ËË  
.
ËË  !
Parse
ËË! &
(
ËË& '
arrayStrDados
ËË' 4
[
ËË4 5
$num
ËË5 6
]
ËË6 7
)
ËË7 8
;
ËË8 9
switch
ÈÈ 
(
ÈÈ 
arrayStrDados
ÈÈ %
[
ÈÈ% &
$num
ÈÈ& '
]
ÈÈ' (
)
ÈÈ( )
{
ÍÍ 
case
ÎÎ 
$str
ÎÎ 
:
ÎÎ 
tipoXml
ÏÏ 
=
ÏÏ  !

TipoXmlNFe
ÏÏ" ,
.
ÏÏ, -
Destinatario
ÏÏ- 9
;
ÏÏ9 :
break
ÌÌ 
;
ÌÌ 
case
ÓÓ 
$str
ÓÓ 
:
ÓÓ 
tipoXml
ÔÔ 
=
ÔÔ  !

TipoXmlNFe
ÔÔ" ,
.
ÔÔ, -
NFe
ÔÔ- 0
;
ÔÔ0 1
break
 
;
 
case
ÒÒ 
$str
ÒÒ 
:
ÒÒ 
tipoXml
ÚÚ 
=
ÚÚ  !

TipoXmlNFe
ÚÚ" ,
.
ÚÚ, -
Lote
ÚÚ- 1
;
ÚÚ1 2
break
ÛÛ 
;
ÛÛ 
default
ÙÙ 
:
ÙÙ 
throw
ıı 
new
ıı !
ArgumentException
ıı" 3
(
ıı3 4
)
ıı4 5
;
ıı5 6
}
ˆˆ 
}
˜˜ 
catch
¯¯ 
{
˘˘ 
Console
˙˙ 
.
˙˙ 
	WriteLine
˙˙ !
(
˙˙! "
$str
˙˙" ^
)
˙˙^ _
;
˙˙_ `
return
˚˚ 
;
˚˚ 
}
¸¸ 
try
˛˛ 
{
ˇˇ 
File
ÄÄ 
.
ÄÄ 
ReadAllText
ÄÄ  
(
ÄÄ  !
strPathArquivoXml
ÄÄ! 2
)
ÄÄ2 3
;
ÄÄ3 4
}
ÅÅ 
catch
ÇÇ 
(
ÇÇ )
UnauthorizedAccessException
ÇÇ .
ex
ÇÇ/ 1
)
ÇÇ1 2
{
ÉÉ 
var
ÑÑ 
strMensagem
ÑÑ 
=
ÑÑ  !
string
ÑÑ" (
.
ÑÑ( )
Format
ÑÑ) /
(
ÑÑ/ 0
$str
ÑÑ0 \
,
ÑÑ\ ]
strPathArquivoXml
ÑÑ^ o
)
ÑÑo p
;
ÑÑp q
Console
ÖÖ 
.
ÖÖ 
	WriteLine
ÖÖ !
(
ÖÖ! "
strMensagem
ÖÖ" -
)
ÖÖ- .
;
ÖÖ. /
Console
ÜÜ 
.
ÜÜ 
	WriteLine
ÜÜ !
(
ÜÜ! "
$str
ÜÜ" -
)
ÜÜ- .
;
ÜÜ. /
Console
áá 
.
áá 
	WriteLine
áá !
(
áá! "
ex
áá" $
.
áá$ %
Message
áá% ,
)
áá, -
;
áá- .
return
àà 
;
àà 
}
ââ 
try
ãã 
{
åå 
var
çç 
booStatusOk
çç 
=
çç  !$
ConsultarStatusServico
çç" 8
(
çç8 9
)
çç9 :
;
çç: ;
if
èè 
(
èè 
!
èè 
booStatusOk
èè  
)
èè  !
{
êê 
return
ëë 
;
ëë 
}
íí 
var
îî 

nfeBuilder
îî 
=
îî  
new
îî! $

NFeBuilder
îî% /
(
îî/ 0
strPathArquivoXml
îî0 A
,
îîA B
tipoXml
îîC J
)
îîJ K
;
îîK L
Console
ïï 
.
ïï 
	WriteLine
ïï !
(
ïï! "
$str
ïï" 7
)
ïï7 8
;
ïï8 9
var
ññ 
retorno
ññ 
=
ññ 
	nfeFacade
ññ '
.
ññ' (
	EnviarNFe
ññ( 1
(
ññ1 2

numeroLote
ññ2 <
,
ññ< =

nfeBuilder
ññ> H
.
ññH I
Build
ññI N
(
ññN O
)
ññO P
)
ññP Q
;
ññQ R
if
óó 
(
óó 
retorno
óó 
.
óó 
Retorno
óó #
.
óó# $
cStat
óó$ )
==
óó* ,
$num
óó- 0
)
óó0 1
{
òò 
Console
ôô 
.
ôô 
	WriteLine
ôô %
(
ôô% &
$str
ôô& -
+
ôô. /
retorno
ôô0 7
.
ôô7 8
Retorno
ôô8 ?
.
ôô? @
infRec
ôô@ F
.
ôôF G
nRec
ôôG K
)
ôôK L
;
ôôL M
}
öö 
else
õõ 
{
úú 
Console
ùù 
.
ùù 
	WriteLine
ùù %
(
ùù% &
$str
ùù& .
+
ùù/ 0
retorno
ùù1 8
.
ùù8 9
Retorno
ùù9 @
.
ùù@ A
xMotivo
ùùA H
)
ùùH I
;
ùùI J
}
ûû 
}
üü 
catch
†† 
(
†† 
	Exception
†† 
ex
†† 
)
††  
{
°° 
Console
¢¢ 
.
¢¢ 
	WriteLine
¢¢ !
(
¢¢! "
$str
¢¢" ]
)
¢¢] ^
;
¢¢^ _
Console
££ 
.
££ 
	WriteLine
££ !
(
££! "
$str
££" -
)
££- .
;
££. /
Console
§§ 
.
§§ 
	WriteLine
§§ !
(
§§! "
ex
§§" $
.
§§$ %
Message
§§% ,
)
§§, -
;
§§- .
}
•• 
}
¶¶ 	
private
¨¨ 
static
¨¨ 
void
¨¨ $
ConsultarReciboDeEnvio
¨¨ 2
(
¨¨2 3
string
¨¨3 9
numeroRecibo
¨¨: F
)
¨¨F G
{
≠≠ 	
try
ÆÆ 
{
ØØ 
var
∞∞ 
	nfeFacade
∞∞ 
=
∞∞ 
	GetFacade
∞∞  )
(
∞∞) *
)
∞∞* +
;
∞∞+ ,
if
±± 
(
±± 
	nfeFacade
±± 
==
±±  
null
±±! %
)
±±% &
return
±±' -
;
±±- .
var
≥≥ 
booStatusOk
≥≥ 
=
≥≥  !$
ConsultarStatusServico
≥≥" 8
(
≥≥8 9
)
≥≥9 :
;
≥≥: ;
if
µµ 
(
µµ 
!
µµ 
booStatusOk
µµ  
)
µµ  !
{
∂∂ 
return
∑∑ 
;
∑∑ 
}
∏∏ 
var
∫∫ &
retornoConsultaProtocolo
∫∫ ,
=
∫∫- .
	nfeFacade
∫∫/ 8
.
∫∫8 9$
ConsultarReciboDeEnvio
∫∫9 O
(
∫∫O P
numeroRecibo
∫∫P \
)
∫∫\ ]
;
∫∫] ^
if
ªª 
(
ªª &
retornoConsultaProtocolo
ªª ,
.
ªª, -
Retorno
ªª- 4
.
ªª4 5
protNFe
ªª5 <
[
ªª< =
$num
ªª= >
]
ªª> ?
.
ªª? @
infProt
ªª@ G
.
ªªG H
nProt
ªªH M
!=
ªªN P
null
ªªQ U
)
ªªU V
{
ºº 
Console
ΩΩ 
.
ΩΩ 
	WriteLine
ΩΩ %
(
ΩΩ% &
$str
ΩΩ& -
+
ΩΩ. /&
retornoConsultaProtocolo
ΩΩ0 H
.
ΩΩH I
Retorno
ΩΩI P
.
ΩΩP Q
protNFe
ΩΩQ X
[
ΩΩX Y
$num
ΩΩY Z
]
ΩΩZ [
.
ΩΩ[ \
infProt
ΩΩ\ c
.
ΩΩc d
nProt
ΩΩd i
)
ΩΩi j
;
ΩΩj k
}
ææ 
if
øø 
(
øø &
retornoConsultaProtocolo
øø ,
.
øø, -
Retorno
øø- 4
.
øø4 5
protNFe
øø5 <
[
øø< =
$num
øø= >
]
øø> ?
.
øø? @
infProt
øø@ G
!=
øøH J
null
øøK O
)
øøO P
{
¿¿ 
Console
¡¡ 
.
¡¡ 
	WriteLine
¡¡ %
(
¡¡% &
$str
¡¡& .
+
¡¡/ 0&
retornoConsultaProtocolo
¡¡1 I
.
¡¡I J
Retorno
¡¡J Q
.
¡¡Q R
protNFe
¡¡R Y
[
¡¡Y Z
$num
¡¡Z [
]
¡¡[ \
.
¡¡\ ]
infProt
¡¡] d
.
¡¡d e
xMotivo
¡¡e l
)
¡¡l m
;
¡¡m n
}
¬¬ 
else
√√ 
{
ƒƒ 
Console
≈≈ 
.
≈≈ 
	WriteLine
≈≈ %
(
≈≈% &
$str
≈≈& .
+
≈≈/ 0&
retornoConsultaProtocolo
≈≈1 I
.
≈≈I J
Retorno
≈≈J Q
.
≈≈Q R
xMotivo
≈≈R Y
)
≈≈Y Z
;
≈≈Z [
}
∆∆ 
}
«« 
catch
»» 
(
»» 
	Exception
»» 
ex
»» 
)
»»  
{
…… 
Console
   
.
   
	WriteLine
   !
(
  ! "
$str
  " A
)
  A B
;
  B C
Console
ÀÀ 
.
ÀÀ 
	WriteLine
ÀÀ !
(
ÀÀ! "
string
ÀÀ" (
.
ÀÀ( )
Format
ÀÀ) /
(
ÀÀ/ 0
$str
ÀÀ0 ?
,
ÀÀ? @
ex
ÀÀA C
.
ÀÀC D
Message
ÀÀD K
)
ÀÀK L
)
ÀÀL M
;
ÀÀM N
}
ÃÃ 
}
ÕÕ 	
}
œœ 
}–– É
XC:\Users\SWDEV\Source\Repos\SW10.SWMANAGER\NFe\NFe.Integracao\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str )
)) *
]* +
[ 
assembly 	
:	 

AssemblyDescription 
( 
$str !
)! "
]" #
[		 
assembly		 	
:			 
!
AssemblyConfiguration		  
(		  !
$str		! #
)		# $
]		$ %
[

 
assembly

 	
:

	 

AssemblyCompany

 
(

 
$str

 
)

 
]

 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str +
)+ ,
], -
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
["" 
assembly"" 	
:""	 

AssemblyVersion"" 
("" 
$str"" &
)""& '
]""' (
[## 
assembly## 	
:##	 

AssemblyFileVersion## 
(## 
$str## *
)##* +
]##+ ,¢
QC:\Users\SWDEV\Source\Repos\SW10.SWMANAGER\NFe\NFe.Integracao\Enums\TipoXmlNFe.cs
	namespace"" 	
NFe""
 
."" 

Integracao"" 
."" 
Enums"" 
{## 
public$$ 

enum$$ 

TipoXmlNFe$$ 
{%% 
NFe&& 
,&& 
Lote'' 
,'' 
Destinatario(( 
,(( 
})) 
}** £«
JC:\Users\SWDEV\Source\Repos\SW10.SWMANAGER\NFe\NFe.Integracao\NFeFacade.cs
	namespace11 	
NFe11
 
.11 

Integracao11 
{22 
public33 

class33 
	NFeFacade33 
{44 
public55 
	NFeFacade55 
(55 
)55 
{66 	!
CarregarConfiguracoes77 !
(77! "
)77" #
;77# $
}88 	
public>> 
retConsStatServ>> "
ConsultarStatusServico>> 5
(>>5 6
)>>6 7
{?? 	
var@@ 

servicoNFe@@ 
=@@ 
new@@  
ServicosNFe@@! ,
(@@, -
ConfiguracaoServico@@- @
.@@@ A
	Instancia@@A J
)@@J K
;@@K L
returnAA 

servicoNFeAA 
.AA 
NfeStatusServicoAA .
(AA. /
)AA/ 0
.AA0 1
RetornoAA1 8
;AA8 9
}BB 	
publicII !
RetornoNFeAutorizacaoII $
	EnviarNFeII% .
(II. /
Int32II/ 4
numLoteII5 <
,II< =
ClassesII> E
.IIE F
NFeIIF I
nfeIIJ M
)IIM N
{JJ 	
nfeKK 
.KK 
AssinaKK 
(KK 
)KK 
;KK 
varLL 

servicoNFeLL 
=LL 
newLL  
ServicosNFeLL! ,
(LL, -
ConfiguracaoServicoLL- @
.LL@ A
	InstanciaLLA J
)LLJ K
;LLK L
returnMM 

servicoNFeMM 
.MM 
NFeAutorizacaoMM ,
(MM, -
numLoteMM- 4
,MM4 5"
IndicadorSincronizacaoMM6 L
.MML M

AssincronoMMM W
,MMW X
newMMY \
ListMM] a
<MMa b
ClassesMMb i
.MMi j
NFeMMj m
>MMm n
{MMo p
nfeMMq t
}MMu v
)MMv w
;MMw x
}NN 	
publicXX &
RetornoNfeConsultaCadastroXX )
ConsultaCadastroXX* :
(XX: ;
stringXX; A
ufXXB D
,XXD E)
ConsultaCadastroTipoDocumentoXXF c
tipoDocumentoXXd q
,XXq r
stringYY 
	documentoYY 
)YY 
{ZZ 	
var[[ 

servicoNFe[[ 
=[[ 
new[[  
ServicosNFe[[! ,
([[, -
ConfiguracaoServico[[- @
.[[@ A
	Instancia[[A J
)[[J K
;[[K L
return\\ 

servicoNFe\\ 
.\\ 
NfeConsultaCadastro\\ 1
(\\1 2
uf\\2 4
,\\4 5
tipoDocumento\\6 C
,\\C D
	documento\\E N
)\\N O
;\\O P
}]] 	
publiccc $
RetornoNFeRetAutorizacaocc '"
ConsultarReciboDeEnviocc( >
(cc> ?
stringcc? E
reciboccF L
)ccL M
{dd 	
varee 

servicoNFeee 
=ee 
newee  
ServicosNFeee! ,
(ee, -
ConfiguracaoServicoee- @
.ee@ A
	InstanciaeeA J
)eeJ K
;eeK L
returnff 

servicoNFeff 
.ff 
NFeRetAutorizacaoff /
(ff/ 0
reciboff0 6
)ff6 7
;ff7 8
}gg 	
publicrr !
RetornoRecepcaoEventorr $
CancelarNFerr% 0
(rr0 1
stringrr1 7
cnpjEmitenterr8 D
,rrD E
intrrF I

numeroLoterrJ T
,rrT U
shortrrV [
sequenciaEventorr\ k
,rrk l
stringrrm s
chaveAcessorrt 
,	rr Ä
stringss 
	protocoloss 
,ss 
stringss $
justificativass% 2
)ss2 3
{tt 	
varuu 

servicoNFeuu 
=uu 
newuu  
ServicosNFeuu! ,
(uu, -
ConfiguracaoServicouu- @
.uu@ A
	InstanciauuA J
)uuJ K
;uuK L
returnvv 

servicoNFevv 
.vv &
RecepcaoEventoCancelamentovv 8
(vv8 9

numeroLotevv9 C
,vvC D
sequenciaEventovvE T
,vvT U
	protocolovvV _
,vv_ `
chaveAcessovva l
,vvl m
justificativavvn {
,vv{ |
cnpjEmitente	vv} â
)
vvâ ä
;
vvä ã
}ww 	
public
ÇÇ $
RetornoNfeInutilizacao
ÇÇ %!
InutilizarNumeracao
ÇÇ& 9
(
ÇÇ9 :
int
ÇÇ: =
ano
ÇÇ> A
,
ÇÇA B
string
ÇÇC I
cnpj
ÇÇJ N
,
ÇÇN O
string
ÇÇP V
justificativa
ÇÇW d
,
ÇÇd e
int
ÉÉ 
numeroInicial
ÉÉ 
,
ÉÉ 
int
ÉÉ "
numeroFinal
ÉÉ# .
,
ÉÉ. /
int
ÉÉ0 3
serie
ÉÉ4 9
)
ÉÉ9 :
{
ÑÑ 	
var
ÖÖ 

servicoNFe
ÖÖ 
=
ÖÖ 
new
ÖÖ  
ServicosNFe
ÖÖ! ,
(
ÖÖ, -!
ConfiguracaoServico
ÖÖ- @
.
ÖÖ@ A
	Instancia
ÖÖA J
)
ÖÖJ K
;
ÖÖK L
return
ÜÜ 

servicoNFe
ÜÜ 
.
ÜÜ 
NfeInutilizacao
ÜÜ -
(
ÜÜ- .
cnpj
ÜÜ. 2
,
ÜÜ2 3
Convert
ÜÜ4 ;
.
ÜÜ; <
ToInt16
ÜÜ< C
(
ÜÜC D
ano
ÜÜD G
.
ÜÜG H
ToString
ÜÜH P
(
ÜÜP Q
)
ÜÜQ R
.
ÜÜR S
	Substring
ÜÜS \
(
ÜÜ\ ]
$num
ÜÜ] ^
,
ÜÜ^ _
$num
ÜÜ` a
)
ÜÜa b
)
ÜÜb c
,
ÜÜc d!
ConfiguracaoServico
ÜÜe x
.
ÜÜx y
	InstanciaÜÜy Ç
.ÜÜÇ É
ModeloDocumentoÜÜÉ í
,ÜÜí ì
ConvertÜÜî õ
.ÜÜõ ú
ToInt16ÜÜú £
(ÜÜ£ §
serieÜÜ§ ©
)ÜÜ© ™
,ÜÜ™ ´
ConvertÜÜ¨ ≥
.ÜÜ≥ ¥
ToInt32ÜÜ¥ ª
(ÜÜª º
numeroInicialÜÜº …
)ÜÜ…  
,ÜÜ  À
ConvertÜÜÃ ”
.ÜÜ” ‘
ToInt32ÜÜ‘ €
(ÜÜ€ ‹
numeroFinalÜÜ‹ Á
)ÜÜÁ Ë
,ÜÜË È
justificativaÜÜÍ ˜
)ÜÜ˜ ¯
;ÜÜ¯ ˘
}
áá 	
private
ãã 
void
ãã #
CarregarConfiguracoes
ãã *
(
ãã* +
)
ãã+ ,
{
åå 	!
ConfiguracaoServico
éé 
.
éé  
	Instancia
éé  )
.
éé) *
Certificado
éé* 5
.
éé5 6
Arquivo
éé6 =
=
éé> ?

Properties
éé@ J
.
ééJ K
Settings
ééK S
.
ééS T
Default
ééT [
.
éé[ \!
certificado_arquivo
éé\ o
;
ééo p!
ConfiguracaoServico
èè 
.
èè  
	Instancia
èè  )
.
èè) *
Certificado
èè* 5
.
èè5 6
Senha
èè6 ;
=
èè< =

Properties
èè> H
.
èèH I
Settings
èèI Q
.
èèQ R
Default
èèR Y
.
èèY Z
certificado_senha
èèZ k
;
èèk l!
ConfiguracaoServico
êê 
.
êê  
	Instancia
êê  )
.
êê) * 
DiretorioSalvarXml
êê* <
=
êê= >

Properties
êê? I
.
êêI J
Settings
êêJ R
.
êêR S
Default
êêS Z
.
êêZ [
diretorio_xml
êê[ h
;
êêh i
	EstadoNfe
íí 
uf
íí 
;
íí 
Enum
ìì 
.
ìì 
TryParse
ìì 
(
ìì 

Properties
ìì $
.
ìì$ %
Settings
ìì% -
.
ìì- .
Default
ìì. 5
.
ìì5 6
estado_emitente
ìì6 E
,
ììE F
out
ììG J
uf
ììK M
)
ììM N
;
ììN O!
ConfiguracaoServico
îî 
.
îî  
	Instancia
îî  )
.
îî) *
cUF
îî* -
=
îî. /
uf
îî0 2
;
îî2 3!
ConfiguracaoServico
ññ 
.
ññ  
	Instancia
ññ  )
.
ññ) *
DiretorioSchemas
ññ* :
=
ññ; <

Properties
ññ= G
.
ññG H
Settings
ññH P
.
ññP Q
Default
ññQ X
.
ññX Y
diretorio_schemas
ññY j
;
ññj k
ModeloDocumento
óó 
mod
óó 
;
óó  
Enum
òò 
.
òò 
TryParse
òò 
(
òò 

Properties
òò $
.
òò$ %
Settings
òò% -
.
òò- .
Default
òò. 5
.
òò5 6
modelo_documento
òò6 F
,
òòF G
out
òòH K
mod
òòL O
)
òòO P
;
òòP Q!
ConfiguracaoServico
ôô 
.
ôô  
	Instancia
ôô  )
.
ôô) *
ModeloDocumento
ôô* 9
=
ôô: ;
mod
ôô< ?
;
ôô? @!
ConfiguracaoServico
õõ 
.
õõ  
	Instancia
õõ  )
.
õõ) *
SalvarXmlServicos
õõ* ;
=
õõ< =

Properties
õõ> H
.
õõH I
Settings
õõI Q
.
õõQ R
Default
õõR Y
.
õõY Z!
salvar_xml_servicos
õõZ m
==
õõn p
$str
õõq t
;
õõt u
int
ùù 
time
ùù 
;
ùù 
int
ûû 
.
ûû 
TryParse
ûû 
(
ûû 

Properties
ûû #
.
ûû# $
Settings
ûû$ ,
.
ûû, -
Default
ûû- 4
.
ûû4 5
time_out
ûû5 =
,
ûû= >
out
ûû? B
time
ûûC G
)
ûûG H
;
ûûH I!
ConfiguracaoServico
üü 
.
üü  
	Instancia
üü  )
.
üü) *
TimeOut
üü* 1
=
üü2 3
time
üü4 8
;
üü8 9
TipoAmbiente
°° 
tamb
°° 
;
°° 
Enum
¢¢ 
.
¢¢ 
TryParse
¢¢ 
(
¢¢ 

Properties
¢¢ $
.
¢¢$ %
Settings
¢¢% -
.
¢¢- .
Default
¢¢. 5
.
¢¢5 6
tipo_ambiente
¢¢6 C
,
¢¢C D
out
¢¢E H
tamb
¢¢I M
)
¢¢M N
;
¢¢N O!
ConfiguracaoServico
££ 
.
££  
	Instancia
££  )
.
££) *
tpAmb
££* /
=
££0 1
tamb
££2 6
;
££6 7
TipoEmissao
•• 
temiss
•• 
;
•• 
Enum
¶¶ 
.
¶¶ 
TryParse
¶¶ 
(
¶¶ 

Properties
¶¶ $
.
¶¶$ %
Settings
¶¶% -
.
¶¶- .
Default
¶¶. 5
.
¶¶5 6
tipo_emissao
¶¶6 B
,
¶¶B C
out
¶¶D G
temiss
¶¶H N
)
¶¶N O
;
¶¶O P!
ConfiguracaoServico
ßß 
.
ßß  
	Instancia
ßß  )
.
ßß) *
tpEmis
ßß* 0
=
ßß1 2
temiss
ßß3 9
;
ßß9 :!
ConfiguracaoServico
™™ 
.
™™  
	Instancia
™™  )
.
™™) *'
VersaoNfceAministracaoCSC
™™* C
=
™™D E
VersaoServico
™™F S
.
™™S T
ve310
™™T Y
;
™™Y Z!
ConfiguracaoServico
´´ 
.
´´  
	Instancia
´´  )
.
´´) *"
VersaoNFeAutorizacao
´´* >
=
´´? @
VersaoServico
´´A N
.
´´N O
ve310
´´O T
;
´´T U!
ConfiguracaoServico
¨¨ 
.
¨¨  
	Instancia
¨¨  )
.
¨¨) *'
VersaoNfeConsultaCadastro
¨¨* C
=
¨¨D E
VersaoServico
¨¨F S
.
¨¨S T
ve310
¨¨T Y
;
¨¨Y Z!
ConfiguracaoServico
≠≠ 
.
≠≠  
	Instancia
≠≠  )
.
≠≠) *#
VersaoNfeConsultaDest
≠≠* ?
=
≠≠@ A
VersaoServico
≠≠B O
.
≠≠O P
ve310
≠≠P U
;
≠≠U V!
ConfiguracaoServico
ÆÆ 
.
ÆÆ  
	Instancia
ÆÆ  )
.
ÆÆ) *(
VersaoNfeConsultaProtocolo
ÆÆ* D
=
ÆÆE F
VersaoServico
ÆÆG T
.
ÆÆT U
ve310
ÆÆU Z
;
ÆÆZ [!
ConfiguracaoServico
ØØ 
.
ØØ  
	Instancia
ØØ  )
.
ØØ) *&
VersaoNFeDistribuicaoDFe
ØØ* B
=
ØØC D
VersaoServico
ØØE R
.
ØØR S
ve310
ØØS X
;
ØØX Y!
ConfiguracaoServico
∞∞ 
.
∞∞  
	Instancia
∞∞  )
.
∞∞) *!
VersaoNfeDownloadNF
∞∞* =
=
∞∞> ?
VersaoServico
∞∞@ M
.
∞∞M N
ve310
∞∞N S
;
∞∞S T!
ConfiguracaoServico
±± 
.
±±  
	Instancia
±±  )
.
±±) *#
VersaoNfeInutilizacao
±±* ?
=
±±@ A
VersaoServico
±±B O
.
±±O P
ve310
±±P U
;
±±U V!
ConfiguracaoServico
≤≤ 
.
≤≤  
	Instancia
≤≤  )
.
≤≤) *
VersaoNfeRecepcao
≤≤* ;
=
≤≤< =
VersaoServico
≤≤> K
.
≤≤K L
ve310
≤≤L Q
;
≤≤Q R!
ConfiguracaoServico
≥≥ 
.
≥≥  
	Instancia
≥≥  )
.
≥≥) *%
VersaoNFeRetAutorizacao
≥≥* A
=
≥≥B C
VersaoServico
≥≥D Q
.
≥≥Q R
ve310
≥≥R W
;
≥≥W X!
ConfiguracaoServico
¥¥ 
.
¥¥  
	Instancia
¥¥  )
.
¥¥) *"
VersaoNfeRetRecepcao
¥¥* >
=
¥¥? @
VersaoServico
¥¥A N
.
¥¥N O
ve310
¥¥O T
;
¥¥T U!
ConfiguracaoServico
µµ 
.
µµ  
	Instancia
µµ  )
.
µµ) *$
VersaoNfeStatusServico
µµ* @
=
µµA B
VersaoServico
µµC P
.
µµP Q
ve310
µµQ V
;
µµV W!
ConfiguracaoServico
∂∂ 
.
∂∂  
	Instancia
∂∂  )
.
∂∂) *1
#VersaoRecepcaoEventoCceCancelamento
∂∂* M
=
∂∂N O
VersaoServico
∂∂P ]
.
∂∂] ^
ve310
∂∂^ c
;
∂∂c d
}
ππ 	
public
ææ 
bool
ææ 
IsConfigured
ææ  
(
ææ  !
)
ææ! "
{
øø 	
var
¿¿ 
list
¿¿ 
=
¿¿ 
new
¿¿ 
List
¿¿ 
<
¿¿  
string
¿¿  &
>
¿¿& '
(
¿¿' (
)
¿¿( )
;
¿¿) *
list
¡¡ 
.
¡¡ 
Add
¡¡ 
(
¡¡ 

Properties
¡¡ 
.
¡¡  
Settings
¡¡  (
.
¡¡( )
Default
¡¡) 0
.
¡¡0 1!
certificado_arquivo
¡¡1 D
)
¡¡D E
;
¡¡E F
list
¬¬ 
.
¬¬ 
Add
¬¬ 
(
¬¬ 

Properties
¬¬ 
.
¬¬  
Settings
¬¬  (
.
¬¬( )
Default
¬¬) 0
.
¬¬0 1
certificado_senha
¬¬1 B
)
¬¬B C
;
¬¬C D
list
√√ 
.
√√ 
Add
√√ 
(
√√ 

Properties
√√ 
.
√√  
Settings
√√  (
.
√√( )
Default
√√) 0
.
√√0 1
diretorio_xml
√√1 >
)
√√> ?
;
√√? @
list
ƒƒ 
.
ƒƒ 
Add
ƒƒ 
(
ƒƒ 

Properties
ƒƒ 
.
ƒƒ  
Settings
ƒƒ  (
.
ƒƒ( )
Default
ƒƒ) 0
.
ƒƒ0 1
diretorio_schemas
ƒƒ1 B
)
ƒƒB C
;
ƒƒC D
list
≈≈ 
.
≈≈ 
Add
≈≈ 
(
≈≈ 

Properties
≈≈ 
.
≈≈  
Settings
≈≈  (
.
≈≈( )
Default
≈≈) 0
.
≈≈0 1
estado_emitente
≈≈1 @
)
≈≈@ A
;
≈≈A B
list
∆∆ 
.
∆∆ 
Add
∆∆ 
(
∆∆ 

Properties
∆∆ 
.
∆∆  
Settings
∆∆  (
.
∆∆( )
Default
∆∆) 0
.
∆∆0 1
modelo_documento
∆∆1 A
)
∆∆A B
;
∆∆B C
list
«« 
.
«« 
Add
«« 
(
«« 

Properties
«« 
.
««  
Settings
««  (
.
««( )
Default
««) 0
.
««0 1!
salvar_xml_servicos
««1 D
)
««D E
;
««E F
list
»» 
.
»» 
Add
»» 
(
»» 

Properties
»» 
.
»»  
Settings
»»  (
.
»»( )
Default
»») 0
.
»»0 1
time_out
»»1 9
)
»»9 :
;
»»: ;
list
…… 
.
…… 
Add
…… 
(
…… 

Properties
…… 
.
……  
Settings
……  (
.
……( )
Default
……) 0
.
……0 1
tipo_ambiente
……1 >
)
……> ?
;
……? @
list
   
.
   
Add
   
(
   

Properties
   
.
    
Settings
    (
.
  ( )
Default
  ) 0
.
  0 1
tipo_emissao
  1 =
)
  = >
;
  > ?
return
ÃÃ 
!
ÃÃ 
list
ÃÃ 
.
ÃÃ 
Any
ÃÃ 
(
ÃÃ 
string
ÃÃ #
.
ÃÃ# $ 
IsNullOrWhiteSpace
ÃÃ$ 6
)
ÃÃ6 7
;
ÃÃ7 8
}
ŒŒ 	
public
‹‹ 
static
‹‹ 
void
‹‹ 
SetConfiguracoes
‹‹ +
(
‹‹+ ,
string
‹‹, 2
pathcertificado
‹‹3 B
,
‹‹B C
string
‹‹D J
certificadosenha
‹‹K [
,
‹‹[ \
string
‹‹] c
pathxml
‹‹d k
,
‹‹k l
string
›› 
	pathchema
›› 
,
›› 
string
›› $
emitente
››% -
,
››- .
string
››/ 5
modelodocumento
››6 E
,
››E F
string
››G M
salvarxmlservico
››N ^
,
››^ _
string
››` f
timeout
››g n
,
››n o
string
ﬁﬁ 
tmpamb
ﬁﬁ 
,
ﬁﬁ 
string
ﬁﬁ !

tmpemissao
ﬁﬁ" ,
)
ﬁﬁ, -
{
ﬂﬂ 	

Properties
·· 
.
·· 
Settings
·· 
.
··  
Default
··  '
.
··' (!
salvar_xml_servicos
··( ;
=
··< =
salvarxmlservico
··> N
==
··O Q
$str
··R U
?
··V W
$str
··X [
:
··\ ]
$str
··^ a
;
··a b

Properties
‚‚ 
.
‚‚ 
Settings
‚‚ 
.
‚‚  
Default
‚‚  '
.
‚‚' (!
certificado_arquivo
‚‚( ;
=
‚‚< =
ConvertToLower
‚‚> L
(
‚‚L M
pathcertificado
‚‚M \
)
‚‚\ ]
;
‚‚] ^

Properties
„„ 
.
„„ 
Settings
„„ 
.
„„  
Default
„„  '
.
„„' (
certificado_senha
„„( 9
=
„„: ;
ConvertToLower
„„< J
(
„„J K
certificadosenha
„„K [
)
„„[ \
;
„„\ ]

Properties
‰‰ 
.
‰‰ 
Settings
‰‰ 
.
‰‰  
Default
‰‰  '
.
‰‰' (
diretorio_xml
‰‰( 5
=
‰‰6 7
ConvertToLower
‰‰8 F
(
‰‰F G
pathxml
‰‰G N
)
‰‰N O
;
‰‰O P

Properties
ÂÂ 
.
ÂÂ 
Settings
ÂÂ 
.
ÂÂ  
Default
ÂÂ  '
.
ÂÂ' (
diretorio_schemas
ÂÂ( 9
=
ÂÂ: ;
ConvertToLower
ÂÂ< J
(
ÂÂJ K
	pathchema
ÂÂK T
)
ÂÂT U
;
ÂÂU V

Properties
ÊÊ 
.
ÊÊ 
Settings
ÊÊ 
.
ÊÊ  
Default
ÊÊ  '
.
ÊÊ' (
estado_emitente
ÊÊ( 7
=
ÊÊ8 9
ConvertToLower
ÊÊ: H
(
ÊÊH I
emitente
ÊÊI Q
)
ÊÊQ R
;
ÊÊR S

Properties
ÁÁ 
.
ÁÁ 
Settings
ÁÁ 
.
ÁÁ  
Default
ÁÁ  '
.
ÁÁ' (
modelo_documento
ÁÁ( 8
=
ÁÁ9 :
ConvertToLower
ÁÁ; I
(
ÁÁI J
modelodocumento
ÁÁJ Y
)
ÁÁY Z
;
ÁÁZ [

Properties
ËË 
.
ËË 
Settings
ËË 
.
ËË  
Default
ËË  '
.
ËË' (!
salvar_xml_servicos
ËË( ;
=
ËË< =
ConvertToLower
ËË> L
(
ËËL M
salvarxmlservico
ËËM ]
)
ËË] ^
;
ËË^ _

Properties
ÈÈ 
.
ÈÈ 
Settings
ÈÈ 
.
ÈÈ  
Default
ÈÈ  '
.
ÈÈ' (
time_out
ÈÈ( 0
=
ÈÈ1 2
string
ÈÈ3 9
.
ÈÈ9 : 
IsNullOrWhiteSpace
ÈÈ: L
(
ÈÈL M
timeout
ÈÈM T
)
ÈÈT U
?
ÈÈV W
$str
ÈÈX ^
:
ÈÈ_ `
timeout
ÈÈa h
;
ÈÈh i

Properties
ÍÍ 
.
ÍÍ 
Settings
ÍÍ 
.
ÍÍ  
Default
ÍÍ  '
.
ÍÍ' (
tipo_ambiente
ÍÍ( 5
=
ÍÍ6 7
ConvertToLower
ÍÍ8 F
(
ÍÍF G
tmpamb
ÍÍG M
)
ÍÍM N
;
ÍÍN O

Properties
ÎÎ 
.
ÎÎ 
Settings
ÎÎ 
.
ÎÎ  
Default
ÎÎ  '
.
ÎÎ' (
tipo_emissao
ÎÎ( 4
=
ÎÎ5 6
ConvertToLower
ÎÎ7 E
(
ÎÎE F

tmpemissao
ÎÎF P
)
ÎÎP Q
;
ÎÎQ R

Properties
ÓÓ 
.
ÓÓ 
Settings
ÓÓ 
.
ÓÓ  
Default
ÓÓ  '
.
ÓÓ' (
Save
ÓÓ( ,
(
ÓÓ, -
)
ÓÓ- .
;
ÓÓ. /
}
 	
public
ÚÚ 
static
ÚÚ 
IEnumerable
ÚÚ !
<
ÚÚ! "
string
ÚÚ" (
>
ÚÚ( )
GetConfiguracao
ÚÚ* 9
(
ÚÚ9 :
)
ÚÚ: ;
{
ÛÛ 	
ModeloDocumento
ıı 
mod
ıı 
;
ıı  
Enum
ˆˆ 
.
ˆˆ 
TryParse
ˆˆ 
(
ˆˆ 

Properties
ˆˆ $
.
ˆˆ$ %
Settings
ˆˆ% -
.
ˆˆ- .
Default
ˆˆ. 5
.
ˆˆ5 6
modelo_documento
ˆˆ6 F
,
ˆˆF G
out
ˆˆH K
mod
ˆˆL O
)
ˆˆO P
;
ˆˆP Q
TipoAmbiente
˜˜ 
tamb
˜˜ 
;
˜˜ 
Enum
¯¯ 
.
¯¯ 
TryParse
¯¯ 
(
¯¯ 

Properties
¯¯ $
.
¯¯$ %
Settings
¯¯% -
.
¯¯- .
Default
¯¯. 5
.
¯¯5 6
tipo_ambiente
¯¯6 C
,
¯¯C D
out
¯¯E H
tamb
¯¯I M
)
¯¯M N
;
¯¯N O
TipoEmissao
˘˘ 
temiss
˘˘ 
;
˘˘ 
Enum
˙˙ 
.
˙˙ 
TryParse
˙˙ 
(
˙˙ 

Properties
˙˙ $
.
˙˙$ %
Settings
˙˙% -
.
˙˙- .
Default
˙˙. 5
.
˙˙5 6
tipo_emissao
˙˙6 B
,
˙˙B C
out
˙˙D G
temiss
˙˙H N
)
˙˙N O
;
˙˙O P
var
˚˚ 
isSave
˚˚ 
=
˚˚ 

Properties
˚˚ #
.
˚˚# $
Settings
˚˚$ ,
.
˚˚, -
Default
˚˚- 4
.
˚˚4 5!
salvar_xml_servicos
˚˚5 H
==
˚˚I K
$str
˚˚L O
?
˚˚P Q
$str
˚˚R W
:
˚˚X Y
$str
˚˚Z _
;
˚˚_ `
var
˛˛ 
list
˛˛ 
=
˛˛ 
new
˛˛ 
List
˛˛ 
<
˛˛  
string
˛˛  &
>
˛˛& '
{
ˇˇ 
$str
ÄÄ &
+
ÄÄ' (
isSave
ÄÄ) /
,
ÄÄ/ 0
$str
ÅÅ 9
+
ÅÅ: ;

Properties
ÅÅ< F
.
ÅÅF G
Settings
ÅÅG O
.
ÅÅO P
Default
ÅÅP W
.
ÅÅW X!
certificado_arquivo
ÅÅX k
,
ÅÅk l
$str
ÇÇ 7
,
ÇÇ7 8
$str
ÉÉ *
+
ÉÉ+ ,

Properties
ÉÉ- 7
.
ÉÉ7 8
Settings
ÉÉ8 @
.
ÉÉ@ A
Default
ÉÉA H
.
ÉÉH I
diretorio_xml
ÉÉI V
,
ÉÉV W
$str
ÑÑ -
+
ÑÑ. /

Properties
ÑÑ0 :
.
ÑÑ: ;
Settings
ÑÑ; C
.
ÑÑC D
Default
ÑÑD K
.
ÑÑK L
diretorio_schemas
ÑÑL ]
,
ÑÑ] ^
$str
ÖÖ #
+
ÖÖ$ %

Properties
ÖÖ& 0
.
ÖÖ0 1
Settings
ÖÖ1 9
.
ÖÖ9 :
Default
ÖÖ: A
.
ÖÖA B
estado_emitente
ÖÖB Q
,
ÖÖQ R
$str
ÜÜ '
+
ÜÜ( )
mod
ÜÜ* -
,
ÜÜ- .
$str
áá .
+
áá/ 0

Properties
áá1 ;
.
áá; <
Settings
áá< D
.
ááD E
Default
ááE L
.
ááL M
time_out
ááM U
,
ááU V
$str
àà 
+
àà 
tamb
àà #
.
àà# $
	Descricao
àà$ -
(
àà- .
)
àà. /
,
àà/ 0
$str
ââ #
+
ââ$ %
temiss
ââ& ,
.
ââ, -
	Descricao
ââ- 6
(
ââ6 7
)
ââ7 8
}
ää 
;
ää 
return
åå 
list
åå 
;
åå 
}
éé 	
private
îî 
static
îî 
string
îî 
ConvertToLower
îî ,
(
îî, -
string
îî- 3
str
îî4 7
)
îî7 8
{
ïï 	
return
ññ 
string
ññ 
.
ññ  
IsNullOrWhiteSpace
ññ ,
(
ññ, -
str
ññ- 0
)
ññ0 1
?
ññ2 3
$str
ññ4 6
:
ññ7 8
str
ññ9 <
.
ññ< =
Trim
ññ= A
(
ññA B
)
ññB C
.
ññC D
ToLower
ññD K
(
ññK L
)
ññL M
;
ññM N
}
óó 	
}
öö 
}õõ 