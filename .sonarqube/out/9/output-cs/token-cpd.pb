¸ˆ
JC:\Users\SWDEV\Source\Repos\SW10.SWMANAGER\NFe\NFe.Servicos\Enderecador.cs
	namespace,, 	
NFe,,
 
.,, 
Servicos,, 
{-- 
internal11 
class11 
EnderecoServico11 "
{22 
public33 
EnderecoServico33 
(33 

ServicoNFe33 )

servicoNFe33* 4
,334 5
VersaoServico336 C
versaoServico33D Q
,33Q R
TipoAmbiente33S _
tipoAmbiente33` l
,33l m
TipoEmissao33n y
tipoEmissao	33z Ö
,
33Ö Ü
	EstadoNfe
33á ê
estado
33ë ó
,
33ó ò
ModeloDocumento
33ô ®
modeloDocumento
33© ∏
,
33∏ π
string
33∫ ¿
url
33¡ ƒ
)
33ƒ ≈
{44 	

ServicoNFe55 
=55 

servicoNFe55 #
;55# $
VersaoServico66 
=66 
versaoServico66 )
;66) *
TipoAmbiente77 
=77 
tipoAmbiente77 '
;77' (
TipoEmissao88 
=88 
tipoEmissao88 %
;88% &
Estado99 
=99 
estado99 
;99 
Url:: 
=:: 
url:: 
;:: 
ModeloDocumento;; 
=;; 
modeloDocumento;; -
;;;- .
}<< 	
public>> 

ServicoNFe>> 

ServicoNFe>> $
{>>% &
get>>' *
;>>* +
private>>, 3
set>>4 7
;>>7 8
}>>9 :
public?? 
VersaoServico?? 
VersaoServico?? *
{??+ ,
get??- 0
;??0 1
private??2 9
set??: =
;??= >
}??? @
public@@ 
TipoAmbiente@@ 
TipoAmbiente@@ (
{@@) *
get@@+ .
;@@. /
private@@0 7
set@@8 ;
;@@; <
}@@= >
publicAA 
TipoEmissaoAA 
TipoEmissaoAA &
{AA' (
getAA) ,
;AA, -
privateAA. 5
setAA6 9
;AA9 :
}AA; <
publicBB 
	EstadoNfeBB 
EstadoBB 
{BB  !
getBB" %
;BB% &
privateBB' .
setBB/ 2
;BB2 3
}BB4 5
publicCC 
ModeloDocumentoCC 
ModeloDocumentoCC .
{CC/ 0
getCC1 4
;CC4 5
privateCC6 =
setCC> A
;CCA B
}CCC D
publicDD 
stringDD 
UrlDD 
{DD 
getDD 
;DD  
privateDD! (
setDD) ,
;DD, -
}DD. /
}EE 
publicHH 

staticHH 
classHH 
EnderecadorHH #
{II 
privateJJ 
staticJJ 
readonlyJJ 
ListJJ  $
<JJ$ %
EnderecoServicoJJ% 4
>JJ4 5
ListaEnderecosJJ6 D
;JJD E
staticPP 
EnderecadorPP 
(PP 
)PP 
{QQ 	
ListaEnderecosRR 
=RR  
CarregarUrlsServicosRR 1
(RR1 2
)RR2 3
;RR3 4
}SS 	
privateXX 
staticXX 
ListXX 
<XX 
EnderecoServicoXX +
>XX+ , 
CarregarUrlsServicosXX- A
(XXA B
)XXB C
{YY 	
varZZ 

endServicoZZ 
=ZZ 
newZZ  
ListZZ! %
<ZZ% &
EnderecoServicoZZ& 5
>ZZ5 6
(ZZ6 7
)ZZ7 8
;ZZ8 9
var^^ 
emissaoComum^^ 
=^^ 
new^^ "
List^^# '
<^^' (
TipoEmissao^^( 3
>^^3 4
{^^5 6
TipoEmissao^^7 B
.^^B C
teNormal^^C K
,^^K L
TipoEmissao^^M X
.^^X Y
teEPEC^^Y _
,^^_ `
TipoEmissao^^a l
.^^l m
teFSIA^^m s
,^^s t
TipoEmissao	^^u Ä
.
^^Ä Å
teFSDA
^^Å á
,
^^á à
TipoEmissao
^^â î
.
^^î ï
	teOffLine
^^ï û
}
^^ü †
;
^^† °
var`` 
versaoDoisETres`` 
=``  !
new``" %
List``& *
<``* +
VersaoServico``+ 8
>``8 9
{``: ;
VersaoServico``< I
.``I J
ve200``J O
,``O P
VersaoServico``Q ^
.``^ _
ve310``_ d
}``e f
;``f g
varbb 
svanEstadosbb 
=bb 
newbb !
Listbb" &
<bb& '
	EstadoNfebb' 0
>bb0 1
{bb2 3
	EstadoNfebb4 =
.bb= >
MAbb> @
,bb@ A
	EstadoNfebbB K
.bbK L
PAbbL N
,bbN O
	EstadoNfebbP Y
.bbY Z
PIbbZ \
}bb] ^
;bb^ _
vardd '
svrsEstadosConsultaCadastrodd +
=dd, -
newdd. 1
Listdd2 6
<dd6 7
	EstadoNfedd7 @
>dd@ A
{ddB C
	EstadoNfeddD M
.ddM N
ACddN P
,ddP Q
	EstadoNfeddR [
.dd[ \
RNdd\ ^
,dd^ _
	EstadoNfedd` i
.ddi j
PBddj l
,ddl m
	EstadoNfeddn w
.ddw x
SCddx z
}dd{ |
;dd| }
varff %
svrsEstadosDemaisServicosff )
=ff* +
newff, /
Listff0 4
<ff4 5
	EstadoNfeff5 >
>ff> ?
{gg 
	EstadoNfehh 
.hh 
AChh 
,hh 
	EstadoNfeii 
.ii 
ALii 
,ii 
	EstadoNfejj 
.jj 
APjj 
,jj 
	EstadoNfekk 
.kk 
BAkk 
,kk 
	EstadoNfell 
.ll 
DFll 
,ll 
	EstadoNfemm 
.mm 
ESmm 
,mm 
	EstadoNfenn 
.nn 
MAnn 
,nn 
	EstadoNfeoo 
.oo 
PAoo 
,oo 
	EstadoNfepp 
.pp 
PBpp 
,pp 
	EstadoNfeqq 
.qq 
PIqq 
,qq 
	EstadoNferr 
.rr 
RJrr 
,rr 
	EstadoNfess 
.ss 
RNss 
,ss 
	EstadoNfett 
.tt 
ROtt 
,tt 
	EstadoNfeuu 
.uu 
RRuu 
,uu 
	EstadoNfevv 
.vv 
SCvv 
,vv 
	EstadoNfeww 
.ww 
SEww 
,ww 
	EstadoNfexx 
.xx 
TOxx 
}yy 
;yy 
var{{ 
svcanEstados{{ 
={{ 
new{{ "
List{{# '
<{{' (
	EstadoNfe{{( 1
>{{1 2
{{{3 4
	EstadoNfe{{5 >
.{{> ?
AC{{? A
,{{A B
	EstadoNfe{{C L
.{{L M
AL{{M O
,{{O P
	EstadoNfe{{Q Z
.{{Z [
AP{{[ ]
,{{] ^
	EstadoNfe{{_ h
.{{h i
DF{{i k
,{{k l
	EstadoNfe{{m v
.{{v w
ES{{w y
,{{y z
	EstadoNfe	{{{ Ñ
.
{{Ñ Ö
MG
{{Ö á
,
{{á à
	EstadoNfe
{{â í
.
{{í ì
PB
{{ì ï
,
{{ï ñ
	EstadoNfe
{{ó †
.
{{† °
RJ
{{° £
,
{{£ §
	EstadoNfe
{{• Æ
.
{{Æ Ø
RN
{{Ø ±
,
{{± ≤
	EstadoNfe
{{≥ º
.
{{º Ω
RO
{{Ω ø
,
{{ø ¿
	EstadoNfe
{{¡  
.
{{  À
RR
{{À Õ
,
{{Õ Œ
	EstadoNfe
{{œ ÿ
.
{{ÿ Ÿ
RS
{{Ÿ €
,
{{€ ‹
	EstadoNfe
{{› Ê
.
{{Ê Á
SC
{{Á È
,
{{È Í
	EstadoNfe
{{Î Ù
.
{{Ù ı
SE
{{ı ˜
,
{{˜ ¯
	EstadoNfe
{{˘ Ç
.
{{Ç É
SP
{{É Ö
,
{{Ö Ü
	EstadoNfe
{{á ê
.
{{ê ë
TO
{{ë ì
}
{{î ï
;
{{ï ñ
var}} 
svcRsEstados}} 
=}} 
new}} "
List}}# '
<}}' (
	EstadoNfe}}( 1
>}}1 2
{}}3 4
	EstadoNfe}}5 >
.}}> ?
AM}}? A
,}}A B
	EstadoNfe}}C L
.}}L M
BA}}M O
,}}O P
	EstadoNfe}}Q Z
.}}Z [
CE}}[ ]
,}}] ^
	EstadoNfe}}_ h
.}}h i
GO}}i k
,}}k l
	EstadoNfe}}m v
.}}v w
MA}}w y
,}}y z
	EstadoNfe	}}{ Ñ
.
}}Ñ Ö
MS
}}Ö á
,
}}á à
	EstadoNfe
}}â í
.
}}í ì
MT
}}ì ï
,
}}ï ñ
	EstadoNfe
}}ó †
.
}}† °
PA
}}° £
,
}}£ §
	EstadoNfe
}}• Æ
.
}}Æ Ø
PE
}}Ø ±
,
}}± ≤
	EstadoNfe
}}≥ º
.
}}º Ω
PI
}}Ω ø
,
}}ø ¿
	EstadoNfe
}}¡  
.
}}  À
PR
}}À Õ
}
}}Œ œ
;
}}œ –
var 
todosOsEstados 
=  
Enum! %
.% &
	GetValues& /
(/ 0
typeof0 6
(6 7
	EstadoNfe7 @
)@ A
)A B
.B C
CastC G
<G H
	EstadoNfeH Q
>Q R
(R S
)S T
.T U
ToListU [
([ \
)\ ]
;] ^
var
ÅÅ 
todosOsModelos
ÅÅ 
=
ÅÅ  
Enum
ÅÅ! %
.
ÅÅ% &
	GetValues
ÅÅ& /
(
ÅÅ/ 0
typeof
ÅÅ0 6
(
ÅÅ6 7
ModeloDocumento
ÅÅ7 F
)
ÅÅF G
)
ÅÅG H
.
ÅÅH I
Cast
ÅÅI M
<
ÅÅM N
ModeloDocumento
ÅÅN ]
>
ÅÅ] ^
(
ÅÅ^ _
)
ÅÅ_ `
.
ÅÅ` a
ToList
ÅÅa g
(
ÅÅg h
)
ÅÅh i
;
ÅÅi j
var
ÉÉ 
todosOsAmbientes
ÉÉ  
=
ÉÉ! "
Enum
ÉÉ# '
.
ÉÉ' (
	GetValues
ÉÉ( 1
(
ÉÉ1 2
typeof
ÉÉ2 8
(
ÉÉ8 9
TipoAmbiente
ÉÉ9 E
)
ÉÉE F
)
ÉÉF G
.
ÉÉG H
Cast
ÉÉH L
<
ÉÉL M
TipoAmbiente
ÉÉM Y
>
ÉÉY Z
(
ÉÉZ [
)
ÉÉ[ \
.
ÉÉ\ ]
ToList
ÉÉ] c
(
ÉÉc d
)
ÉÉd e
;
ÉÉe f
var
ÖÖ 
eventoCceCanc
ÖÖ 
=
ÖÖ 
new
ÖÖ  #
List
ÖÖ$ (
<
ÖÖ( )

ServicoNFe
ÖÖ) 3
>
ÖÖ3 4
{
ÖÖ5 6

ServicoNFe
ÖÖ7 A
.
ÖÖA B)
RecepcaoEventoCartaCorrecao
ÖÖB ]
,
ÖÖ] ^

ServicoNFe
ÖÖ_ i
.
ÖÖi j(
RecepcaoEventoCancelmentoÖÖj É
}ÖÖÑ Ö
;ÖÖÖ Ü
foreach
°° 
(
°° 
var
°° 
emissao
°°  
in
°°! #
emissaoComum
°°$ 0
)
°°0 1
{
¢¢ 
if
•• 
(
•• 
emissao
•• 
!=
•• 
TipoEmissao
•• *
.
••* +
teEPEC
••+ 1
)
••1 2

endServico
¶¶ 
.
¶¶ 
AddRange
¶¶ '
(
¶¶' (
eventoCceCanc
¶¶( 5
.
¶¶5 6
Select
¶¶6 <
(
¶¶< =

servicoNFe
¶¶= G
=>
¶¶H J
new
¶¶K N
EnderecoServico
¶¶O ^
(
¶¶^ _

servicoNFe
¶¶_ i
,
¶¶i j
VersaoServico
¶¶k x
.
¶¶x y
ve100
¶¶y ~
,
¶¶~ 
TipoAmbiente¶¶Ä å
.¶¶å ç
taHomologacao¶¶ç ö
,¶¶ö õ
emissao¶¶ú £
,¶¶£ §
	EstadoNfe¶¶• Æ
.¶¶Æ Ø
AM¶¶Ø ±
,¶¶± ≤
ModeloDocumento¶¶≥ ¬
.¶¶¬ √
NFe¶¶√ ∆
,¶¶∆ «
$str¶¶» ä
)¶¶ä ã
)¶¶ã å
)¶¶å ç
;¶¶ç é

endServico
ßß 
.
ßß 
Add
ßß 
(
ßß 
new
ßß "
EnderecoServico
ßß# 2
(
ßß2 3

ServicoNFe
ßß3 =
.
ßß= >
NfeRecepcao
ßß> I
,
ßßI J
VersaoServico
ßßK X
.
ßßX Y
ve200
ßßY ^
,
ßß^ _
TipoAmbiente
ßß` l
.
ßßl m
taHomologacao
ßßm z
,
ßßz {
emissaoßß| É
,ßßÉ Ñ
	EstadoNfeßßÖ é
.ßßé è
AMßßè ë
,ßßë í
ModeloDocumentoßßì ¢
.ßß¢ £
NFeßß£ ¶
,ßß¶ ß
$strßß® Ë
)ßßË È
)ßßÈ Í
;ßßÍ Î

endServico
®® 
.
®® 
Add
®® 
(
®® 
new
®® "
EnderecoServico
®®# 2
(
®®2 3

ServicoNFe
®®3 =
.
®®= >
NfeRetRecepcao
®®> L
,
®®L M
VersaoServico
®®N [
.
®®[ \
ve200
®®\ a
,
®®a b
TipoAmbiente
®®c o
.
®®o p
taHomologacao
®®p }
,
®®} ~
emissao®® Ü
,®®Ü á
	EstadoNfe®®à ë
.®®ë í
AM®®í î
,®®î ï
ModeloDocumento®®ñ •
.®®• ¶
NFe®®¶ ©
,®®© ™
$str®®´ Ó
)®®Ó Ô
)®®Ô 
;®® Ò

endServico
©© 
.
©© 
AddRange
©© #
(
©©# $
versaoDoisETres
™™ #
.
™™# $
Select
™™$ *
(
™™* +
versao
™™+ 1
=>
™™2 4
new
™™5 8
EnderecoServico
™™9 H
(
™™H I

ServicoNFe
™™I S
.
™™S T
NfeInutilizacao
™™T c
,
™™c d
versao
™™e k
,
™™k l
TipoAmbiente
™™m y
.
™™y z
taHomologacao™™z á
,™™á à
emissao™™â ê
,™™ê ë
	EstadoNfe™™í õ
.™™õ ú
AM™™ú û
,™™û ü
ModeloDocumento™™† Ø
.™™Ø ∞
NFe™™∞ ≥
,™™≥ ¥
$str™™µ ˘
)™™˘ ˙
)™™˙ ˚
)™™˚ ¸
;™™¸ ˝

endServico
´´ 
.
´´ 
AddRange
´´ #
(
´´# $
versaoDoisETres
¨¨ #
.
¨¨# $
Select
¨¨$ *
(
¨¨* +
versao
¨¨+ 1
=>
¨¨2 4
new
¨¨5 8
EnderecoServico
¨¨9 H
(
¨¨H I

ServicoNFe
¨¨I S
.
¨¨S T"
NfeConsultaProtocolo
¨¨T h
,
¨¨h i
versao
¨¨j p
,
¨¨p q
TipoAmbiente
¨¨r ~
.
¨¨~ 
taHomologacao¨¨ å
,¨¨å ç
emissao¨¨é ï
,¨¨ï ñ
	EstadoNfe¨¨ó †
.¨¨† °
AM¨¨° £
,¨¨£ §
ModeloDocumento¨¨• ¥
.¨¨¥ µ
NFe¨¨µ ∏
,¨¨∏ π
$str¨¨∫ ˙
)¨¨˙ ˚
)¨¨˚ ¸
)¨¨¸ ˝
;¨¨˝ ˛

endServico
≠≠ 
.
≠≠ 
AddRange
≠≠ #
(
≠≠# $
versaoDoisETres
ÆÆ #
.
ÆÆ# $
Select
ÆÆ$ *
(
ÆÆ* +
versao
ÆÆ+ 1
=>
ÆÆ2 4
new
ÆÆ5 8
EnderecoServico
ÆÆ9 H
(
ÆÆH I

ServicoNFe
ÆÆI S
.
ÆÆS T
NfeStatusServico
ÆÆT d
,
ÆÆd e
versao
ÆÆf l
,
ÆÆl m
TipoAmbiente
ÆÆn z
.
ÆÆz {
taHomologacaoÆÆ{ à
,ÆÆà â
emissaoÆÆä ë
,ÆÆë í
	EstadoNfeÆÆì ú
.ÆÆú ù
AMÆÆù ü
,ÆÆü †
ModeloDocumentoÆÆ° ∞
.ÆÆ∞ ±
NFeÆÆ± ¥
,ÆÆ¥ µ
$strÆÆ∂ ˚
)ÆÆ˚ ¸
)ÆÆ¸ ˝
)ÆÆ˝ ˛
;ÆÆ˛ ˇ

endServico
ØØ 
.
ØØ 
AddRange
ØØ #
(
ØØ# $
versaoDoisETres
∞∞ #
.
∞∞# $
Select
∞∞$ *
(
∞∞* +
versao
∞∞+ 1
=>
∞∞2 4
new
∞∞5 8
EnderecoServico
∞∞9 H
(
∞∞H I

ServicoNFe
∞∞I S
.
∞∞S T!
NfeConsultaCadastro
∞∞T g
,
∞∞g h
versao
∞∞i o
,
∞∞o p
TipoAmbiente
∞∞q }
.
∞∞} ~
taHomologacao∞∞~ ã
,∞∞ã å
emissao∞∞ç î
,∞∞î ï
	EstadoNfe∞∞ñ ü
.∞∞ü †
AM∞∞† ¢
,∞∞¢ £
ModeloDocumento∞∞§ ≥
.∞∞≥ ¥
NFe∞∞¥ ∑
,∞∞∑ ∏
$str∞∞π Å
)∞∞Å Ç
)∞∞Ç É
)∞∞É Ñ
;∞∞Ñ Ö

endServico
≤≤ 
.
≤≤ 
Add
≤≤ 
(
≤≤ 
new
≤≤ "
EnderecoServico
≤≤# 2
(
≤≤2 3

ServicoNFe
≤≤3 =
.
≤≤= >
NFeAutorizacao
≤≤> L
,
≤≤L M
VersaoServico
≤≤N [
.
≤≤[ \
ve310
≤≤\ a
,
≤≤a b
TipoAmbiente
≤≤c o
.
≤≤o p
taHomologacao
≤≤p }
,
≤≤} ~
emissao≤≤ Ü
,≤≤Ü á
	EstadoNfe≤≤à ë
.≤≤ë í
AM≤≤í î
,≤≤î ï
ModeloDocumento≤≤ñ •
.≤≤• ¶
NFe≤≤¶ ©
,≤≤© ™
$str≤≤´ Ì
)≤≤Ì Ó
)≤≤Ó Ô
;≤≤Ô 

endServico
≥≥ 
.
≥≥ 
Add
≥≥ 
(
≥≥ 
new
≥≥ "
EnderecoServico
≥≥# 2
(
≥≥2 3

ServicoNFe
≥≥3 =
.
≥≥= >
NFeRetAutorizacao
≥≥> O
,
≥≥O P
VersaoServico
≥≥Q ^
.
≥≥^ _
ve310
≥≥_ d
,
≥≥d e
TipoAmbiente
≥≥f r
.
≥≥r s
taHomologacao≥≥s Ä
,≥≥Ä Å
emissao≥≥Ç â
,≥≥â ä
	EstadoNfe≥≥ã î
.≥≥î ï
AM≥≥ï ó
,≥≥ó ò
ModeloDocumento≥≥ô ®
.≥≥® ©
NFe≥≥© ¨
,≥≥¨ ≠
$str≥≥Æ Û
)≥≥Û Ù
)≥≥Ù ı
;≥≥ı ˆ

endServico
ππ 
.
ππ 
Add
ππ 
(
ππ 
new
ππ "
EnderecoServico
ππ# 2
(
ππ2 3

ServicoNFe
ππ3 =
.
ππ= >
NFeAutorizacao
ππ> L
,
ππL M
VersaoServico
ππN [
.
ππ[ \
ve310
ππ\ a
,
ππa b
TipoAmbiente
ππc o
.
ππo p
taHomologacao
ππp }
,
ππ} ~
emissaoππ Ü
,ππÜ á
	EstadoNfeππà ë
.ππë í
AMππí î
,ππî ï
ModeloDocumentoππñ •
.ππ• ¶
NFCeππ¶ ™
,ππ™ ´
$strππ¨ ˜
)ππ˜ ¯
)ππ¯ ˘
;ππ˘ ˙

endServico
∫∫ 
.
∫∫ 
Add
∫∫ 
(
∫∫ 
new
∫∫ "
EnderecoServico
∫∫# 2
(
∫∫2 3

ServicoNFe
∫∫3 =
.
∫∫= >
NFeRetAutorizacao
∫∫> O
,
∫∫O P
VersaoServico
∫∫Q ^
.
∫∫^ _
ve310
∫∫_ d
,
∫∫d e
TipoAmbiente
∫∫f r
.
∫∫r s
taHomologacao∫∫s Ä
,∫∫Ä Å
emissao∫∫Ç â
,∫∫â ä
	EstadoNfe∫∫ã î
.∫∫î ï
AM∫∫ï ó
,∫∫ó ò
ModeloDocumento∫∫ô ®
.∫∫® ©
NFCe∫∫© ≠
,∫∫≠ Æ
$str∫∫Ø ˝
)∫∫˝ ˛
)∫∫˛ ˇ
;∫∫ˇ Ä

endServico
ªª 
.
ªª 
Add
ªª 
(
ªª 
new
ªª "
EnderecoServico
ªª# 2
(
ªª2 3

ServicoNFe
ªª3 =
.
ªª= >"
NfeConsultaProtocolo
ªª> R
,
ªªR S
VersaoServico
ªªT a
.
ªªa b
ve310
ªªb g
,
ªªg h
TipoAmbiente
ªªi u
.
ªªu v
taHomologacaoªªv É
,ªªÉ Ñ
emissaoªªÖ å
,ªªå ç
	EstadoNfeªªé ó
.ªªó ò
AMªªò ö
,ªªö õ
ModeloDocumentoªªú ´
.ªª´ ¨
NFCeªª¨ ∞
,ªª∞ ±
$strªª≤ ˚
)ªª˚ ¸
)ªª¸ ˝
;ªª˝ ˛

endServico
ºº 
.
ºº 
Add
ºº 
(
ºº 
new
ºº "
EnderecoServico
ºº# 2
(
ºº2 3

ServicoNFe
ºº3 =
.
ºº= >
NfeRecepcao
ºº> I
,
ººI J
VersaoServico
ººK X
.
ººX Y
ve310
ººY ^
,
ºº^ _
TipoAmbiente
ºº` l
.
ººl m
taHomologacao
ººm z
,
ººz {
emissaoºº| É
,ººÉ Ñ
	EstadoNfeººÖ é
.ººé è
AMººè ë
,ººë í
ModeloDocumentoººì ¢
.ºº¢ £
NFCeºº£ ß
,ººß ®
$strºº© Ú
)ººÚ Û
)ººÛ Ù
;ººÙ ı

endServico
ΩΩ 
.
ΩΩ 
Add
ΩΩ 
(
ΩΩ 
new
ΩΩ "
EnderecoServico
ΩΩ# 2
(
ΩΩ2 3

ServicoNFe
ΩΩ3 =
.
ΩΩ= >'
RecepcaoEventoCancelmento
ΩΩ> W
,
ΩΩW X
VersaoServico
ΩΩY f
.
ΩΩf g
ve100
ΩΩg l
,
ΩΩl m
TipoAmbiente
ΩΩn z
.
ΩΩz {
taHomologacaoΩΩ{ à
,ΩΩà â
emissaoΩΩä ë
,ΩΩë í
	EstadoNfeΩΩì ú
.ΩΩú ù
AMΩΩù ü
,ΩΩü †
ModeloDocumentoΩΩ° ∞
.ΩΩ∞ ±
NFCeΩΩ± µ
,ΩΩµ ∂
$strΩΩ∑ Ç
)ΩΩÇ É
)ΩΩÉ Ñ
;ΩΩÑ Ö

endServico
ææ 
.
ææ 
Add
ææ 
(
ææ 
new
ææ "
EnderecoServico
ææ# 2
(
ææ2 3

ServicoNFe
ææ3 =
.
ææ= >
NfeStatusServico
ææ> N
,
ææN O
VersaoServico
ææP ]
.
ææ] ^
ve310
ææ^ c
,
ææc d
TipoAmbiente
ææe q
.
ææq r
taHomologacao
æær 
,ææ Ä
emissaoææÅ à
,ææà â
	EstadoNfeææä ì
.ææì î
AMææî ñ
,ææñ ó
ModeloDocumentoææò ß
.ææß ®
NFCeææ® ¨
,ææ¨ ≠
$strææÆ ¸
)ææ¸ ˝
)ææ˝ ˛
;ææ˛ ˇ

endServico
øø 
.
øø 
Add
øø 
(
øø 
new
øø "
EnderecoServico
øø# 2
(
øø2 3

ServicoNFe
øø3 =
.
øø= >
NfeRetRecepcao
øø> L
,
øøL M
VersaoServico
øøN [
.
øø[ \
ve310
øø\ a
,
øøa b
TipoAmbiente
øøc o
.
øøo p
taHomologacao
øøp }
,
øø} ~
emissaoøø Ü
,øøÜ á
	EstadoNfeøøà ë
.øøë í
AMøøí î
,øøî ï
ModeloDocumentoøøñ •
.øø• ¶
NFCeøø¶ ™
,øø™ ´
$strøø¨ ¯
)øø¯ ˘
)øø˘ ˙
;øø˙ ˚

endServico
¿¿ 
.
¿¿ 
Add
¿¿ 
(
¿¿ 
new
¿¿ "
EnderecoServico
¿¿# 2
(
¿¿2 3

ServicoNFe
¿¿3 =
.
¿¿= >
NfeInutilizacao
¿¿> M
,
¿¿M N
VersaoServico
¿¿O \
.
¿¿\ ]
ve310
¿¿] b
,
¿¿b c
TipoAmbiente
¿¿d p
.
¿¿p q
taHomologacao
¿¿q ~
,
¿¿~ 
emissao¿¿Ä á
,¿¿á à
	EstadoNfe¿¿â í
.¿¿í ì
AM¿¿ì ï
,¿¿ï ñ
ModeloDocumento¿¿ó ¶
.¿¿¶ ß
NFCe¿¿ß ´
,¿¿´ ¨
$str¿¿≠ ˙
)¿¿˙ ˚
)¿¿˚ ¸
;¿¿¸ ˝
}
√√ 
foreach
…… 
(
…… 
var
…… 
emissao
……  
in
……! #
emissaoComum
……$ 0
)
……0 1
{
   
if
ÕÕ 
(
ÕÕ 
emissao
ÕÕ 
!=
ÕÕ 
TipoEmissao
ÕÕ *
.
ÕÕ* +
teEPEC
ÕÕ+ 1
)
ÕÕ1 2

endServico
ŒŒ 
.
ŒŒ 
AddRange
ŒŒ '
(
ŒŒ' (
eventoCceCanc
ŒŒ( 5
.
ŒŒ5 6
Select
ŒŒ6 <
(
ŒŒ< =

servicoNFe
ŒŒ= G
=>
ŒŒH J
new
ŒŒK N
EnderecoServico
ŒŒO ^
(
ŒŒ^ _

servicoNFe
ŒŒ_ i
,
ŒŒi j
VersaoServico
ŒŒk x
.
ŒŒx y
ve100
ŒŒy ~
,
ŒŒ~ 
TipoAmbienteŒŒÄ å
.ŒŒå ç

taProducaoŒŒç ó
,ŒŒó ò
emissaoŒŒô †
,ŒŒ† °
	EstadoNfeŒŒ¢ ´
.ŒŒ´ ¨
AMŒŒ¨ Æ
,ŒŒÆ Ø
ModeloDocumentoŒŒ∞ ø
.ŒŒø ¿
NFeŒŒ¿ √
,ŒŒ√ ƒ
$strŒŒ≈ Ñ
)ŒŒÑ Ö
)ŒŒÖ Ü
)ŒŒÜ á
;ŒŒá à

endServico
œœ 
.
œœ 
Add
œœ 
(
œœ 
new
œœ "
EnderecoServico
œœ# 2
(
œœ2 3

ServicoNFe
œœ3 =
.
œœ= >
NfeRecepcao
œœ> I
,
œœI J
VersaoServico
œœK X
.
œœX Y
ve200
œœY ^
,
œœ^ _
TipoAmbiente
œœ` l
.
œœl m

taProducao
œœm w
,
œœw x
emissaoœœy Ä
,œœÄ Å
	EstadoNfeœœÇ ã
.œœã å
AMœœå é
,œœé è
ModeloDocumentoœœê ü
.œœü †
NFeœœ† £
,œœ£ §
$strœœ• ‚
)œœ‚ „
)œœ„ ‰
;œœ‰ Â

endServico
–– 
.
–– 
Add
–– 
(
–– 
new
–– "
EnderecoServico
––# 2
(
––2 3

ServicoNFe
––3 =
.
––= >
NfeRetRecepcao
––> L
,
––L M
VersaoServico
––N [
.
––[ \
ve200
––\ a
,
––a b
TipoAmbiente
––c o
.
––o p

taProducao
––p z
,
––z {
emissao––| É
,––É Ñ
	EstadoNfe––Ö é
.––é è
AM––è ë
,––ë í
ModeloDocumento––ì ¢
.––¢ £
NFe––£ ¶
,––¶ ß
$str––® Ë
)––Ë È
)––È Í
;––Í Î

endServico
—— 
.
—— 
AddRange
—— #
(
——# $
versaoDoisETres
——$ 3
.
——3 4
Select
——4 :
(
——: ;
versao
——; A
=>
——B D
new
——E H
EnderecoServico
——I X
(
——X Y

ServicoNFe
——Y c
.
——c d
NfeInutilizacao
——d s
,
——s t
versao
——u {
,
——{ |
TipoAmbiente——} â
.——â ä

taProducao——ä î
,——î ï
emissao——ñ ù
,——ù û
	EstadoNfe——ü ®
.——® ©
AM——© ´
,——´ ¨
ModeloDocumento——≠ º
.——º Ω
NFe——Ω ¿
,——¿ ¡
$str——¬ É
)——É Ñ
)——Ñ Ö
)——Ö Ü
;——Ü á

endServico
““ 
.
““ 
AddRange
““ #
(
““# $
versaoDoisETres
““$ 3
.
““3 4
Select
““4 :
(
““: ;
versao
““; A
=>
““B D
new
““E H
EnderecoServico
““I X
(
““X Y

ServicoNFe
““Y c
.
““c d"
NfeConsultaProtocolo
““d x
,
““x y
versao““z Ä
,““Ä Å
TipoAmbiente““Ç é
.““é è

taProducao““è ô
,““ô ö
emissao““õ ¢
,““¢ £
	EstadoNfe““§ ≠
.““≠ Æ
AM““Æ ∞
,““∞ ±
ModeloDocumento““≤ ¡
.““¡ ¬
NFe““¬ ≈
,““≈ ∆
$str““« Ñ
)““Ñ Ö
)““Ö Ü
)““Ü á
;““á à

endServico
”” 
.
”” 
AddRange
”” #
(
””# $
versaoDoisETres
””$ 3
.
””3 4
Select
””4 :
(
””: ;
versao
””; A
=>
””B D
new
””E H
EnderecoServico
””I X
(
””X Y

ServicoNFe
””Y c
.
””c d
NfeStatusServico
””d t
,
””t u
versao
””v |
,
””| }
TipoAmbiente””~ ä
.””ä ã

taProducao””ã ï
,””ï ñ
emissao””ó û
,””û ü
	EstadoNfe””† ©
.””© ™
AM””™ ¨
,””¨ ≠
ModeloDocumento””Æ Ω
.””Ω æ
NFe””æ ¡
,””¡ ¬
$str””√ Ö
)””Ö Ü
)””Ü á
)””á à
;””à â

endServico
‘‘ 
.
‘‘ 
AddRange
‘‘ #
(
‘‘# $
versaoDoisETres
’’ #
.
’’# $
Select
’’$ *
(
’’* +
versao
’’+ 1
=>
’’2 4
new
’’5 8
EnderecoServico
’’9 H
(
’’H I

ServicoNFe
’’I S
.
’’S T!
NfeConsultaCadastro
’’T g
,
’’g h
versao
’’i o
,
’’o p
TipoAmbiente
’’q }
.
’’} ~

taProducao’’~ à
,’’à â
emissao’’ä ë
,’’ë í
	EstadoNfe’’ì ú
.’’ú ù
AM’’ù ü
,’’ü †
ModeloDocumento’’° ∞
.’’∞ ±
NFe’’± ¥
,’’¥ µ
$str’’∂ ˚
)’’˚ ¸
)’’¸ ˝
)’’˝ ˛
;’’˛ ˇ

endServico
◊◊ 
.
◊◊ 
Add
◊◊ 
(
◊◊ 
new
◊◊ "
EnderecoServico
◊◊# 2
(
◊◊2 3

ServicoNFe
◊◊3 =
.
◊◊= >
NFeAutorizacao
◊◊> L
,
◊◊L M
VersaoServico
◊◊N [
.
◊◊[ \
ve310
◊◊\ a
,
◊◊a b
TipoAmbiente
◊◊c o
.
◊◊o p

taProducao
◊◊p z
,
◊◊z {
emissao◊◊| É
,◊◊É Ñ
	EstadoNfe◊◊Ö é
.◊◊é è
AM◊◊è ë
,◊◊ë í
ModeloDocumento◊◊ì ¢
.◊◊¢ £
NFe◊◊£ ¶
,◊◊¶ ß
$str◊◊® Á
)◊◊Á Ë
)◊◊Ë È
;◊◊È Í

endServico
ÿÿ 
.
ÿÿ 
Add
ÿÿ 
(
ÿÿ 
new
ÿÿ "
EnderecoServico
ÿÿ# 2
(
ÿÿ2 3

ServicoNFe
ÿÿ3 =
.
ÿÿ= >
NFeRetAutorizacao
ÿÿ> O
,
ÿÿO P
VersaoServico
ÿÿQ ^
.
ÿÿ^ _
ve310
ÿÿ_ d
,
ÿÿd e
TipoAmbiente
ÿÿf r
.
ÿÿr s

taProducao
ÿÿs }
,
ÿÿ} ~
emissaoÿÿ Ü
,ÿÿÜ á
	EstadoNfeÿÿà ë
.ÿÿë í
AMÿÿí î
,ÿÿî ï
ModeloDocumentoÿÿñ •
.ÿÿ• ¶
NFeÿÿ¶ ©
,ÿÿ© ™
$strÿÿ´ Ì
)ÿÿÌ Ó
)ÿÿÓ Ô
;ÿÿÔ 

endServico
ﬁﬁ 
.
ﬁﬁ 
Add
ﬁﬁ 
(
ﬁﬁ 
new
ﬁﬁ "
EnderecoServico
ﬁﬁ# 2
(
ﬁﬁ2 3

ServicoNFe
ﬁﬁ3 =
.
ﬁﬁ= >
NFeAutorizacao
ﬁﬁ> L
,
ﬁﬁL M
VersaoServico
ﬁﬁN [
.
ﬁﬁ[ \
ve310
ﬁﬁ\ a
,
ﬁﬁa b
TipoAmbiente
ﬁﬁc o
.
ﬁﬁo p

taProducao
ﬁﬁp z
,
ﬁﬁz {
emissaoﬁﬁ| É
,ﬁﬁÉ Ñ
	EstadoNfeﬁﬁÖ é
.ﬁﬁé è
AMﬁﬁè ë
,ﬁﬁë í
ModeloDocumentoﬁﬁì ¢
.ﬁﬁ¢ £
NFCeﬁﬁ£ ß
,ﬁﬁß ®
$strﬁﬁ© Ì
)ﬁﬁÌ Ó
)ﬁﬁÓ Ô
;ﬁﬁÔ 

endServico
ﬂﬂ 
.
ﬂﬂ 
Add
ﬂﬂ 
(
ﬂﬂ 
new
ﬂﬂ "
EnderecoServico
ﬂﬂ# 2
(
ﬂﬂ2 3

ServicoNFe
ﬂﬂ3 =
.
ﬂﬂ= >
NFeRetAutorizacao
ﬂﬂ> O
,
ﬂﬂO P
VersaoServico
ﬂﬂQ ^
.
ﬂﬂ^ _
ve310
ﬂﬂ_ d
,
ﬂﬂd e
TipoAmbiente
ﬂﬂf r
.
ﬂﬂr s

taProducao
ﬂﬂs }
,
ﬂﬂ} ~
emissaoﬂﬂ Ü
,ﬂﬂÜ á
	EstadoNfeﬂﬂà ë
.ﬂﬂë í
AMﬂﬂí î
,ﬂﬂî ï
ModeloDocumentoﬂﬂñ •
.ﬂﬂ• ¶
NFCeﬂﬂ¶ ™
,ﬂﬂ™ ´
$strﬂﬂ¨ Û
)ﬂﬂÛ Ù
)ﬂﬂÙ ı
;ﬂﬂı ˆ

endServico
‡‡ 
.
‡‡ 
Add
‡‡ 
(
‡‡ 
new
‡‡ "
EnderecoServico
‡‡# 2
(
‡‡2 3

ServicoNFe
‡‡3 =
.
‡‡= >"
NfeConsultaProtocolo
‡‡> R
,
‡‡R S
VersaoServico
‡‡T a
.
‡‡a b
ve310
‡‡b g
,
‡‡g h
TipoAmbiente
‡‡i u
.
‡‡u v

taProducao‡‡v Ä
,‡‡Ä Å
emissao‡‡Ç â
,‡‡â ä
	EstadoNfe‡‡ã î
.‡‡î ï
AM‡‡ï ó
,‡‡ó ò
ModeloDocumento‡‡ô ®
.‡‡® ©
NFCe‡‡© ≠
,‡‡≠ Æ
$str‡‡Ø Ò
)‡‡Ò Ú
)‡‡Ú Û
;‡‡Û Ù

endServico
·· 
.
·· 
Add
·· 
(
·· 
new
·· "
EnderecoServico
··# 2
(
··2 3

ServicoNFe
··3 =
.
··= >
NfeRecepcao
··> I
,
··I J
VersaoServico
··K X
.
··X Y
ve310
··Y ^
,
··^ _
TipoAmbiente
··` l
.
··l m

taProducao
··m w
,
··w x
emissao··y Ä
,··Ä Å
	EstadoNfe··Ç ã
.··ã å
AM··å é
,··é è
ModeloDocumento··ê ü
.··ü †
NFCe··† §
,··§ •
$str··¶ Ë
)··Ë È
)··È Í
;··Í Î

endServico
‚‚ 
.
‚‚ 
Add
‚‚ 
(
‚‚ 
new
‚‚ "
EnderecoServico
‚‚# 2
(
‚‚2 3

ServicoNFe
‚‚3 =
.
‚‚= >'
RecepcaoEventoCancelmento
‚‚> W
,
‚‚W X
VersaoServico
‚‚Y f
.
‚‚f g
ve100
‚‚g l
,
‚‚l m
TipoAmbiente
‚‚n z
.
‚‚z {

taProducao‚‚{ Ö
,‚‚Ö Ü
emissao‚‚á é
,‚‚é è
	EstadoNfe‚‚ê ô
.‚‚ô ö
AM‚‚ö ú
,‚‚ú ù
ModeloDocumento‚‚û ≠
.‚‚≠ Æ
NFCe‚‚Æ ≤
,‚‚≤ ≥
$str‚‚¥ ¯
)‚‚¯ ˘
)‚‚˘ ˙
;‚‚˙ ˚

endServico
„„ 
.
„„ 
Add
„„ 
(
„„ 
new
„„ "
EnderecoServico
„„# 2
(
„„2 3

ServicoNFe
„„3 =
.
„„= >
NfeStatusServico
„„> N
,
„„N O
VersaoServico
„„P ]
.
„„] ^
ve310
„„^ c
,
„„c d
TipoAmbiente
„„e q
.
„„q r

taProducao
„„r |
,
„„| }
emissao„„~ Ö
,„„Ö Ü
	EstadoNfe„„á ê
.„„ê ë
AM„„ë ì
,„„ì î
ModeloDocumento„„ï §
.„„§ •
NFCe„„• ©
,„„© ™
$str„„´ Ú
)„„Ú Û
)„„Û Ù
;„„Ù ı

endServico
‰‰ 
.
‰‰ 
Add
‰‰ 
(
‰‰ 
new
‰‰ "
EnderecoServico
‰‰# 2
(
‰‰2 3

ServicoNFe
‰‰3 =
.
‰‰= >
NfeRetRecepcao
‰‰> L
,
‰‰L M
VersaoServico
‰‰N [
.
‰‰[ \
ve310
‰‰\ a
,
‰‰a b
TipoAmbiente
‰‰c o
.
‰‰o p

taProducao
‰‰p z
,
‰‰z {
emissao‰‰| É
,‰‰É Ñ
	EstadoNfe‰‰Ö é
.‰‰é è
AM‰‰è ë
,‰‰ë í
ModeloDocumento‰‰ì ¢
.‰‰¢ £
NFCe‰‰£ ß
,‰‰ß ®
$str‰‰© Ó
)‰‰Ó Ô
)‰‰Ô 
;‰‰ Ò

endServico
ÂÂ 
.
ÂÂ 
Add
ÂÂ 
(
ÂÂ 
new
ÂÂ "
EnderecoServico
ÂÂ# 2
(
ÂÂ2 3

ServicoNFe
ÂÂ3 =
.
ÂÂ= >
NfeInutilizacao
ÂÂ> M
,
ÂÂM N
VersaoServico
ÂÂO \
.
ÂÂ\ ]
ve310
ÂÂ] b
,
ÂÂb c
TipoAmbiente
ÂÂd p
.
ÂÂp q

taProducao
ÂÂq {
,
ÂÂ{ |
emissaoÂÂ} Ñ
,ÂÂÑ Ö
	EstadoNfeÂÂÜ è
.ÂÂè ê
AMÂÂê í
,ÂÂí ì
ModeloDocumentoÂÂî £
.ÂÂ£ §
NFCeÂÂ§ ®
,ÂÂ® ©
$strÂÂ™ 
)ÂÂ Ò
)ÂÂÒ Ú
;ÂÂÚ Û
}
ËË 
foreach
ÙÙ 
(
ÙÙ 
var
ÙÙ 
emissao
ÙÙ  
in
ÙÙ! #
emissaoComum
ÙÙ$ 0
)
ÙÙ0 1
{
ıı 

endServico
¯¯ 
.
¯¯ 
Add
¯¯ 
(
¯¯ 
new
¯¯ "
EnderecoServico
¯¯# 2
(
¯¯2 3

ServicoNFe
¯¯3 =
.
¯¯= >
NfeRecepcao
¯¯> I
,
¯¯I J
VersaoServico
¯¯K X
.
¯¯X Y
ve200
¯¯Y ^
,
¯¯^ _
TipoAmbiente
¯¯` l
.
¯¯l m
taHomologacao
¯¯m z
,
¯¯z {
emissao¯¯| É
,¯¯É Ñ
	EstadoNfe¯¯Ö é
.¯¯é è
BA¯¯è ë
,¯¯ë í
ModeloDocumento¯¯ì ¢
.¯¯¢ £
NFe¯¯£ ¶
,¯¯¶ ß
$str¯¯® Í
)¯¯Í Î
)¯¯Î Ï
;¯¯Ï Ì

endServico
˘˘ 
.
˘˘ 
Add
˘˘ 
(
˘˘ 
new
˘˘ "
EnderecoServico
˘˘# 2
(
˘˘2 3

ServicoNFe
˘˘3 =
.
˘˘= >
NfeRetRecepcao
˘˘> L
,
˘˘L M
VersaoServico
˘˘N [
.
˘˘[ \
ve200
˘˘\ a
,
˘˘a b
TipoAmbiente
˘˘c o
.
˘˘o p
taHomologacao
˘˘p }
,
˘˘} ~
emissao˘˘ Ü
,˘˘Ü á
	EstadoNfe˘˘à ë
.˘˘ë í
BA˘˘í î
,˘˘î ï
ModeloDocumento˘˘ñ •
.˘˘• ¶
NFe˘˘¶ ©
,˘˘© ™
$str˘˘´ 
)˘˘ Ò
)˘˘Ò Ú
;˘˘Ú Û

endServico
˙˙ 
.
˙˙ 
Add
˙˙ 
(
˙˙ 
new
˙˙ "
EnderecoServico
˙˙# 2
(
˙˙2 3

ServicoNFe
˙˙3 =
.
˙˙= >
NfeInutilizacao
˙˙> M
,
˙˙M N
VersaoServico
˙˙O \
.
˙˙\ ]
ve200
˙˙] b
,
˙˙b c
TipoAmbiente
˙˙d p
.
˙˙p q
taHomologacao
˙˙q ~
,
˙˙~ 
emissao˙˙Ä á
,˙˙á à
	EstadoNfe˙˙â í
.˙˙í ì
BA˙˙ì ï
,˙˙ï ñ
ModeloDocumento˙˙ó ¶
.˙˙¶ ß
NFe˙˙ß ™
,˙˙™ ´
$str˙˙¨ Ú
)˙˙Ú Û
)˙˙Û Ù
;˙˙Ù ı

endServico
˚˚ 
.
˚˚ 
Add
˚˚ 
(
˚˚ 
new
˚˚ "
EnderecoServico
˚˚# 2
(
˚˚2 3

ServicoNFe
˚˚3 =
.
˚˚= >"
NfeConsultaProtocolo
˚˚> R
,
˚˚R S
VersaoServico
˚˚T a
.
˚˚a b
ve200
˚˚b g
,
˚˚g h
TipoAmbiente
˚˚i u
.
˚˚u v
taHomologacao˚˚v É
,˚˚É Ñ
emissao˚˚Ö å
,˚˚å ç
	EstadoNfe˚˚é ó
.˚˚ó ò
BA˚˚ò ö
,˚˚ö õ
ModeloDocumento˚˚ú ´
.˚˚´ ¨
NFe˚˚¨ Ø
,˚˚Ø ∞
$str˚˚± Û
)˚˚Û Ù
)˚˚Ù ı
;˚˚ı ˆ

endServico
¸¸ 
.
¸¸ 
Add
¸¸ 
(
¸¸ 
new
¸¸ "
EnderecoServico
¸¸# 2
(
¸¸2 3

ServicoNFe
¸¸3 =
.
¸¸= >
NfeStatusServico
¸¸> N
,
¸¸N O
VersaoServico
¸¸P ]
.
¸¸] ^
ve200
¸¸^ c
,
¸¸c d
TipoAmbiente
¸¸e q
.
¸¸q r
taHomologacao
¸¸r 
,¸¸ Ä
emissao¸¸Å à
,¸¸à â
	EstadoNfe¸¸ä ì
.¸¸ì î
BA¸¸î ñ
,¸¸ñ ó
ModeloDocumento¸¸ò ß
.¸¸ß ®
NFe¸¸® ´
,¸¸´ ¨
$str¸¸≠ Ù
)¸¸Ù ı
)¸¸ı ˆ
;¸¸ˆ ˜

endServico
˝˝ 
.
˝˝ 
AddRange
˝˝ #
(
˝˝# $
versaoDoisETres
˛˛ #
.
˛˛# $
Select
˛˛$ *
(
˛˛* +
versao
˛˛+ 1
=>
˛˛2 4
new
˛˛5 8
EnderecoServico
˛˛9 H
(
˛˛H I

ServicoNFe
˛˛I S
.
˛˛S T!
NfeConsultaCadastro
˛˛T g
,
˛˛g h
versao
˛˛i o
,
˛˛o p
TipoAmbiente
˛˛q }
.
˛˛} ~
taHomologacao˛˛~ ã
,˛˛ã å
emissao˛˛ç î
,˛˛î ï
	EstadoNfe˛˛ñ ü
.˛˛ü †
BA˛˛† ¢
,˛˛¢ £
ModeloDocumento˛˛§ ≥
.˛˛≥ ¥
NFe˛˛¥ ∑
,˛˛∑ ∏
$str˛˛π É
)˛˛É Ñ
)˛˛Ñ Ö
)˛˛Ö Ü
;˛˛Ü á
if
ˇˇ 
(
ˇˇ 
emissao
ˇˇ 
!=
ˇˇ 
TipoEmissao
ˇˇ *
.
ˇˇ* +
teEPEC
ˇˇ+ 1
)
ˇˇ1 2
foreach
ÄÄ 
(
ÄÄ 
var
ÄÄ  

servicoNFe
ÄÄ! +
in
ÄÄ, .
eventoCceCanc
ÄÄ/ <
)
ÄÄ< =

endServico
ÅÅ "
.
ÅÅ" #
AddRange
ÅÅ# +
(
ÅÅ+ ,
versaoDoisETres
ÇÇ +
.
ÇÇ+ ,
Select
ÇÇ, 2
(
ÇÇ2 3
versao
ÇÇ3 9
=>
ÇÇ: <
new
ÇÇ= @
EnderecoServico
ÇÇA P
(
ÇÇP Q

servicoNFe
ÇÇQ [
,
ÇÇ[ \
versao
ÇÇ] c
,
ÇÇc d
TipoAmbiente
ÇÇe q
.
ÇÇq r
taHomologacao
ÇÇr 
,ÇÇ Ä
emissaoÇÇÅ à
,ÇÇà â
	EstadoNfeÇÇä ì
.ÇÇì î
BAÇÇî ñ
,ÇÇñ ó
ModeloDocumentoÇÇò ß
.ÇÇß ®
NFeÇÇ® ´
,ÇÇ´ ¨
$strÇÇ≠ Ô
)ÇÇÔ 
)ÇÇ Ò
)ÇÇÒ Ú
;ÇÇÚ Û

endServico
ÉÉ 
.
ÉÉ 
Add
ÉÉ 
(
ÉÉ 
new
ÉÉ "
EnderecoServico
ÉÉ# 2
(
ÉÉ2 3

ServicoNFe
ÉÉ3 =
.
ÉÉ= >
NfeInutilizacao
ÉÉ> M
,
ÉÉM N
VersaoServico
ÉÉO \
.
ÉÉ\ ]
ve310
ÉÉ] b
,
ÉÉb c
TipoAmbiente
ÉÉd p
.
ÉÉp q
taHomologacao
ÉÉq ~
,
ÉÉ~ 
emissaoÉÉÄ á
,ÉÉá à
	EstadoNfeÉÉâ í
.ÉÉí ì
BAÉÉì ï
,ÉÉï ñ
ModeloDocumentoÉÉó ¶
.ÉÉ¶ ß
NFeÉÉß ™
,ÉÉ™ ´
$strÉÉ¨ ˚
)ÉÉ˚ ¸
)ÉÉ¸ ˝
;ÉÉ˝ ˛

endServico
ÑÑ 
.
ÑÑ 
Add
ÑÑ 
(
ÑÑ 
new
ÑÑ "
EnderecoServico
ÑÑ# 2
(
ÑÑ2 3

ServicoNFe
ÑÑ3 =
.
ÑÑ= >"
NfeConsultaProtocolo
ÑÑ> R
,
ÑÑR S
VersaoServico
ÑÑT a
.
ÑÑa b
ve310
ÑÑb g
,
ÑÑg h
TipoAmbiente
ÑÑi u
.
ÑÑu v
taHomologacaoÑÑv É
,ÑÑÉ Ñ
emissaoÑÑÖ å
,ÑÑå ç
	EstadoNfeÑÑé ó
.ÑÑó ò
BAÑÑò ö
,ÑÑö õ
ModeloDocumentoÑÑú ´
.ÑÑ´ ¨
NFeÑÑ¨ Ø
,ÑÑØ ∞
$strÑÑ± ¯
)ÑÑ¯ ˘
)ÑÑ˘ ˙
;ÑÑ˙ ˚

endServico
ÖÖ 
.
ÖÖ 
Add
ÖÖ 
(
ÖÖ 
new
ÖÖ "
EnderecoServico
ÖÖ# 2
(
ÖÖ2 3

ServicoNFe
ÖÖ3 =
.
ÖÖ= >
NfeStatusServico
ÖÖ> N
,
ÖÖN O
VersaoServico
ÖÖP ]
.
ÖÖ] ^
ve310
ÖÖ^ c
,
ÖÖc d
TipoAmbiente
ÖÖe q
.
ÖÖq r
taHomologacao
ÖÖr 
,ÖÖ Ä
emissaoÖÖÅ à
,ÖÖà â
	EstadoNfeÖÖä ì
.ÖÖì î
BAÖÖî ñ
,ÖÖñ ó
ModeloDocumentoÖÖò ß
.ÖÖß ®
NFeÖÖ® ´
,ÖÖ´ ¨
$strÖÖ≠ ˛
)ÖÖ˛ ˇ
)ÖÖˇ Ä
;ÖÖÄ Å

endServico
ÜÜ 
.
ÜÜ 
Add
ÜÜ 
(
ÜÜ 
new
ÜÜ "
EnderecoServico
ÜÜ# 2
(
ÜÜ2 3

ServicoNFe
ÜÜ3 =
.
ÜÜ= >
NFeAutorizacao
ÜÜ> L
,
ÜÜL M
VersaoServico
ÜÜN [
.
ÜÜ[ \
ve310
ÜÜ\ a
,
ÜÜa b
TipoAmbiente
ÜÜc o
.
ÜÜo p
taHomologacao
ÜÜp }
,
ÜÜ} ~
emissaoÜÜ Ü
,ÜÜÜ á
	EstadoNfeÜÜà ë
.ÜÜë í
BAÜÜí î
,ÜÜî ï
ModeloDocumentoÜÜñ •
.ÜÜ• ¶
NFeÜÜ¶ ©
,ÜÜ© ™
$strÜÜ´ ¯
)ÜÜ¯ ˘
)ÜÜ˘ ˙
;ÜÜ˙ ˚

endServico
áá 
.
áá 
Add
áá 
(
áá 
new
áá "
EnderecoServico
áá# 2
(
áá2 3

ServicoNFe
áá3 =
.
áá= >
NFeRetAutorizacao
áá> O
,
ááO P
VersaoServico
ááQ ^
.
áá^ _
ve310
áá_ d
,
áád e
TipoAmbiente
ááf r
.
áár s
taHomologacaoáás Ä
,ááÄ Å
emissaoááÇ â
,ááâ ä
	EstadoNfeááã î
.ááî ï
BAááï ó
,ááó ò
ModeloDocumentoááô ®
.áá® ©
NFeáá© ¨
,áá¨ ≠
$strááÆ Å
)ááÅ Ç
)ááÇ É
;ááÉ Ñ
}
ää 
foreach
êê 
(
êê 
var
êê 
emissao
êê  
in
êê! #
emissaoComum
êê$ 0
)
êê0 1
{
ëë 

endServico
îî 
.
îî 
Add
îî 
(
îî 
new
îî "
EnderecoServico
îî# 2
(
îî2 3

ServicoNFe
îî3 =
.
îî= >
NfeRecepcao
îî> I
,
îîI J
VersaoServico
îîK X
.
îîX Y
ve200
îîY ^
,
îî^ _
TipoAmbiente
îî` l
.
îîl m

taProducao
îîm w
,
îîw x
emissaoîîy Ä
,îîÄ Å
	EstadoNfeîîÇ ã
.îîã å
BAîîå é
,îîé è
ModeloDocumentoîîê ü
.îîü †
NFeîî† £
,îî£ §
$strîî• Ê
)îîÊ Á
)îîÁ Ë
;îîË È

endServico
ïï 
.
ïï 
Add
ïï 
(
ïï 
new
ïï "
EnderecoServico
ïï# 2
(
ïï2 3

ServicoNFe
ïï3 =
.
ïï= >
NfeRetRecepcao
ïï> L
,
ïïL M
VersaoServico
ïïN [
.
ïï[ \
ve200
ïï\ a
,
ïïa b
TipoAmbiente
ïïc o
.
ïïo p

taProducao
ïïp z
,
ïïz {
emissaoïï| É
,ïïÉ Ñ
	EstadoNfeïïÖ é
.ïïé è
BAïïè ë
,ïïë í
ModeloDocumentoïïì ¢
.ïï¢ £
NFeïï£ ¶
,ïï¶ ß
$strïï® Ï
)ïïÏ Ì
)ïïÌ Ó
;ïïÓ Ô

endServico
ññ 
.
ññ 
Add
ññ 
(
ññ 
new
ññ "
EnderecoServico
ññ# 2
(
ññ2 3

ServicoNFe
ññ3 =
.
ññ= >
NfeInutilizacao
ññ> M
,
ññM N
VersaoServico
ññO \
.
ññ\ ]
ve200
ññ] b
,
ññb c
TipoAmbiente
ññd p
.
ññp q

taProducao
ññq {
,
ññ{ |
emissaoññ} Ñ
,ññÑ Ö
	EstadoNfeññÜ è
.ññè ê
BAññê í
,ññí ì
ModeloDocumentoññî £
.ññ£ §
NFeññ§ ß
,ññß ®
$strññ© Ó
)ññÓ Ô
)ññÔ 
;ññ Ò

endServico
óó 
.
óó 
Add
óó 
(
óó 
new
óó "
EnderecoServico
óó# 2
(
óó2 3

ServicoNFe
óó3 =
.
óó= >"
NfeConsultaProtocolo
óó> R
,
óóR S
VersaoServico
óóT a
.
óóa b
ve200
óób g
,
óóg h
TipoAmbiente
óói u
.
óóu v

taProducaoóóv Ä
,óóÄ Å
emissaoóóÇ â
,óóâ ä
	EstadoNfeóóã î
.óóî ï
BAóóï ó
,óóó ò
ModeloDocumentoóóô ®
.óó® ©
NFeóó© ¨
,óó¨ ≠
$stróóÆ Ô
)óóÔ 
)óó Ò
;óóÒ Ú

endServico
òò 
.
òò 
Add
òò 
(
òò 
new
òò "
EnderecoServico
òò# 2
(
òò2 3

ServicoNFe
òò3 =
.
òò= >
NfeStatusServico
òò> N
,
òòN O
VersaoServico
òòP ]
.
òò] ^
ve200
òò^ c
,
òòc d
TipoAmbiente
òòe q
.
òòq r

taProducao
òòr |
,
òò| }
emissaoòò~ Ö
,òòÖ Ü
	EstadoNfeòòá ê
.òòê ë
BAòòë ì
,òòì î
ModeloDocumentoòòï §
.òò§ •
NFeòò• ®
,òò® ©
$stròò™ 
)òò Ò
)òòÒ Ú
;òòÚ Û

endServico
ôô 
.
ôô 
AddRange
ôô #
(
ôô# $
versaoDoisETres
öö #
.
öö# $
Select
öö$ *
(
öö* +
versao
öö+ 1
=>
öö2 4
new
öö5 8
EnderecoServico
öö9 H
(
ööH I

ServicoNFe
ööI S
.
ööS T!
NfeConsultaCadastro
ööT g
,
öög h
versao
ööi o
,
ööo p
TipoAmbiente
ööq }
.
öö} ~

taProducaoöö~ à
,ööà â
emissaoööä ë
,ööë í
	EstadoNfeööì ú
.ööú ù
BAööù ü
,ööü †
ModeloDocumentoöö° ∞
.öö∞ ±
NFeöö± ¥
,öö¥ µ
$ströö∂ ˇ
)ööˇ Ä
)ööÄ Å
)ööÅ Ç
;ööÇ É
if
õõ 
(
õõ 
emissao
õõ 
!=
õõ 
TipoEmissao
õõ *
.
õõ* +
teEPEC
õõ+ 1
)
õõ1 2
foreach
úú 
(
úú 
var
úú  

servicoNFe
úú! +
in
úú, .
eventoCceCanc
úú/ <
)
úú< =

endServico
ùù "
.
ùù" #
AddRange
ùù# +
(
ùù+ ,
versaoDoisETres
ùù, ;
.
ùù; <
Select
ùù< B
(
ùùB C
versao
ùùC I
=>
ùùJ L
new
ùùM P
EnderecoServico
ùùQ `
(
ùù` a

servicoNFe
ùùa k
,
ùùk l
versao
ùùm s
,
ùùs t
TipoAmbienteùùu Å
.ùùÅ Ç

taProducaoùùÇ å
,ùùå ç
emissaoùùé ï
,ùùï ñ
	EstadoNfeùùó †
.ùù† °
BAùù° £
,ùù£ §
ModeloDocumentoùù• ¥
.ùù¥ µ
NFeùùµ ∏
,ùù∏ π
$strùù∫ ˚
)ùù˚ ¸
)ùù¸ ˝
)ùù˝ ˛
;ùù˛ ˇ

endServico
ûû 
.
ûû 
Add
ûû 
(
ûû 
new
ûû "
EnderecoServico
ûû# 2
(
ûû2 3

ServicoNFe
ûû3 =
.
ûû= >
NfeInutilizacao
ûû> M
,
ûûM N
VersaoServico
ûûO \
.
ûû\ ]
ve310
ûû] b
,
ûûb c
TipoAmbiente
ûûd p
.
ûûp q

taProducao
ûûq {
,
ûû{ |
emissaoûû} Ñ
,ûûÑ Ö
	EstadoNfeûûÜ è
.ûûè ê
BAûûê í
,ûûí ì
ModeloDocumentoûûî £
.ûû£ §
NFeûû§ ß
,ûûß ®
$strûû© ˜
)ûû˜ ¯
)ûû¯ ˘
;ûû˘ ˙

endServico
üü 
.
üü 
Add
üü 
(
üü 
new
üü "
EnderecoServico
üü# 2
(
üü2 3

ServicoNFe
üü3 =
.
üü= >"
NfeConsultaProtocolo
üü> R
,
üüR S
VersaoServico
üüT a
.
üüa b
ve310
üüb g
,
üüg h
TipoAmbiente
üüi u
.
üüu v

taProducaoüüv Ä
,üüÄ Å
emissaoüüÇ â
,üüâ ä
	EstadoNfeüüã î
.üüî ï
BAüüï ó
,üüó ò
ModeloDocumentoüüô ®
.üü® ©
NFeüü© ¨
,üü¨ ≠
$strüüÆ Ù
)üüÙ ı
)üüı ˆ
;üüˆ ˜

endServico
†† 
.
†† 
Add
†† 
(
†† 
new
†† "
EnderecoServico
††# 2
(
††2 3

ServicoNFe
††3 =
.
††= >
NfeStatusServico
††> N
,
††N O
VersaoServico
††P ]
.
††] ^
ve310
††^ c
,
††c d
TipoAmbiente
††e q
.
††q r

taProducao
††r |
,
††| }
emissao††~ Ö
,††Ö Ü
	EstadoNfe††á ê
.††ê ë
BA††ë ì
,††ì î
ModeloDocumento††ï §
.††§ •
NFe††• ®
,††® ©
$str††™ ˙
)††˙ ˚
)††˚ ¸
;††¸ ˝

endServico
°° 
.
°° 
Add
°° 
(
°° 
new
°° "
EnderecoServico
°°# 2
(
°°2 3

ServicoNFe
°°3 =
.
°°= >
NFeAutorizacao
°°> L
,
°°L M
VersaoServico
°°N [
.
°°[ \
ve310
°°\ a
,
°°a b
TipoAmbiente
°°c o
.
°°o p

taProducao
°°p z
,
°°z {
emissao°°| É
,°°É Ñ
	EstadoNfe°°Ö é
.°°é è
BA°°è ë
,°°ë í
ModeloDocumento°°ì ¢
.°°¢ £
NFe°°£ ¶
,°°¶ ß
$str°°® Ù
)°°Ù ı
)°°ı ˆ
;°°ˆ ˜

endServico
¢¢ 
.
¢¢ 
Add
¢¢ 
(
¢¢ 
new
¢¢ "
EnderecoServico
¢¢# 2
(
¢¢2 3

ServicoNFe
¢¢3 =
.
¢¢= >
NFeRetAutorizacao
¢¢> O
,
¢¢O P
VersaoServico
¢¢Q ^
.
¢¢^ _
ve310
¢¢_ d
,
¢¢d e
TipoAmbiente
¢¢f r
.
¢¢r s

taProducao
¢¢s }
,
¢¢} ~
emissao¢¢ Ü
,¢¢Ü á
	EstadoNfe¢¢à ë
.¢¢ë í
BA¢¢í î
,¢¢î ï
ModeloDocumento¢¢ñ •
.¢¢• ¶
NFe¢¢¶ ©
,¢¢© ™
$str¢¢´ ˝
)¢¢˝ ˛
)¢¢˛ ˇ
;¢¢ˇ Ä
}
•• 
foreach
±± 
(
±± 
var
±± 
emissao
±±  
in
±±! #
emissaoComum
±±$ 0
)
±±0 1
{
≤≤ 
if
≥≥ 
(
≥≥ 
emissao
≥≥ 
!=
≥≥ 
TipoEmissao
≥≥ *
.
≥≥* +
teEPEC
≥≥+ 1
)
≥≥1 2

endServico
¥¥ 
.
¥¥ 
AddRange
¥¥ '
(
¥¥' (
eventoCceCanc
¥¥( 5
.
¥¥5 6
Select
¥¥6 <
(
¥¥< =

servicoNFe
¥¥= G
=>
¥¥H J
new
¥¥K N
EnderecoServico
¥¥O ^
(
¥¥^ _

servicoNFe
¥¥_ i
,
¥¥i j
VersaoServico
¥¥k x
.
¥¥x y
ve100
¥¥y ~
,
¥¥~ 
TipoAmbiente¥¥Ä å
.¥¥å ç
taHomologacao¥¥ç ö
,¥¥ö õ
emissao¥¥ú £
,¥¥£ §
	EstadoNfe¥¥• Æ
.¥¥Æ Ø
CE¥¥Ø ±
,¥¥± ≤
ModeloDocumento¥¥≥ ¬
.¥¥¬ √
NFe¥¥√ ∆
,¥¥∆ «
$str¥¥» à
)¥¥à â
)¥¥â ä
)¥¥ä ã
;¥¥ã å

endServico
µµ 
.
µµ 
Add
µµ 
(
µµ 
new
µµ "
EnderecoServico
µµ# 2
(
µµ2 3

ServicoNFe
µµ3 =
.
µµ= >
NfeRecepcao
µµ> I
,
µµI J
VersaoServico
µµK X
.
µµX Y
ve200
µµY ^
,
µµ^ _
TipoAmbiente
µµ` l
.
µµl m
taHomologacao
µµm z
,
µµz {
emissaoµµ| É
,µµÉ Ñ
	EstadoNfeµµÖ é
.µµé è
CEµµè ë
,µµë í
ModeloDocumentoµµì ¢
.µµ¢ £
NFeµµ£ ¶
,µµ¶ ß
$strµµ® Ê
)µµÊ Á
)µµÁ Ë
;µµË È

endServico
∂∂ 
.
∂∂ 
Add
∂∂ 
(
∂∂ 
new
∂∂ "
EnderecoServico
∂∂# 2
(
∂∂2 3

ServicoNFe
∂∂3 =
.
∂∂= >
NfeRetRecepcao
∂∂> L
,
∂∂L M
VersaoServico
∂∂N [
.
∂∂[ \
ve200
∂∂\ a
,
∂∂a b
TipoAmbiente
∂∂c o
.
∂∂o p
taHomologacao
∂∂p }
,
∂∂} ~
emissao∂∂ Ü
,∂∂Ü á
	EstadoNfe∂∂à ë
.∂∂ë í
CE∂∂í î
,∂∂î ï
ModeloDocumento∂∂ñ •
.∂∂• ¶
NFe∂∂¶ ©
,∂∂© ™
$str∂∂´ Ï
)∂∂Ï Ì
)∂∂Ì Ó
;∂∂Ó Ô

endServico
∑∑ 
.
∑∑ 
AddRange
∑∑ #
(
∑∑# $
versaoDoisETres
∑∑$ 3
.
∑∑3 4
Select
∑∑4 :
(
∑∑: ;
versao
∑∑; A
=>
∑∑B D
new
∑∑E H
EnderecoServico
∑∑I X
(
∑∑X Y

ServicoNFe
∑∑Y c
.
∑∑c d
NfeInutilizacao
∑∑d s
,
∑∑s t
versao
∑∑u {
,
∑∑{ |
TipoAmbiente∑∑} â
.∑∑â ä
taHomologacao∑∑ä ó
,∑∑ó ò
emissao∑∑ô †
,∑∑† °
	EstadoNfe∑∑¢ ´
.∑∑´ ¨
CE∑∑¨ Æ
,∑∑Æ Ø
ModeloDocumento∑∑∞ ø
.∑∑ø ¿
NFe∑∑¿ √
,∑∑√ ƒ
$str∑∑≈ á
)∑∑á à
)∑∑à â
)∑∑â ä
;∑∑ä ã

endServico
∏∏ 
.
∏∏ 
AddRange
∏∏ #
(
∏∏# $
versaoDoisETres
∏∏$ 3
.
∏∏3 4
Select
∏∏4 :
(
∏∏: ;
versao
∏∏; A
=>
∏∏B D
new
∏∏E H
EnderecoServico
∏∏I X
(
∏∏X Y

ServicoNFe
∏∏Y c
.
∏∏c d"
NfeConsultaProtocolo
∏∏d x
,
∏∏x y
versao∏∏z Ä
,∏∏Ä Å
TipoAmbiente∏∏Ç é
.∏∏é è
taHomologacao∏∏è ú
,∏∏ú ù
emissao∏∏û •
,∏∏• ¶
	EstadoNfe∏∏ß ∞
.∏∏∞ ±
CE∏∏± ≥
,∏∏≥ ¥
ModeloDocumento∏∏µ ƒ
.∏∏ƒ ≈
NFe∏∏≈ »
,∏∏» …
$str∏∏  à
)∏∏à â
)∏∏â ä
)∏∏ä ã
;∏∏ã å

endServico
ππ 
.
ππ 
AddRange
ππ #
(
ππ# $
versaoDoisETres
ππ$ 3
.
ππ3 4
Select
ππ4 :
(
ππ: ;
versao
ππ; A
=>
ππB D
new
ππE H
EnderecoServico
ππI X
(
ππX Y

ServicoNFe
ππY c
.
ππc d
NfeStatusServico
ππd t
,
ππt u
versao
ππv |
,
ππ| }
TipoAmbienteππ~ ä
.ππä ã
taHomologacaoππã ò
,ππò ô
emissaoππö °
,ππ° ¢
	EstadoNfeππ£ ¨
.ππ¨ ≠
CEππ≠ Ø
,ππØ ∞
ModeloDocumentoππ± ¿
.ππ¿ ¡
NFeππ¡ ƒ
,ππƒ ≈
$strππ∆ â
)ππâ ä
)ππä ã
)ππã å
;ππå ç

endServico
∫∫ 
.
∫∫ 
AddRange
∫∫ #
(
∫∫# $
versaoDoisETres
∫∫$ 3
.
∫∫3 4
Select
∫∫4 :
(
∫∫: ;
versao
∫∫; A
=>
∫∫B D
new
∫∫E H
EnderecoServico
∫∫I X
(
∫∫X Y

ServicoNFe
∫∫Y c
.
∫∫c d!
NfeConsultaCadastro
∫∫d w
,
∫∫w x
versao
∫∫y 
,∫∫ Ä
TipoAmbiente∫∫Å ç
.∫∫ç é
taHomologacao∫∫é õ
,∫∫õ ú
emissao∫∫ù §
,∫∫§ •
	EstadoNfe∫∫¶ Ø
.∫∫Ø ∞
CE∫∫∞ ≤
,∫∫≤ ≥
ModeloDocumento∫∫¥ √
.∫∫√ ƒ
NFe∫∫ƒ «
,∫∫« »
$str∫∫… è
)∫∫è ê
)∫∫ê ë
)∫∫ë í
;∫∫í ì

endServico
ªª 
.
ªª 
AddRange
ªª #
(
ªª# $
versaoDoisETres
ªª$ 3
.
ªª3 4
Select
ªª4 :
(
ªª: ;
versao
ªª; A
=>
ªªB D
new
ªªE H
EnderecoServico
ªªI X
(
ªªX Y

ServicoNFe
ªªY c
.
ªªc d
NfeDownloadNF
ªªd q
,
ªªq r
versao
ªªs y
,
ªªy z
TipoAmbienteªª{ á
.ªªá à
taHomologacaoªªà ï
,ªªï ñ
emissaoªªó û
,ªªû ü
	EstadoNfeªª† ©
.ªª© ™
CEªª™ ¨
,ªª¨ ≠
ModeloDocumentoªªÆ Ω
.ªªΩ æ
NFeªªæ ¡
,ªª¡ ¬
$strªª√ Ç
)ªªÇ É
)ªªÉ Ñ
)ªªÑ Ö
;ªªÖ Ü

endServico
ºº 
.
ºº 
Add
ºº 
(
ºº 
new
ºº "
EnderecoServico
ºº# 2
(
ºº2 3

ServicoNFe
ºº3 =
.
ºº= >
NFeAutorizacao
ºº> L
,
ººL M
VersaoServico
ººN [
.
ºº[ \
ve310
ºº\ a
,
ººa b
TipoAmbiente
ººc o
.
ººo p
taHomologacao
ººp }
,
ºº} ~
emissaoºº Ü
,ººÜ á
	EstadoNfeººà ë
.ººë í
CEººí î
,ººî ï
ModeloDocumentoººñ •
.ºº• ¶
NFeºº¶ ©
,ºº© ™
$strºº´ Î
)ººÎ Ï
)ººÏ Ì
;ººÌ Ó

endServico
ΩΩ 
.
ΩΩ 
Add
ΩΩ 
(
ΩΩ 
new
ΩΩ "
EnderecoServico
ΩΩ# 2
(
ΩΩ2 3

ServicoNFe
ΩΩ3 =
.
ΩΩ= >
NFeRetAutorizacao
ΩΩ> O
,
ΩΩO P
VersaoServico
ΩΩQ ^
.
ΩΩ^ _
ve310
ΩΩ_ d
,
ΩΩd e
TipoAmbiente
ΩΩf r
.
ΩΩr s
taHomologacaoΩΩs Ä
,ΩΩÄ Å
emissaoΩΩÇ â
,ΩΩâ ä
	EstadoNfeΩΩã î
.ΩΩî ï
CEΩΩï ó
,ΩΩó ò
ModeloDocumentoΩΩô ®
.ΩΩ® ©
NFeΩΩ© ¨
,ΩΩ¨ ≠
$strΩΩÆ Ò
)ΩΩÒ Ú
)ΩΩÚ Û
;ΩΩÛ Ù
}
ææ 
foreach
ƒƒ 
(
ƒƒ 
var
ƒƒ 
emissao
ƒƒ  
in
ƒƒ! #
emissaoComum
ƒƒ$ 0
)
ƒƒ0 1
{
≈≈ 
if
∆∆ 
(
∆∆ 
emissao
∆∆ 
!=
∆∆ 
TipoEmissao
∆∆ *
.
∆∆* +
teEPEC
∆∆+ 1
)
∆∆1 2

endServico
«« 
.
«« 
AddRange
«« '
(
««' (
eventoCceCanc
««( 5
.
««5 6
Select
««6 <
(
««< =

servicoNFe
««= G
=>
««H J
new
««K N
EnderecoServico
««O ^
(
««^ _

servicoNFe
««_ i
,
««i j
VersaoServico
««k x
.
««x y
ve100
««y ~
,
««~ 
TipoAmbiente««Ä å
.««å ç

taProducao««ç ó
,««ó ò
emissao««ô †
,««† °
	EstadoNfe««¢ ´
.««´ ¨
CE««¨ Æ
,««Æ Ø
ModeloDocumento««∞ ø
.««ø ¿
NFe««¿ √
,««√ ƒ
$str««≈ Ñ
)««Ñ Ö
)««Ö Ü
)««Ü á
;««á à

endServico
»» 
.
»» 
Add
»» 
(
»» 
new
»» "
EnderecoServico
»»# 2
(
»»2 3

ServicoNFe
»»3 =
.
»»= >
NfeRecepcao
»»> I
,
»»I J
VersaoServico
»»K X
.
»»X Y
ve200
»»Y ^
,
»»^ _
TipoAmbiente
»»` l
.
»»l m

taProducao
»»m w
,
»»w x
emissao»»y Ä
,»»Ä Å
	EstadoNfe»»Ç ã
.»»ã å
CE»»å é
,»»é è
ModeloDocumento»»ê ü
.»»ü †
NFe»»† £
,»»£ §
$str»»• ‚
)»»‚ „
)»»„ ‰
;»»‰ Â

endServico
…… 
.
…… 
Add
…… 
(
…… 
new
…… "
EnderecoServico
……# 2
(
……2 3

ServicoNFe
……3 =
.
……= >
NfeRetRecepcao
……> L
,
……L M
VersaoServico
……N [
.
……[ \
ve200
……\ a
,
……a b
TipoAmbiente
……c o
.
……o p

taProducao
……p z
,
……z {
emissao……| É
,……É Ñ
	EstadoNfe……Ö é
.……é è
CE……è ë
,……ë í
ModeloDocumento……ì ¢
.……¢ £
NFe……£ ¶
,……¶ ß
$str……® Ë
)……Ë È
)……È Í
;……Í Î

endServico
   
.
   
AddRange
   #
(
  # $
versaoDoisETres
  $ 3
.
  3 4
Select
  4 :
(
  : ;
versao
  ; A
=>
  B D
new
  E H
EnderecoServico
  I X
(
  X Y

ServicoNFe
  Y c
.
  c d
NfeInutilizacao
  d s
,
  s t
versao
  u {
,
  { |
TipoAmbiente  } â
.  â ä

taProducao  ä î
,  î ï
emissao  ñ ù
,  ù û
	EstadoNfe  ü ®
.  ® ©
CE  © ´
,  ´ ¨
ModeloDocumento  ≠ º
.  º Ω
NFe  Ω ¿
,  ¿ ¡
$str  ¬ É
)  É Ñ
)  Ñ Ö
)  Ö Ü
;  Ü á

endServico
ÀÀ 
.
ÀÀ 
AddRange
ÀÀ #
(
ÀÀ# $
versaoDoisETres
ÀÀ$ 3
.
ÀÀ3 4
Select
ÀÀ4 :
(
ÀÀ: ;
versao
ÀÀ; A
=>
ÀÀB D
new
ÀÀE H
EnderecoServico
ÀÀI X
(
ÀÀX Y

ServicoNFe
ÀÀY c
.
ÀÀc d"
NfeConsultaProtocolo
ÀÀd x
,
ÀÀx y
versaoÀÀz Ä
,ÀÀÄ Å
TipoAmbienteÀÀÇ é
.ÀÀé è

taProducaoÀÀè ô
,ÀÀô ö
emissaoÀÀõ ¢
,ÀÀ¢ £
	EstadoNfeÀÀ§ ≠
.ÀÀ≠ Æ
CEÀÀÆ ∞
,ÀÀ∞ ±
ModeloDocumentoÀÀ≤ ¡
.ÀÀ¡ ¬
NFeÀÀ¬ ≈
,ÀÀ≈ ∆
$strÀÀ« Ñ
)ÀÀÑ Ö
)ÀÀÖ Ü
)ÀÀÜ á
;ÀÀá à

endServico
ÃÃ 
.
ÃÃ 
AddRange
ÃÃ #
(
ÃÃ# $
versaoDoisETres
ÃÃ$ 3
.
ÃÃ3 4
Select
ÃÃ4 :
(
ÃÃ: ;
versao
ÃÃ; A
=>
ÃÃB D
new
ÃÃE H
EnderecoServico
ÃÃI X
(
ÃÃX Y

ServicoNFe
ÃÃY c
.
ÃÃc d
NfeStatusServico
ÃÃd t
,
ÃÃt u
versao
ÃÃv |
,
ÃÃ| }
TipoAmbienteÃÃ~ ä
.ÃÃä ã

taProducaoÃÃã ï
,ÃÃï ñ
emissaoÃÃó û
,ÃÃû ü
	EstadoNfeÃÃ† ©
.ÃÃ© ™
CEÃÃ™ ¨
,ÃÃ¨ ≠
ModeloDocumentoÃÃÆ Ω
.ÃÃΩ æ
NFeÃÃæ ¡
,ÃÃ¡ ¬
$strÃÃ√ Ö
)ÃÃÖ Ü
)ÃÃÜ á
)ÃÃá à
;ÃÃà â

endServico
ÕÕ 
.
ÕÕ 
AddRange
ÕÕ #
(
ÕÕ# $
versaoDoisETres
ÕÕ$ 3
.
ÕÕ3 4
Select
ÕÕ4 :
(
ÕÕ: ;
versao
ÕÕ; A
=>
ÕÕB D
new
ÕÕE H
EnderecoServico
ÕÕI X
(
ÕÕX Y

ServicoNFe
ÕÕY c
.
ÕÕc d!
NfeConsultaCadastro
ÕÕd w
,
ÕÕw x
versao
ÕÕy 
,ÕÕ Ä
TipoAmbienteÕÕÅ ç
.ÕÕç é

taProducaoÕÕé ò
,ÕÕò ô
emissaoÕÕö °
,ÕÕ° ¢
	EstadoNfeÕÕ£ ¨
.ÕÕ¨ ≠
CEÕÕ≠ Ø
,ÕÕØ ∞
ModeloDocumentoÕÕ± ¿
.ÕÕ¿ ¡
NFeÕÕ¡ ƒ
,ÕÕƒ ≈
$strÕÕ∆ ã
)ÕÕã å
)ÕÕå ç
)ÕÕç é
;ÕÕé è

endServico
ŒŒ 
.
ŒŒ 
AddRange
ŒŒ #
(
ŒŒ# $
versaoDoisETres
ŒŒ$ 3
.
ŒŒ3 4
Select
ŒŒ4 :
(
ŒŒ: ;
versao
ŒŒ; A
=>
ŒŒB D
new
ŒŒE H
EnderecoServico
ŒŒI X
(
ŒŒX Y

ServicoNFe
ŒŒY c
.
ŒŒc d
NfeDownloadNF
ŒŒd q
,
ŒŒq r
versao
ŒŒs y
,
ŒŒy z
TipoAmbienteŒŒ{ á
.ŒŒá à

taProducaoŒŒà í
,ŒŒí ì
emissaoŒŒî õ
,ŒŒõ ú
	EstadoNfeŒŒù ¶
.ŒŒ¶ ß
CEŒŒß ©
,ŒŒ© ™
ModeloDocumentoŒŒ´ ∫
.ŒŒ∫ ª
NFeŒŒª æ
,ŒŒæ ø
$strŒŒ¿ ˛
)ŒŒ˛ ˇ
)ŒŒˇ Ä
)ŒŒÄ Å
;ŒŒÅ Ç

endServico
œœ 
.
œœ 
Add
œœ 
(
œœ 
new
œœ "
EnderecoServico
œœ# 2
(
œœ2 3

ServicoNFe
œœ3 =
.
œœ= >
NFeAutorizacao
œœ> L
,
œœL M
VersaoServico
œœN [
.
œœ[ \
ve310
œœ\ a
,
œœa b
TipoAmbiente
œœc o
.
œœo p

taProducao
œœp z
,
œœz {
emissaoœœ| É
,œœÉ Ñ
	EstadoNfeœœÖ é
.œœé è
CEœœè ë
,œœë í
ModeloDocumentoœœì ¢
.œœ¢ £
NFeœœ£ ¶
,œœ¶ ß
$strœœ® Á
)œœÁ Ë
)œœË È
;œœÈ Í

endServico
–– 
.
–– 
Add
–– 
(
–– 
new
–– "
EnderecoServico
––# 2
(
––2 3

ServicoNFe
––3 =
.
––= >
NFeRetAutorizacao
––> O
,
––O P
VersaoServico
––Q ^
.
––^ _
ve310
––_ d
,
––d e
TipoAmbiente
––f r
.
––r s

taProducao
––s }
,
––} ~
emissao–– Ü
,––Ü á
	EstadoNfe––à ë
.––ë í
CE––í î
,––î ï
ModeloDocumento––ñ •
.––• ¶
NFe––¶ ©
,––© ™
$str––´ Ì
)––Ì Ó
)––Ó Ô
;––Ô 
}
—— 
foreach
·· 
(
·· 
var
·· 
emissao
··  
in
··! #
emissaoComum
··$ 0
)
··0 1
{
‚‚ 
foreach
„„ 
(
„„ 
var
„„ 
modelo
„„ #
in
„„$ &
todosOsModelos
„„' 5
)
„„5 6
{
‰‰ 
foreach
ÂÂ 
(
ÂÂ 
var
ÂÂ  
ambiente
ÂÂ! )
in
ÂÂ* ,
todosOsAmbientes
ÂÂ- =
)
ÂÂ= >
{
ÊÊ 

endServico
ÁÁ "
.
ÁÁ" #
Add
ÁÁ# &
(
ÁÁ& '
new
ÁÁ' *
EnderecoServico
ÁÁ+ :
(
ÁÁ: ;

ServicoNFe
ÁÁ; E
.
ÁÁE F!
NfeConsultaCadastro
ÁÁF Y
,
ÁÁY Z
VersaoServico
ÁÁ[ h
.
ÁÁh i
ve200
ÁÁi n
,
ÁÁn o
ambiente
ÁÁp x
,
ÁÁx y
emissaoÁÁz Å
,ÁÁÅ Ç
	EstadoNfeÁÁÉ å
.ÁÁå ç
ESÁÁç è
,ÁÁè ê
modeloÁÁë ó
,ÁÁó ò
$strÁÁô Ë
)ÁÁË È
)ÁÁÈ Í
;ÁÁÍ Î
}
ËË 
}
ÈÈ 
}
ÍÍ 
foreach
ÙÙ 
(
ÙÙ 
var
ÙÙ 
emissao
ÙÙ  
in
ÙÙ! #
emissaoComum
ÙÙ$ 0
)
ÙÙ0 1
{
ıı 
if
ˆˆ 
(
ˆˆ 
emissao
ˆˆ 
!=
ˆˆ 
TipoEmissao
ˆˆ *
.
ˆˆ* +
teEPEC
ˆˆ+ 1
)
ˆˆ1 2

endServico
˜˜ 
.
˜˜ 
AddRange
˜˜ '
(
˜˜' (
eventoCceCanc
˜˜( 5
.
˜˜5 6
Select
˜˜6 <
(
˜˜< =

servicoNFe
˜˜= G
=>
˜˜H J
new
˜˜K N
EnderecoServico
˜˜O ^
(
˜˜^ _

servicoNFe
˜˜_ i
,
˜˜i j
VersaoServico
˜˜k x
.
˜˜x y
ve100
˜˜y ~
,
˜˜~ 
TipoAmbiente˜˜Ä å
.˜˜å ç
taHomologacao˜˜ç ö
,˜˜ö õ
emissao˜˜ú £
,˜˜£ §
	EstadoNfe˜˜• Æ
.˜˜Æ Ø
GO˜˜Ø ±
,˜˜± ≤
ModeloDocumento˜˜≥ ¬
.˜˜¬ √
NFe˜˜√ ∆
,˜˜∆ «
$str˜˜» ç
)˜˜ç é
)˜˜é è
)˜˜è ê
;˜˜ê ë

endServico
¯¯ 
.
¯¯ 
Add
¯¯ 
(
¯¯ 
new
¯¯ "
EnderecoServico
¯¯# 2
(
¯¯2 3

ServicoNFe
¯¯3 =
.
¯¯= >'
RecepcaoEventoCancelmento
¯¯> W
,
¯¯W X
VersaoServico
¯¯Y f
.
¯¯f g
ve100
¯¯g l
,
¯¯l m
TipoAmbiente
¯¯n z
.
¯¯z {
taHomologacao¯¯{ à
,¯¯à â
emissao¯¯ä ë
,¯¯ë í
	EstadoNfe¯¯ì ú
.¯¯ú ù
GO¯¯ù ü
,¯¯ü †
ModeloDocumento¯¯° ∞
.¯¯∞ ±
NFCe¯¯± µ
,¯¯µ ∂
$str¯¯∑ ¸
)¯¯¸ ˝
)¯¯˝ ˛
;¯¯˛ ˇ
foreach
˙˙ 
(
˙˙ 
var
˙˙ 
modelo
˙˙ #
in
˙˙$ &
todosOsModelos
˙˙' 5
)
˙˙5 6
{
˚˚ 

endServico
¸¸ 
.
¸¸ 
Add
¸¸ "
(
¸¸" #
new
¸¸# &
EnderecoServico
¸¸' 6
(
¸¸6 7

ServicoNFe
¸¸7 A
.
¸¸A B
NfeRecepcao
¸¸B M
,
¸¸M N
VersaoServico
¸¸O \
.
¸¸\ ]
ve200
¸¸] b
,
¸¸b c
TipoAmbiente
¸¸d p
.
¸¸p q
taHomologacao
¸¸q ~
,
¸¸~ 
emissao¸¸Ä á
,¸¸á à
	EstadoNfe¸¸â í
.¸¸í ì
GO¸¸ì ï
,¸¸ï ñ
modelo¸¸ó ù
,¸¸ù û
$str¸¸ü ‚
)¸¸‚ „
)¸¸„ ‰
;¸¸‰ Â

endServico
˝˝ 
.
˝˝ 
Add
˝˝ "
(
˝˝" #
new
˝˝# &
EnderecoServico
˝˝' 6
(
˝˝6 7

ServicoNFe
˝˝7 A
.
˝˝A B
NfeRetRecepcao
˝˝B P
,
˝˝P Q
VersaoServico
˝˝R _
.
˝˝_ `
ve200
˝˝` e
,
˝˝e f
TipoAmbiente
˝˝g s
.
˝˝s t
taHomologacao˝˝t Å
,˝˝Å Ç
emissao˝˝É ä
,˝˝ä ã
	EstadoNfe˝˝å ï
.˝˝ï ñ
GO˝˝ñ ò
,˝˝ò ô
modelo˝˝ö †
,˝˝† °
$str˝˝¢ Ë
)˝˝Ë È
)˝˝È Í
;˝˝Í Î

endServico
˛˛ 
.
˛˛ 
AddRange
˛˛ '
(
˛˛' (
versaoDoisETres
˛˛( 7
.
˛˛7 8
Select
˛˛8 >
(
˛˛> ?
versao
˛˛? E
=>
˛˛F H
new
˛˛I L
EnderecoServico
˛˛M \
(
˛˛\ ]

ServicoNFe
˛˛] g
.
˛˛g h
NfeInutilizacao
˛˛h w
,
˛˛w x
versao
˛˛y 
,˛˛ Ä
TipoAmbiente˛˛Å ç
.˛˛ç é
taHomologacao˛˛é õ
,˛˛õ ú
emissao˛˛ù §
,˛˛§ •
	EstadoNfe˛˛¶ Ø
.˛˛Ø ∞
GO˛˛∞ ≤
,˛˛≤ ≥
modelo˛˛¥ ∫
,˛˛∫ ª
$str˛˛º É
)˛˛É Ñ
)˛˛Ñ Ö
)˛˛Ö Ü
;˛˛Ü á

endServico
ˇˇ 
.
ˇˇ 
AddRange
ˇˇ '
(
ˇˇ' (
versaoDoisETres
ˇˇ( 7
.
ˇˇ7 8
Select
ˇˇ8 >
(
ˇˇ> ?
versao
ˇˇ? E
=>
ˇˇF H
new
ˇˇI L
EnderecoServico
ˇˇM \
(
ˇˇ\ ]

ServicoNFe
ˇˇ] g
.
ˇˇg h"
NfeConsultaProtocolo
ˇˇh |
,
ˇˇ| }
versaoˇˇ~ Ñ
,ˇˇÑ Ö
TipoAmbienteˇˇÜ í
.ˇˇí ì
taHomologacaoˇˇì †
,ˇˇ† °
emissaoˇˇ¢ ©
,ˇˇ© ™
	EstadoNfeˇˇ´ ¥
.ˇˇ¥ µ
GOˇˇµ ∑
,ˇˇ∑ ∏
modeloˇˇπ ø
,ˇˇø ¿
$strˇˇ¡ Ñ
)ˇˇÑ Ö
)ˇˇÖ Ü
)ˇˇÜ á
;ˇˇá à

endServico
ÄÄ 
.
ÄÄ 
AddRange
ÄÄ '
(
ÄÄ' (
versaoDoisETres
ÄÄ( 7
.
ÄÄ7 8
Select
ÄÄ8 >
(
ÄÄ> ?
versao
ÄÄ? E
=>
ÄÄF H
new
ÄÄI L
EnderecoServico
ÄÄM \
(
ÄÄ\ ]

ServicoNFe
ÄÄ] g
.
ÄÄg h
NfeStatusServico
ÄÄh x
,
ÄÄx y
versaoÄÄz Ä
,ÄÄÄ Å
TipoAmbienteÄÄÇ é
.ÄÄé è
taHomologacaoÄÄè ú
,ÄÄú ù
emissaoÄÄû •
,ÄÄ• ¶
	EstadoNfeÄÄß ∞
.ÄÄ∞ ±
GOÄÄ± ≥
,ÄÄ≥ ¥
modeloÄÄµ ª
,ÄÄª º
$strÄÄΩ Ö
)ÄÄÖ Ü
)ÄÄÜ á
)ÄÄá à
;ÄÄà â

endServico
ÅÅ 
.
ÅÅ 
AddRange
ÅÅ '
(
ÅÅ' (
versaoDoisETres
ÇÇ '
.
ÇÇ' (
Select
ÇÇ( .
(
ÇÇ. /
versao
ÇÇ/ 5
=>
ÇÇ6 8
new
ÇÇ9 <
EnderecoServico
ÇÇ= L
(
ÇÇL M

ServicoNFe
ÇÇM W
.
ÇÇW X!
NfeConsultaCadastro
ÇÇX k
,
ÇÇk l
versao
ÇÇm s
,
ÇÇs t
TipoAmbienteÇÇu Å
.ÇÇÅ Ç
taHomologacaoÇÇÇ è
,ÇÇè ê
emissaoÇÇë ò
,ÇÇò ô
	EstadoNfeÇÇö £
.ÇÇ£ §
GOÇÇ§ ¶
,ÇÇ¶ ß
modeloÇÇ® Æ
,ÇÇÆ Ø
$strÇÇ∞ ˚
)ÇÇ˚ ¸
)ÇÇ¸ ˝
)ÇÇ˝ ˛
;ÇÇ˛ ˇ

endServico
ÉÉ 
.
ÉÉ 
Add
ÉÉ "
(
ÉÉ" #
new
ÉÉ# &
EnderecoServico
ÉÉ' 6
(
ÉÉ6 7

ServicoNFe
ÉÉ7 A
.
ÉÉA B
NFeAutorizacao
ÉÉB P
,
ÉÉP Q
VersaoServico
ÉÉR _
.
ÉÉ_ `
ve310
ÉÉ` e
,
ÉÉe f
TipoAmbiente
ÉÉg s
.
ÉÉs t
taHomologacaoÉÉt Å
,ÉÉÅ Ç
emissaoÉÉÉ ä
,ÉÉä ã
	EstadoNfeÉÉå ï
.ÉÉï ñ
GOÉÉñ ò
,ÉÉò ô
modeloÉÉö †
,ÉÉ† °
$strÉÉ¢ Á
)ÉÉÁ Ë
)ÉÉË È
;ÉÉÈ Í

endServico
ÑÑ 
.
ÑÑ 
Add
ÑÑ "
(
ÑÑ" #
new
ÑÑ# &
EnderecoServico
ÑÑ' 6
(
ÑÑ6 7

ServicoNFe
ÑÑ7 A
.
ÑÑA B
NFeRetAutorizacao
ÑÑB S
,
ÑÑS T
VersaoServico
ÑÑU b
.
ÑÑb c
ve310
ÑÑc h
,
ÑÑh i
TipoAmbiente
ÑÑj v
.
ÑÑv w
taHomologacaoÑÑw Ñ
,ÑÑÑ Ö
emissaoÑÑÜ ç
,ÑÑç é
	EstadoNfeÑÑè ò
.ÑÑò ô
GOÑÑô õ
,ÑÑõ ú
modeloÑÑù £
,ÑÑ£ §
$strÑÑ• Ì
)ÑÑÌ Ó
)ÑÑÓ Ô
;ÑÑÔ 

endServico
ÖÖ 
.
ÖÖ 
Add
ÖÖ "
(
ÖÖ" #
new
ÖÖ# &
EnderecoServico
ÖÖ' 6
(
ÖÖ6 7

ServicoNFe
ÖÖ7 A
.
ÖÖA B"
NfceAdministracaoCSC
ÖÖB V
,
ÖÖV W
VersaoServico
ÖÖX e
.
ÖÖe f
ve100
ÖÖf k
,
ÖÖk l
TipoAmbiente
ÖÖm y
.
ÖÖy z
taHomologacaoÖÖz á
,ÖÖá à
emissaoÖÖâ ê
,ÖÖê ë
	EstadoNfeÖÖí õ
.ÖÖõ ú
GOÖÖú û
,ÖÖû ü
modeloÖÖ† ¶
,ÖÖ¶ ß
$strÖÖ® Ê
)ÖÖÊ Á
)ÖÖÁ Ë
;ÖÖË È
}
ÜÜ 
}
áá 
foreach
çç 
(
çç 
var
çç 
emissao
çç  
in
çç! #
emissaoComum
çç$ 0
)
çç0 1
{
éé 
if
èè 
(
èè 
emissao
èè 
!=
èè 
TipoEmissao
èè *
.
èè* +
teEPEC
èè+ 1
)
èè1 2

endServico
êê 
.
êê 
AddRange
êê '
(
êê' (
eventoCceCanc
êê( 5
.
êê5 6
Select
êê6 <
(
êê< =

servicoNFe
êê= G
=>
êêH J
new
êêK N
EnderecoServico
êêO ^
(
êê^ _

servicoNFe
êê_ i
,
êêi j
VersaoServico
êêk x
.
êêx y
ve100
êêy ~
,
êê~ 
TipoAmbienteêêÄ å
.êêå ç

taProducaoêêç ó
,êêó ò
emissaoêêô †
,êê† °
	EstadoNfeêê¢ ´
.êê´ ¨
GOêê¨ Æ
,êêÆ Ø
ModeloDocumentoêê∞ ø
.êêø ¿
NFeêê¿ √
,êê√ ƒ
$strêê≈ Ü
)êêÜ á
)êêá à
)êêà â
;êêâ ä

endServico
ëë 
.
ëë 
Add
ëë 
(
ëë 
new
ëë "
EnderecoServico
ëë# 2
(
ëë2 3

ServicoNFe
ëë3 =
.
ëë= >'
RecepcaoEventoCancelmento
ëë> W
,
ëëW X
VersaoServico
ëëY f
.
ëëf g
ve100
ëëg l
,
ëël m
TipoAmbiente
ëën z
.
ëëz {

taProducaoëë{ Ö
,ëëÖ Ü
emissaoëëá é
,ëëé è
	EstadoNfeëëê ô
.ëëô ö
GOëëö ú
,ëëú ù
ModeloDocumentoëëû ≠
.ëë≠ Æ
NFCeëëÆ ≤
,ëë≤ ≥
$strëë¥ ı
)ëëı ˆ
)ëëˆ ˜
;ëë˜ ¯
foreach
ìì 
(
ìì 
var
ìì 
modelo
ìì #
in
ìì$ &
todosOsModelos
ìì' 5
)
ìì5 6
{
îî 

endServico
ïï 
.
ïï 
Add
ïï "
(
ïï" #
new
ïï# &
EnderecoServico
ïï' 6
(
ïï6 7

ServicoNFe
ïï7 A
.
ïïA B
NfeRecepcao
ïïB M
,
ïïM N
VersaoServico
ïïO \
.
ïï\ ]
ve200
ïï] b
,
ïïb c
TipoAmbiente
ïïd p
.
ïïp q

taProducao
ïïq {
,
ïï{ |
emissaoïï} Ñ
,ïïÑ Ö
	EstadoNfeïïÜ è
.ïïè ê
GOïïê í
,ïïí ì
modeloïïî ö
,ïïö õ
$strïïú €
)ïï€ ‹
)ïï‹ ›
;ïï› ﬁ

endServico
ññ 
.
ññ 
Add
ññ "
(
ññ" #
new
ññ# &
EnderecoServico
ññ' 6
(
ññ6 7

ServicoNFe
ññ7 A
.
ññA B
NfeRetRecepcao
ññB P
,
ññP Q
VersaoServico
ññR _
.
ññ_ `
ve200
ññ` e
,
ññe f
TipoAmbiente
ññg s
.
ññs t

taProducao
ññt ~
,
ññ~ 
emissaoññÄ á
,ññá à
	EstadoNfeññâ í
.ññí ì
GOññì ï
,ññï ñ
modeloññó ù
,ññù û
$strññü ·
)ññ· ‚
)ññ‚ „
;ññ„ ‰

endServico
óó 
.
óó 
AddRange
óó '
(
óó' (
versaoDoisETres
óó( 7
.
óó7 8
Select
óó8 >
(
óó> ?
versao
óó? E
=>
óóF H
new
óóI L
EnderecoServico
óóM \
(
óó\ ]

ServicoNFe
óó] g
.
óóg h
NfeInutilizacao
óóh w
,
óów x
versao
óóy 
,óó Ä
TipoAmbienteóóÅ ç
.óóç é

taProducaoóóé ò
,óóò ô
emissaoóóö °
,óó° ¢
	EstadoNfeóó£ ¨
.óó¨ ≠
GOóó≠ Ø
,óóØ ∞
modeloóó± ∑
,óó∑ ∏
$stróóπ ¸
)óó¸ ˝
)óó˝ ˛
)óó˛ ˇ
;óóˇ Ä

endServico
òò 
.
òò 
AddRange
òò '
(
òò' (
versaoDoisETres
òò( 7
.
òò7 8
Select
òò8 >
(
òò> ?
versao
òò? E
=>
òòF H
new
òòI L
EnderecoServico
òòM \
(
òò\ ]

ServicoNFe
òò] g
.
òòg h"
NfeConsultaProtocolo
òòh |
,
òò| }
versaoòò~ Ñ
,òòÑ Ö
TipoAmbienteòòÜ í
.òòí ì

taProducaoòòì ù
,òòù û
emissaoòòü ¶
,òò¶ ß
	EstadoNfeòò® ±
.òò± ≤
GOòò≤ ¥
,òò¥ µ
modeloòò∂ º
,òòº Ω
$stròòæ ˝
)òò˝ ˛
)òò˛ ˇ
)òòˇ Ä
;òòÄ Å

endServico
ôô 
.
ôô 
AddRange
ôô '
(
ôô' (
versaoDoisETres
ôô( 7
.
ôô7 8
Select
ôô8 >
(
ôô> ?
versao
ôô? E
=>
ôôF H
new
ôôI L
EnderecoServico
ôôM \
(
ôô\ ]

ServicoNFe
ôô] g
.
ôôg h
NfeStatusServico
ôôh x
,
ôôx y
versaoôôz Ä
,ôôÄ Å
TipoAmbienteôôÇ é
.ôôé è

taProducaoôôè ô
,ôôô ö
emissaoôôõ ¢
,ôô¢ £
	EstadoNfeôô§ ≠
.ôô≠ Æ
GOôôÆ ∞
,ôô∞ ±
modeloôô≤ ∏
,ôô∏ π
$strôô∫ ˛
)ôô˛ ˇ
)ôôˇ Ä
)ôôÄ Å
;ôôÅ Ç

endServico
öö 
.
öö 
AddRange
öö '
(
öö' (
versaoDoisETres
öö( 7
.
öö7 8
Select
öö8 >
(
öö> ?
versao
öö? E
=>
ööF H
new
ööI L
EnderecoServico
ööM \
(
öö\ ]

ServicoNFe
öö] g
.
öög h!
NfeConsultaCadastro
ööh {
,
öö{ |
versaoöö} É
,ööÉ Ñ
TipoAmbienteööÖ ë
.ööë í

taProducaoööí ú
,ööú ù
emissaoööû •
,öö• ¶
	EstadoNfeööß ∞
.öö∞ ±
GOöö± ≥
,öö≥ ¥
modeloööµ ª
,ööª º
$strööΩ Ñ
)ööÑ Ö
)ööÖ Ü
)ööÜ á
;ööá à

endServico
õõ 
.
õõ 
Add
õõ "
(
õõ" #
new
õõ# &
EnderecoServico
õõ' 6
(
õõ6 7

ServicoNFe
õõ7 A
.
õõA B
NFeAutorizacao
õõB P
,
õõP Q
VersaoServico
õõR _
.
õõ_ `
ve310
õõ` e
,
õõe f
TipoAmbiente
õõg s
.
õõs t

taProducao
õõt ~
,
õõ~ 
emissaoõõÄ á
,õõá à
	EstadoNfeõõâ í
.õõí ì
GOõõì ï
,õõï ñ
modeloõõó ù
,õõù û
$strõõü ‡
)õõ‡ ·
)õõ· ‚
;õõ‚ „

endServico
úú 
.
úú 
Add
úú "
(
úú" #
new
úú# &
EnderecoServico
úú' 6
(
úú6 7

ServicoNFe
úú7 A
.
úúA B
NFeRetAutorizacao
úúB S
,
úúS T
VersaoServico
úúU b
.
úúb c
ve310
úúc h
,
úúh i
TipoAmbiente
úúj v
.
úúv w

taProducaoúúw Å
,úúÅ Ç
emissaoúúÉ ä
,úúä ã
	EstadoNfeúúå ï
.úúï ñ
GOúúñ ò
,úúò ô
modeloúúö †
,úú† °
$strúú¢ Ê
)úúÊ Á
)úúÁ Ë
;úúË È

endServico
ùù 
.
ùù 
Add
ùù "
(
ùù" #
new
ùù# &
EnderecoServico
ùù' 6
(
ùù6 7

ServicoNFe
ùù7 A
.
ùùA B"
NfceAdministracaoCSC
ùùB V
,
ùùV W
VersaoServico
ùùX e
.
ùùe f
ve100
ùùf k
,
ùùk l
TipoAmbiente
ùùm y
.
ùùy z

taProducaoùùz Ñ
,ùùÑ Ö
emissaoùùÜ ç
,ùùç é
	EstadoNfeùùè ò
.ùùò ô
GOùùô õ
,ùùõ ú
modeloùùù £
,ùù£ §
$strùù• ‡
)ùù‡ ·
)ùù· ‚
;ùù‚ „
}
ûû 
}
üü 
foreach
©© 
(
©© 
var
©© 
emissao
©©  
in
©©! #
emissaoComum
©©$ 0
)
©©0 1
{
™™ 
foreach
´´ 
(
´´ 
var
´´ 
modelo
´´ #
in
´´$ &
todosOsModelos
´´' 5
)
´´5 6
{
¨¨ 
foreach
≠≠ 
(
≠≠ 
var
≠≠  
ambiente
≠≠! )
in
≠≠* ,
todosOsAmbientes
≠≠- =
)
≠≠= >
{
ÆÆ 

endServico
ØØ "
.
ØØ" #
Add
ØØ# &
(
ØØ& '
new
ØØ' *
EnderecoServico
ØØ+ :
(
ØØ: ;

ServicoNFe
ØØ; E
.
ØØE F!
NfeConsultaCadastro
ØØF Y
,
ØØY Z
VersaoServico
ØØ[ h
.
ØØh i
ve200
ØØi n
,
ØØn o
ambiente
ØØp x
,
ØØx y
emissaoØØz Å
,ØØÅ Ç
	EstadoNfeØØÉ å
.ØØå ç
MAØØç è
,ØØè ê
modeloØØë ó
,ØØó ò
$strØØô ‡
)ØØ‡ ·
)ØØ· ‚
;ØØ‚ „
}
∞∞ 
}
±± 
}
≤≤ 
foreach
ºº 
(
ºº 
var
ºº 
emissao
ºº  
in
ºº! #
emissaoComum
ºº$ 0
)
ºº0 1
{
ΩΩ 
if
ææ 
(
ææ 
emissao
ææ 
!=
ææ 
TipoEmissao
ææ *
.
ææ* +
teEPEC
ææ+ 1
)
ææ1 2

endServico
øø 
.
øø 
AddRange
øø '
(
øø' (
eventoCceCanc
øø( 5
.
øø5 6
Select
øø6 <
(
øø< =

servicoNFe
øø= G
=>
øøH J
new
øøK N
EnderecoServico
øøO ^
(
øø^ _

servicoNFe
øø_ i
,
øøi j
VersaoServico
øøk x
.
øøx y
ve100
øøy ~
,
øø~ 
TipoAmbienteøøÄ å
.øøå ç
taHomologacaoøøç ö
,øøö õ
emissaoøøú £
,øø£ §
	EstadoNfeøø• Æ
.øøÆ Ø
MGøøØ ±
,øø± ≤
ModeloDocumentoøø≥ ¬
.øø¬ √
NFeøø√ ∆
,øø∆ «
$strøø» Ö
)øøÖ Ü
)øøÜ á
)øøá à
;øøà â

endServico
¿¿ 
.
¿¿ 
Add
¿¿ 
(
¿¿ 
new
¿¿ "
EnderecoServico
¿¿# 2
(
¿¿2 3

ServicoNFe
¿¿3 =
.
¿¿= >
NfeRecepcao
¿¿> I
,
¿¿I J
VersaoServico
¿¿K X
.
¿¿X Y
ve200
¿¿Y ^
,
¿¿^ _
TipoAmbiente
¿¿` l
.
¿¿l m
taHomologacao
¿¿m z
,
¿¿z {
emissao¿¿| É
,¿¿É Ñ
	EstadoNfe¿¿Ö é
.¿¿é è
MG¿¿è ë
,¿¿ë í
ModeloDocumento¿¿ì ¢
.¿¿¢ £
NFe¿¿£ ¶
,¿¿¶ ß
$str¿¿® „
)¿¿„ ‰
)¿¿‰ Â
;¿¿Â Ê

endServico
¡¡ 
.
¡¡ 
Add
¡¡ 
(
¡¡ 
new
¡¡ "
EnderecoServico
¡¡# 2
(
¡¡2 3

ServicoNFe
¡¡3 =
.
¡¡= >
NfeRetRecepcao
¡¡> L
,
¡¡L M
VersaoServico
¡¡N [
.
¡¡[ \
ve200
¡¡\ a
,
¡¡a b
TipoAmbiente
¡¡c o
.
¡¡o p
taHomologacao
¡¡p }
,
¡¡} ~
emissao¡¡ Ü
,¡¡Ü á
	EstadoNfe¡¡à ë
.¡¡ë í
MG¡¡í î
,¡¡î ï
ModeloDocumento¡¡ñ •
.¡¡• ¶
NFe¡¡¶ ©
,¡¡© ™
$str¡¡´ È
)¡¡È Í
)¡¡Í Î
;¡¡Î Ï

endServico
¬¬ 
.
¬¬ 
AddRange
¬¬ #
(
¬¬# $
versaoDoisETres
¬¬$ 3
.
¬¬3 4
Select
¬¬4 :
(
¬¬: ;
versao
¬¬; A
=>
¬¬B D
new
¬¬E H
EnderecoServico
¬¬I X
(
¬¬X Y

ServicoNFe
¬¬Y c
.
¬¬c d
NfeInutilizacao
¬¬d s
,
¬¬s t
versao
¬¬u {
,
¬¬{ |
TipoAmbiente¬¬} â
.¬¬â ä
taHomologacao¬¬ä ó
,¬¬ó ò
emissao¬¬ô †
,¬¬† °
	EstadoNfe¬¬¢ ´
.¬¬´ ¨
MG¬¬¨ Æ
,¬¬Æ Ø
ModeloDocumento¬¬∞ ø
.¬¬ø ¿
NFe¬¬¿ √
,¬¬√ ƒ
$str¬¬≈ Ñ
)¬¬Ñ Ö
)¬¬Ö Ü
)¬¬Ü á
;¬¬á à

endServico
√√ 
.
√√ 
AddRange
√√ #
(
√√# $
versaoDoisETres
√√$ 3
.
√√3 4
Select
√√4 :
(
√√: ;
versao
√√; A
=>
√√B D
new
√√E H
EnderecoServico
√√I X
(
√√X Y

ServicoNFe
√√Y c
.
√√c d"
NfeConsultaProtocolo
√√d x
,
√√x y
versao√√z Ä
,√√Ä Å
TipoAmbiente√√Ç é
.√√é è
taHomologacao√√è ú
,√√ú ù
emissao√√û •
,√√• ¶
	EstadoNfe√√ß ∞
.√√∞ ±
MG√√± ≥
,√√≥ ¥
ModeloDocumento√√µ ƒ
.√√ƒ ≈
NFe√√≈ »
,√√» …
$str√√  Ö
)√√Ö Ü
)√√Ü á
)√√á à
;√√à â

endServico
ƒƒ 
.
ƒƒ 
AddRange
ƒƒ #
(
ƒƒ# $
versaoDoisETres
ƒƒ$ 3
.
ƒƒ3 4
Select
ƒƒ4 :
(
ƒƒ: ;
versao
ƒƒ; A
=>
ƒƒB D
new
ƒƒE H
EnderecoServico
ƒƒI X
(
ƒƒX Y

ServicoNFe
ƒƒY c
.
ƒƒc d
NfeStatusServico
ƒƒd t
,
ƒƒt u
versao
ƒƒv |
,
ƒƒ| }
TipoAmbienteƒƒ~ ä
.ƒƒä ã
taHomologacaoƒƒã ò
,ƒƒò ô
emissaoƒƒö °
,ƒƒ° ¢
	EstadoNfeƒƒ£ ¨
.ƒƒ¨ ≠
MGƒƒ≠ Ø
,ƒƒØ ∞
ModeloDocumentoƒƒ± ¿
.ƒƒ¿ ¡
NFeƒƒ¡ ƒ
,ƒƒƒ ≈
$strƒƒ∆ Ü
)ƒƒÜ á
)ƒƒá à
)ƒƒà â
;ƒƒâ ä

endServico
≈≈ 
.
≈≈ 
AddRange
≈≈ #
(
≈≈# $
versaoDoisETres
∆∆ #
.
∆∆# $
Select
∆∆$ *
(
∆∆* +
versao
∆∆+ 1
=>
∆∆2 4
new
∆∆5 8
EnderecoServico
∆∆9 H
(
∆∆H I

ServicoNFe
∆∆I S
.
∆∆S T!
NfeConsultaCadastro
∆∆T g
,
∆∆g h
versao
∆∆i o
,
∆∆o p
TipoAmbiente
∆∆q }
.
∆∆} ~
taHomologacao∆∆~ ã
,∆∆ã å
emissao∆∆ç î
,∆∆î ï
	EstadoNfe∆∆ñ ü
.∆∆ü †
MG∆∆† ¢
,∆∆¢ £
ModeloDocumento∆∆§ ≥
.∆∆≥ ¥
NFe∆∆¥ ∑
,∆∆∑ ∏
$str∆∆π ¸
)∆∆¸ ˝
)∆∆˝ ˛
)∆∆˛ ˇ
;∆∆ˇ Ä

endServico
«« 
.
«« 
Add
«« 
(
«« 
new
«« "
EnderecoServico
««# 2
(
««2 3

ServicoNFe
««3 =
.
««= >
NFeAutorizacao
««> L
,
««L M
VersaoServico
««N [
.
««[ \
ve310
««\ a
,
««a b
TipoAmbiente
««c o
.
««o p
taHomologacao
««p }
,
««} ~
emissao«« Ü
,««Ü á
	EstadoNfe««à ë
.««ë í
MG««í î
,««î ï
ModeloDocumento««ñ •
.««• ¶
NFe««¶ ©
,««© ™
$str««´ Ë
)««Ë È
)««È Í
;««Í Î

endServico
»» 
.
»» 
Add
»» 
(
»» 
new
»» "
EnderecoServico
»»# 2
(
»»2 3

ServicoNFe
»»3 =
.
»»= >
NFeRetAutorizacao
»»> O
,
»»O P
VersaoServico
»»Q ^
.
»»^ _
ve310
»»_ d
,
»»d e
TipoAmbiente
»»f r
.
»»r s
taHomologacao»»s Ä
,»»Ä Å
emissao»»Ç â
,»»â ä
	EstadoNfe»»ã î
.»»î ï
MG»»ï ó
,»»ó ò
ModeloDocumento»»ô ®
.»»® ©
NFe»»© ¨
,»»¨ ≠
$str»»Æ Ó
)»»Ó Ô
)»»Ô 
;»» Ò
}
…… 
foreach
œœ 
(
œœ 
var
œœ 
emissao
œœ  
in
œœ! #
emissaoComum
œœ$ 0
)
œœ0 1
{
–– 
if
—— 
(
—— 
emissao
—— 
!=
—— 
TipoEmissao
—— *
.
——* +
teEPEC
——+ 1
)
——1 2

endServico
““ 
.
““ 
AddRange
““ '
(
““' (
eventoCceCanc
““( 5
.
““5 6
Select
““6 <
(
““< =

servicoNFe
““= G
=>
““H J
new
““K N
EnderecoServico
““O ^
(
““^ _

servicoNFe
““_ i
,
““i j
VersaoServico
““k x
.
““x y
ve100
““y ~
,
““~ 
TipoAmbiente““Ä å
.““å ç

taProducao““ç ó
,““ó ò
emissao““ô †
,““† °
	EstadoNfe““¢ ´
.““´ ¨
MG““¨ Æ
,““Æ Ø
ModeloDocumento““∞ ø
.““ø ¿
NFe““¿ √
,““√ ƒ
$str““≈ Å
)““Å Ç
)““Ç É
)““É Ñ
;““Ñ Ö

endServico
”” 
.
”” 
Add
”” 
(
”” 
new
”” "
EnderecoServico
””# 2
(
””2 3

ServicoNFe
””3 =
.
””= >!
NfeConsultaCadastro
””> Q
,
””Q R
VersaoServico
””S `
.
””` a
ve200
””a f
,
””f g
TipoAmbiente
””h t
.
””t u

taProducao
””u 
,”” Ä
emissao””Å à
,””à â
	EstadoNfe””ä ì
.””ì î
MG””î ñ
,””ñ ó
ModeloDocumento””ò ß
.””ß ®
NFe””® ´
,””´ ¨
$str””≠ Ô
)””Ô 
)”” Ò
;””Ò Ú

endServico
‘‘ 
.
‘‘ 
Add
‘‘ 
(
‘‘ 
new
‘‘ "
EnderecoServico
‘‘# 2
(
‘‘2 3

ServicoNFe
‘‘3 =
.
‘‘= >
NfeRecepcao
‘‘> I
,
‘‘I J
VersaoServico
‘‘K X
.
‘‘X Y
ve200
‘‘Y ^
,
‘‘^ _
TipoAmbiente
‘‘` l
.
‘‘l m

taProducao
‘‘m w
,
‘‘w x
emissao‘‘y Ä
,‘‘Ä Å
	EstadoNfe‘‘Ç ã
.‘‘ã å
MG‘‘å é
,‘‘é è
ModeloDocumento‘‘ê ü
.‘‘ü †
NFe‘‘† £
,‘‘£ §
$str‘‘• ﬂ
)‘‘ﬂ ‡
)‘‘‡ ·
;‘‘· ‚

endServico
’’ 
.
’’ 
Add
’’ 
(
’’ 
new
’’ "
EnderecoServico
’’# 2
(
’’2 3

ServicoNFe
’’3 =
.
’’= >
NfeRetRecepcao
’’> L
,
’’L M
VersaoServico
’’N [
.
’’[ \
ve200
’’\ a
,
’’a b
TipoAmbiente
’’c o
.
’’o p

taProducao
’’p z
,
’’z {
emissao’’| É
,’’É Ñ
	EstadoNfe’’Ö é
.’’é è
MG’’è ë
,’’ë í
ModeloDocumento’’ì ¢
.’’¢ £
NFe’’£ ¶
,’’¶ ß
$str’’® Â
)’’Â Ê
)’’Ê Á
;’’Á Ë

endServico
÷÷ 
.
÷÷ 
AddRange
÷÷ #
(
÷÷# $
versaoDoisETres
÷÷$ 3
.
÷÷3 4
Select
÷÷4 :
(
÷÷: ;
versao
÷÷; A
=>
÷÷B D
new
÷÷E H
EnderecoServico
÷÷I X
(
÷÷X Y

ServicoNFe
÷÷Y c
.
÷÷c d
NfeInutilizacao
÷÷d s
,
÷÷s t
versao
÷÷u {
,
÷÷{ |
TipoAmbiente÷÷} â
.÷÷â ä

taProducao÷÷ä î
,÷÷î ï
emissao÷÷ñ ù
,÷÷ù û
	EstadoNfe÷÷ü ®
.÷÷® ©
MG÷÷© ´
,÷÷´ ¨
ModeloDocumento÷÷≠ º
.÷÷º Ω
NFe÷÷Ω ¿
,÷÷¿ ¡
$str÷÷¬ Ä
)÷÷Ä Å
)÷÷Å Ç
)÷÷Ç É
;÷÷É Ñ

endServico
◊◊ 
.
◊◊ 
AddRange
◊◊ #
(
◊◊# $
versaoDoisETres
◊◊$ 3
.
◊◊3 4
Select
◊◊4 :
(
◊◊: ;
versao
◊◊; A
=>
◊◊B D
new
◊◊E H
EnderecoServico
◊◊I X
(
◊◊X Y

ServicoNFe
◊◊Y c
.
◊◊c d"
NfeConsultaProtocolo
◊◊d x
,
◊◊x y
versao◊◊z Ä
,◊◊Ä Å
TipoAmbiente◊◊Ç é
.◊◊é è

taProducao◊◊è ô
,◊◊ô ö
emissao◊◊õ ¢
,◊◊¢ £
	EstadoNfe◊◊§ ≠
.◊◊≠ Æ
MG◊◊Æ ∞
,◊◊∞ ±
ModeloDocumento◊◊≤ ¡
.◊◊¡ ¬
NFe◊◊¬ ≈
,◊◊≈ ∆
$str◊◊« Å
)◊◊Å Ç
)◊◊Ç É
)◊◊É Ñ
;◊◊Ñ Ö

endServico
ÿÿ 
.
ÿÿ 
AddRange
ÿÿ #
(
ÿÿ# $
versaoDoisETres
ÿÿ$ 3
.
ÿÿ3 4
Select
ÿÿ4 :
(
ÿÿ: ;
versao
ÿÿ; A
=>
ÿÿB D
new
ÿÿE H
EnderecoServico
ÿÿI X
(
ÿÿX Y

ServicoNFe
ÿÿY c
.
ÿÿc d
NfeStatusServico
ÿÿd t
,
ÿÿt u
versao
ÿÿv |
,
ÿÿ| }
TipoAmbienteÿÿ~ ä
.ÿÿä ã

taProducaoÿÿã ï
,ÿÿï ñ
emissaoÿÿó û
,ÿÿû ü
	EstadoNfeÿÿ† ©
.ÿÿ© ™
MGÿÿ™ ¨
,ÿÿ¨ ≠
ModeloDocumentoÿÿÆ Ω
.ÿÿΩ æ
NFeÿÿæ ¡
,ÿÿ¡ ¬
$strÿÿ√ ˚
)ÿÿ˚ ¸
)ÿÿ¸ ˝
)ÿÿ˝ ˛
;ÿÿ˛ ˇ

endServico
ŸŸ 
.
ŸŸ 
Add
ŸŸ 
(
ŸŸ 
new
ŸŸ "
EnderecoServico
ŸŸ# 2
(
ŸŸ2 3

ServicoNFe
ŸŸ3 =
.
ŸŸ= >
NFeAutorizacao
ŸŸ> L
,
ŸŸL M
VersaoServico
ŸŸN [
.
ŸŸ[ \
ve310
ŸŸ\ a
,
ŸŸa b
TipoAmbiente
ŸŸc o
.
ŸŸo p

taProducao
ŸŸp z
,
ŸŸz {
emissaoŸŸ| É
,ŸŸÉ Ñ
	EstadoNfeŸŸÖ é
.ŸŸé è
MGŸŸè ë
,ŸŸë í
ModeloDocumentoŸŸì ¢
.ŸŸ¢ £
NFeŸŸ£ ¶
,ŸŸ¶ ß
$strŸŸ® ‰
)ŸŸ‰ Â
)ŸŸÂ Ê
;ŸŸÊ Á

endServico
⁄⁄ 
.
⁄⁄ 
Add
⁄⁄ 
(
⁄⁄ 
new
⁄⁄ "
EnderecoServico
⁄⁄# 2
(
⁄⁄2 3

ServicoNFe
⁄⁄3 =
.
⁄⁄= >
NFeRetAutorizacao
⁄⁄> O
,
⁄⁄O P
VersaoServico
⁄⁄Q ^
.
⁄⁄^ _
ve310
⁄⁄_ d
,
⁄⁄d e
TipoAmbiente
⁄⁄f r
.
⁄⁄r s

taProducao
⁄⁄s }
,
⁄⁄} ~
emissao⁄⁄ Ü
,⁄⁄Ü á
	EstadoNfe⁄⁄à ë
.⁄⁄ë í
MG⁄⁄í î
,⁄⁄î ï
ModeloDocumento⁄⁄ñ •
.⁄⁄• ¶
NFe⁄⁄¶ ©
,⁄⁄© ™
$str⁄⁄´ Í
)⁄⁄Í Î
)⁄⁄Î Ï
;⁄⁄Ï Ì
}
€€ 
foreach
ÁÁ 
(
ÁÁ 
var
ÁÁ 
emissao
ÁÁ  
in
ÁÁ! #
emissaoComum
ÁÁ$ 0
)
ÁÁ0 1
{
ËË 
if
ÈÈ 
(
ÈÈ 
emissao
ÈÈ 
!=
ÈÈ 
TipoEmissao
ÈÈ *
.
ÈÈ* +
teEPEC
ÈÈ+ 1
)
ÈÈ1 2

endServico
ÍÍ 
.
ÍÍ 
AddRange
ÍÍ '
(
ÍÍ' (
eventoCceCanc
ÍÍ( 5
.
ÍÍ5 6
Select
ÍÍ6 <
(
ÍÍ< =

servicoNFe
ÍÍ= G
=>
ÍÍH J
new
ÍÍK N
EnderecoServico
ÍÍO ^
(
ÍÍ^ _

servicoNFe
ÍÍ_ i
,
ÍÍi j
VersaoServico
ÍÍk x
.
ÍÍx y
ve100
ÍÍy ~
,
ÍÍ~ 
TipoAmbienteÍÍÄ å
.ÍÍå ç
taHomologacaoÍÍç ö
,ÍÍö õ
emissaoÍÍú £
,ÍÍ£ §
	EstadoNfeÍÍ• Æ
.ÍÍÆ Ø
MSÍÍØ ±
,ÍÍ± ≤
ModeloDocumentoÍÍ≥ ¬
.ÍÍ¬ √
NFeÍÍ√ ∆
,ÍÍ∆ «
$strÍÍ» ê
)ÍÍê ë
)ÍÍë í
)ÍÍí ì
;ÍÍì î

endServico
ÎÎ 
.
ÎÎ 
Add
ÎÎ 
(
ÎÎ 
new
ÎÎ "
EnderecoServico
ÎÎ# 2
(
ÎÎ2 3

ServicoNFe
ÎÎ3 =
.
ÎÎ= >
NfeRecepcao
ÎÎ> I
,
ÎÎI J
VersaoServico
ÎÎK X
.
ÎÎX Y
ve200
ÎÎY ^
,
ÎÎ^ _
TipoAmbiente
ÎÎ` l
.
ÎÎl m
taHomologacao
ÎÎm z
,
ÎÎz {
emissaoÎÎ| É
,ÎÎÉ Ñ
	EstadoNfeÎÎÖ é
.ÎÎé è
MSÎÎè ë
,ÎÎë í
ModeloDocumentoÎÎì ¢
.ÎÎ¢ £
NFeÎÎ£ ¶
,ÎÎ¶ ß
$strÎÎ® Ó
)ÎÎÓ Ô
)ÎÎÔ 
;ÎÎ Ò

endServico
ÏÏ 
.
ÏÏ 
Add
ÏÏ 
(
ÏÏ 
new
ÏÏ "
EnderecoServico
ÏÏ# 2
(
ÏÏ2 3

ServicoNFe
ÏÏ3 =
.
ÏÏ= >
NfeRetRecepcao
ÏÏ> L
,
ÏÏL M
VersaoServico
ÏÏN [
.
ÏÏ[ \
ve200
ÏÏ\ a
,
ÏÏa b
TipoAmbiente
ÏÏc o
.
ÏÏo p
taHomologacao
ÏÏp }
,
ÏÏ} ~
emissaoÏÏ Ü
,ÏÏÜ á
	EstadoNfeÏÏà ë
.ÏÏë í
MSÏÏí î
,ÏÏî ï
ModeloDocumentoÏÏñ •
.ÏÏ• ¶
NFeÏÏ¶ ©
,ÏÏ© ™
$strÏÏ´ Ù
)ÏÏÙ ı
)ÏÏı ˆ
;ÏÏˆ ˜

endServico
ÌÌ 
.
ÌÌ 
Add
ÌÌ 
(
ÌÌ 
new
ÌÌ "
EnderecoServico
ÌÌ# 2
(
ÌÌ2 3

ServicoNFe
ÌÌ3 =
.
ÌÌ= >!
NfeConsultaCadastro
ÌÌ> Q
,
ÌÌQ R
VersaoServico
ÌÌS `
.
ÌÌ` a
ve200
ÌÌa f
,
ÌÌf g
TipoAmbiente
ÌÌh t
.
ÌÌt u
taHomologacaoÌÌu Ç
,ÌÌÇ É
emissaoÌÌÑ ã
,ÌÌã å
	EstadoNfeÌÌç ñ
.ÌÌñ ó
MSÌÌó ô
,ÌÌô ö
ModeloDocumentoÌÌõ ™
.ÌÌ™ ´
NFeÌÌ´ Æ
,ÌÌÆ Ø
$strÌÌ∞ ˛
)ÌÌ˛ ˇ
)ÌÌˇ Ä
;ÌÌÄ Å

endServico
ÓÓ 
.
ÓÓ 
AddRange
ÓÓ #
(
ÓÓ# $
versaoDoisETres
ÓÓ$ 3
.
ÓÓ3 4
Select
ÓÓ4 :
(
ÓÓ: ;
versao
ÓÓ; A
=>
ÓÓB D
new
ÓÓE H
EnderecoServico
ÓÓI X
(
ÓÓX Y

ServicoNFe
ÓÓY c
.
ÓÓc d
NfeInutilizacao
ÓÓd s
,
ÓÓs t
versao
ÓÓu {
,
ÓÓ{ |
TipoAmbienteÓÓ} â
.ÓÓâ ä
taHomologacaoÓÓä ó
,ÓÓó ò
emissaoÓÓô †
,ÓÓ† °
	EstadoNfeÓÓ¢ ´
.ÓÓ´ ¨
MSÓÓ¨ Æ
,ÓÓÆ Ø
ModeloDocumentoÓÓ∞ ø
.ÓÓø ¿
NFeÓÓ¿ √
,ÓÓ√ ƒ
$strÓÓ≈ è
)ÓÓè ê
)ÓÓê ë
)ÓÓë í
;ÓÓí ì

endServico
ÔÔ 
.
ÔÔ 
AddRange
ÔÔ #
(
ÔÔ# $
versaoDoisETres
 #
.
# $
Select
$ *
(
* +
versao
+ 1
=>
2 4
new
5 8
EnderecoServico
9 H
(
H I

ServicoNFe
I S
.
S T"
NfeConsultaProtocolo
T h
,
h i
versao
j p
,
p q
TipoAmbiente
r ~
.
~ 
taHomologacao å
,å ç
emissaoé ï
,ï ñ
	EstadoNfeó †
.† °
MS° £
,£ §
ModeloDocumento• ¥
.¥ µ
NFeµ ∏
,∏ π
$str∫ Ä
)Ä Å
)Å Ç
)Ç É
;É Ñ

endServico
ÒÒ 
.
ÒÒ 
AddRange
ÒÒ #
(
ÒÒ# $
versaoDoisETres
ÚÚ #
.
ÚÚ# $
Select
ÚÚ$ *
(
ÚÚ* +
versao
ÚÚ+ 1
=>
ÚÚ2 4
new
ÚÚ5 8
EnderecoServico
ÚÚ9 H
(
ÚÚH I

ServicoNFe
ÚÚI S
.
ÚÚS T
NfeStatusServico
ÚÚT d
,
ÚÚd e
versao
ÚÚf l
,
ÚÚl m
TipoAmbiente
ÚÚn z
.
ÚÚz {
taHomologacaoÚÚ{ à
,ÚÚà â
emissaoÚÚä ë
,ÚÚë í
	EstadoNfeÚÚì ú
.ÚÚú ù
MSÚÚù ü
,ÚÚü †
ModeloDocumentoÚÚ° ∞
.ÚÚ∞ ±
NFeÚÚ± ¥
,ÚÚ¥ µ
$strÚÚ∂ Å
)ÚÚÅ Ç
)ÚÚÇ É
)ÚÚÉ Ñ
;ÚÚÑ Ö

endServico
ÛÛ 
.
ÛÛ 
Add
ÛÛ 
(
ÛÛ 
new
ÛÛ "
EnderecoServico
ÛÛ# 2
(
ÛÛ2 3

ServicoNFe
ÛÛ3 =
.
ÛÛ= >
NFeAutorizacao
ÛÛ> L
,
ÛÛL M
VersaoServico
ÛÛN [
.
ÛÛ[ \
ve310
ÛÛ\ a
,
ÛÛa b
TipoAmbiente
ÛÛc o
.
ÛÛo p
taHomologacao
ÛÛp }
,
ÛÛ} ~
emissaoÛÛ Ü
,ÛÛÜ á
	EstadoNfeÛÛà ë
.ÛÛë í
MSÛÛí î
,ÛÛî ï
ModeloDocumentoÛÛñ •
.ÛÛ• ¶
NFeÛÛ¶ ©
,ÛÛ© ™
$strÛÛ´ Û
)ÛÛÛ Ù
)ÛÛÙ ı
;ÛÛı ˆ

endServico
ÙÙ 
.
ÙÙ 
Add
ÙÙ 
(
ÙÙ 
new
ÙÙ "
EnderecoServico
ÙÙ# 2
(
ÙÙ2 3

ServicoNFe
ÙÙ3 =
.
ÙÙ= >
NFeRetAutorizacao
ÙÙ> O
,
ÙÙO P
VersaoServico
ÙÙQ ^
.
ÙÙ^ _
ve310
ÙÙ_ d
,
ÙÙd e
TipoAmbiente
ÙÙf r
.
ÙÙr s
taHomologacaoÙÙs Ä
,ÙÙÄ Å
emissaoÙÙÇ â
,ÙÙâ ä
	EstadoNfeÙÙã î
.ÙÙî ï
MSÙÙï ó
,ÙÙó ò
ModeloDocumentoÙÙô ®
.ÙÙ® ©
NFeÙÙ© ¨
,ÙÙ¨ ≠
$strÙÙÆ ˘
)ÙÙ˘ ˙
)ÙÙ˙ ˚
;ÙÙ˚ ¸
}
ıı 
foreach
˚˚ 
(
˚˚ 
var
˚˚ 
emissao
˚˚  
in
˚˚! #
emissaoComum
˚˚$ 0
)
˚˚0 1
{
¸¸ 
if
˝˝ 
(
˝˝ 
emissao
˝˝ 
!=
˝˝ 
TipoEmissao
˝˝ *
.
˝˝* +
teEPEC
˝˝+ 1
)
˝˝1 2

endServico
˛˛ 
.
˛˛ 
AddRange
˛˛ '
(
˛˛' (
eventoCceCanc
˛˛( 5
.
˛˛5 6
Select
˛˛6 <
(
˛˛< =

servicoNFe
˛˛= G
=>
˛˛H J
new
˛˛K N
EnderecoServico
˛˛O ^
(
˛˛^ _

servicoNFe
˛˛_ i
,
˛˛i j
VersaoServico
˛˛k x
.
˛˛x y
ve100
˛˛y ~
,
˛˛~ 
TipoAmbiente˛˛Ä å
.˛˛å ç

taProducao˛˛ç ó
,˛˛ó ò
emissao˛˛ô †
,˛˛† °
	EstadoNfe˛˛¢ ´
.˛˛´ ¨
MS˛˛¨ Æ
,˛˛Æ Ø
ModeloDocumento˛˛∞ ø
.˛˛ø ¿
NFe˛˛¿ √
,˛˛√ ƒ
$str˛˛≈ Ü
)˛˛Ü á
)˛˛á à
)˛˛à â
;˛˛â ä

endServico
ˇˇ 
.
ˇˇ 
Add
ˇˇ 
(
ˇˇ 
new
ˇˇ "
EnderecoServico
ˇˇ# 2
(
ˇˇ2 3

ServicoNFe
ˇˇ3 =
.
ˇˇ= >
NfeRecepcao
ˇˇ> I
,
ˇˇI J
VersaoServico
ˇˇK X
.
ˇˇX Y
ve200
ˇˇY ^
,
ˇˇ^ _
TipoAmbiente
ˇˇ` l
.
ˇˇl m

taProducao
ˇˇm w
,
ˇˇw x
emissaoˇˇy Ä
,ˇˇÄ Å
	EstadoNfeˇˇÇ ã
.ˇˇã å
MSˇˇå é
,ˇˇé è
ModeloDocumentoˇˇê ü
.ˇˇü †
NFeˇˇ† £
,ˇˇ£ §
$strˇˇ• ‰
)ˇˇ‰ Â
)ˇˇÂ Ê
;ˇˇÊ Á

endServico
ÄÄ 
.
ÄÄ 
Add
ÄÄ 
(
ÄÄ 
new
ÄÄ "
EnderecoServico
ÄÄ# 2
(
ÄÄ2 3

ServicoNFe
ÄÄ3 =
.
ÄÄ= >
NfeRetRecepcao
ÄÄ> L
,
ÄÄL M
VersaoServico
ÄÄN [
.
ÄÄ[ \
ve200
ÄÄ\ a
,
ÄÄa b
TipoAmbiente
ÄÄc o
.
ÄÄo p

taProducao
ÄÄp z
,
ÄÄz {
emissaoÄÄ| É
,ÄÄÉ Ñ
	EstadoNfeÄÄÖ é
.ÄÄé è
MSÄÄè ë
,ÄÄë í
ModeloDocumentoÄÄì ¢
.ÄÄ¢ £
NFeÄÄ£ ¶
,ÄÄ¶ ß
$strÄÄ® Í
)ÄÄÍ Î
)ÄÄÎ Ï
;ÄÄÏ Ì

endServico
ÅÅ 
.
ÅÅ 
Add
ÅÅ 
(
ÅÅ 
new
ÅÅ "
EnderecoServico
ÅÅ# 2
(
ÅÅ2 3

ServicoNFe
ÅÅ3 =
.
ÅÅ= >!
NfeConsultaCadastro
ÅÅ> Q
,
ÅÅQ R
VersaoServico
ÅÅS `
.
ÅÅ` a
ve200
ÅÅa f
,
ÅÅf g
TipoAmbiente
ÅÅh t
.
ÅÅt u

taProducao
ÅÅu 
,ÅÅ Ä
emissaoÅÅÅ à
,ÅÅà â
	EstadoNfeÅÅä ì
.ÅÅì î
MSÅÅî ñ
,ÅÅñ ó
ModeloDocumentoÅÅò ß
.ÅÅß ®
NFeÅÅ® ´
,ÅÅ´ ¨
$strÅÅ≠ Ù
)ÅÅÙ ı
)ÅÅı ˆ
;ÅÅˆ ˜

endServico
ÇÇ 
.
ÇÇ 
AddRange
ÇÇ #
(
ÇÇ# $
versaoDoisETres
ÇÇ$ 3
.
ÇÇ3 4
Select
ÇÇ4 :
(
ÇÇ: ;
versao
ÇÇ; A
=>
ÇÇB D
new
ÇÇE H
EnderecoServico
ÇÇI X
(
ÇÇX Y

ServicoNFe
ÇÇY c
.
ÇÇc d
NfeInutilizacao
ÇÇd s
,
ÇÇs t
versao
ÇÇu {
,
ÇÇ{ |
TipoAmbienteÇÇ} â
.ÇÇâ ä

taProducaoÇÇä î
,ÇÇî ï
emissaoÇÇñ ù
,ÇÇù û
	EstadoNfeÇÇü ®
.ÇÇ® ©
MSÇÇ© ´
,ÇÇ´ ¨
ModeloDocumentoÇÇ≠ º
.ÇÇº Ω
NFeÇÇΩ ¿
,ÇÇ¿ ¡
$strÇÇ¬ Ö
)ÇÇÖ Ü
)ÇÇÜ á
)ÇÇá à
;ÇÇà â

endServico
ÉÉ 
.
ÉÉ 
AddRange
ÉÉ #
(
ÉÉ# $
versaoDoisETres
ÉÉ$ 3
.
ÉÉ3 4
Select
ÉÉ4 :
(
ÉÉ: ;
versao
ÉÉ; A
=>
ÉÉB D
new
ÉÉE H
EnderecoServico
ÉÉI X
(
ÉÉX Y

ServicoNFe
ÉÉY c
.
ÉÉc d"
NfeConsultaProtocolo
ÉÉd x
,
ÉÉx y
versaoÉÉz Ä
,ÉÉÄ Å
TipoAmbienteÉÉÇ é
.ÉÉé è

taProducaoÉÉè ô
,ÉÉô ö
emissaoÉÉõ ¢
,ÉÉ¢ £
	EstadoNfeÉÉ§ ≠
.ÉÉ≠ Æ
MSÉÉÆ ∞
,ÉÉ∞ ±
ModeloDocumentoÉÉ≤ ¡
.ÉÉ¡ ¬
NFeÉÉ¬ ≈
,ÉÉ≈ ∆
$strÉÉ« Ü
)ÉÉÜ á
)ÉÉá à
)ÉÉà â
;ÉÉâ ä

endServico
ÑÑ 
.
ÑÑ 
AddRange
ÑÑ #
(
ÑÑ# $
versaoDoisETres
ÑÑ$ 3
.
ÑÑ3 4
Select
ÑÑ4 :
(
ÑÑ: ;
versao
ÑÑ; A
=>
ÑÑB D
new
ÑÑE H
EnderecoServico
ÑÑI X
(
ÑÑX Y

ServicoNFe
ÑÑY c
.
ÑÑc d
NfeStatusServico
ÑÑd t
,
ÑÑt u
versao
ÑÑv |
,
ÑÑ| }
TipoAmbienteÑÑ~ ä
.ÑÑä ã

taProducaoÑÑã ï
,ÑÑï ñ
emissaoÑÑó û
,ÑÑû ü
	EstadoNfeÑÑ† ©
.ÑÑ© ™
MSÑÑ™ ¨
,ÑÑ¨ ≠
ModeloDocumentoÑÑÆ Ω
.ÑÑΩ æ
NFeÑÑæ ¡
,ÑÑ¡ ¬
$strÑÑ√ á
)ÑÑá à
)ÑÑà â
)ÑÑâ ä
;ÑÑä ã

endServico
ÖÖ 
.
ÖÖ 
Add
ÖÖ 
(
ÖÖ 
new
ÖÖ "
EnderecoServico
ÖÖ# 2
(
ÖÖ2 3

ServicoNFe
ÖÖ3 =
.
ÖÖ= >
NFeAutorizacao
ÖÖ> L
,
ÖÖL M
VersaoServico
ÖÖN [
.
ÖÖ[ \
ve310
ÖÖ\ a
,
ÖÖa b
TipoAmbiente
ÖÖc o
.
ÖÖo p

taProducao
ÖÖp z
,
ÖÖz {
emissaoÖÖ| É
,ÖÖÉ Ñ
	EstadoNfeÖÖÖ é
.ÖÖé è
MSÖÖè ë
,ÖÖë í
ModeloDocumentoÖÖì ¢
.ÖÖ¢ £
NFeÖÖ£ ¶
,ÖÖ¶ ß
$strÖÖ® È
)ÖÖÈ Í
)ÖÖÍ Î
;ÖÖÎ Ï

endServico
ÜÜ 
.
ÜÜ 
Add
ÜÜ 
(
ÜÜ 
new
ÜÜ "
EnderecoServico
ÜÜ# 2
(
ÜÜ2 3

ServicoNFe
ÜÜ3 =
.
ÜÜ= >
NFeRetAutorizacao
ÜÜ> O
,
ÜÜO P
VersaoServico
ÜÜQ ^
.
ÜÜ^ _
ve310
ÜÜ_ d
,
ÜÜd e
TipoAmbiente
ÜÜf r
.
ÜÜr s

taProducao
ÜÜs }
,
ÜÜ} ~
emissaoÜÜ Ü
,ÜÜÜ á
	EstadoNfeÜÜà ë
.ÜÜë í
MSÜÜí î
,ÜÜî ï
ModeloDocumentoÜÜñ •
.ÜÜ• ¶
NFeÜÜ¶ ©
,ÜÜ© ™
$strÜÜ´ Ô
)ÜÜÔ 
)ÜÜ Ò
;ÜÜÒ Ú
}
áá 
foreach
ìì 
(
ìì 
var
ìì 
emissao
ìì  
in
ìì! #
emissaoComum
ìì$ 0
)
ìì0 1
{
îî 

endServico
óó 
.
óó 
Add
óó 
(
óó 
new
óó "
EnderecoServico
óó# 2
(
óó2 3

ServicoNFe
óó3 =
.
óó= >
NfeRecepcao
óó> I
,
óóI J
VersaoServico
óóK X
.
óóX Y
ve200
óóY ^
,
óó^ _
TipoAmbiente
óó` l
.
óól m
taHomologacao
óóm z
,
óóz {
emissaoóó| É
,óóÉ Ñ
	EstadoNfeóóÖ é
.óóé è
MTóóè ë
,óóë í
ModeloDocumentoóóì ¢
.óó¢ £
NFeóó£ ¶
,óó¶ ß
$stróó® Ò
)óóÒ Ú
)óóÚ Û
;óóÛ Ù

endServico
òò 
.
òò 
Add
òò 
(
òò 
new
òò "
EnderecoServico
òò# 2
(
òò2 3

ServicoNFe
òò3 =
.
òò= >
NfeRetRecepcao
òò> L
,
òòL M
VersaoServico
òòN [
.
òò[ \
ve200
òò\ a
,
òòa b
TipoAmbiente
òòc o
.
òòo p
taHomologacao
òòp }
,
òò} ~
emissaoòò Ü
,òòÜ á
	EstadoNfeòòà ë
.òòë í
MTòòí î
,òòî ï
ModeloDocumentoòòñ •
.òò• ¶
NFeòò¶ ©
,òò© ™
$stròò´ ˜
)òò˜ ¯
)òò¯ ˘
;òò˘ ˙

endServico
ôô 
.
ôô 
Add
ôô 
(
ôô 
new
ôô "
EnderecoServico
ôô# 2
(
ôô2 3

ServicoNFe
ôô3 =
.
ôô= >
NfeInutilizacao
ôô> M
,
ôôM N
VersaoServico
ôôO \
.
ôô\ ]
ve200
ôô] b
,
ôôb c
TipoAmbiente
ôôd p
.
ôôp q
taHomologacao
ôôq ~
,
ôô~ 
emissaoôôÄ á
,ôôá à
	EstadoNfeôôâ í
.ôôí ì
MTôôì ï
,ôôï ñ
ModeloDocumentoôôó ¶
.ôô¶ ß
NFeôôß ™
,ôô™ ´
$strôô¨ ˘
)ôô˘ ˙
)ôô˙ ˚
;ôô˚ ¸

endServico
öö 
.
öö 
Add
öö 
(
öö 
new
öö "
EnderecoServico
öö# 2
(
öö2 3

ServicoNFe
öö3 =
.
öö= >"
NfeConsultaProtocolo
öö> R
,
ööR S
VersaoServico
ööT a
.
ööa b
ve200
ööb g
,
öög h
TipoAmbiente
ööi u
.
ööu v
taHomologacaoööv É
,ööÉ Ñ
emissaoööÖ å
,ööå ç
	EstadoNfeööé ó
.ööó ò
MTööò ö
,ööö õ
ModeloDocumentoööú ´
.öö´ ¨
NFeöö¨ Ø
,ööØ ∞
$ströö± ˙
)öö˙ ˚
)öö˚ ¸
;öö¸ ˝

endServico
õõ 
.
õõ 
Add
õõ 
(
õõ 
new
õõ "
EnderecoServico
õõ# 2
(
õõ2 3

ServicoNFe
õõ3 =
.
õõ= >
NfeStatusServico
õõ> N
,
õõN O
VersaoServico
õõP ]
.
õõ] ^
ve200
õõ^ c
,
õõc d
TipoAmbiente
õõe q
.
õõq r
taHomologacao
õõr 
,õõ Ä
emissaoõõÅ à
,õõà â
	EstadoNfeõõä ì
.õõì î
MTõõî ñ
,õõñ ó
ModeloDocumentoõõò ß
.õõß ®
NFeõõ® ´
,õõ´ ¨
$strõõ≠ ˚
)õõ˚ ¸
)õõ¸ ˝
;õõ˝ ˛
if
úú 
(
úú 
emissao
úú 
!=
úú 
TipoEmissao
úú *
.
úú* +
teEPEC
úú+ 1
)
úú1 2

endServico
ùù 
.
ùù 
AddRange
ùù '
(
ùù' (
eventoCceCanc
ùù( 5
.
ùù5 6
Select
ùù6 <
(
ùù< =

servicoNFe
ùù= G
=>
ùùH J
new
ùùK N
EnderecoServico
ùùO ^
(
ùù^ _

servicoNFe
ùù_ i
,
ùùi j
VersaoServico
ùùk x
.
ùùx y
ve200
ùùy ~
,
ùù~ 
TipoAmbienteùùÄ å
.ùùå ç
taHomologacaoùùç ö
,ùùö õ
emissaoùùú £
,ùù£ §
	EstadoNfeùù• Æ
.ùùÆ Ø
MTùùØ ±
,ùù± ≤
ModeloDocumentoùù≥ ¬
.ùù¬ √
NFeùù√ ∆
,ùù∆ «
$strùù» ì
)ùùì î
)ùùî ï
)ùùï ñ
;ùùñ ó

endServico
ûû 
.
ûû 
Add
ûû 
(
ûû 
new
ûû "
EnderecoServico
ûû# 2
(
ûû2 3

ServicoNFe
ûû3 =
.
ûû= >!
NfeConsultaCadastro
ûû> Q
,
ûûQ R
VersaoServico
ûûS `
.
ûû` a
ve310
ûûa f
,
ûûf g
TipoAmbiente
ûûh t
.
ûût u
taHomologacaoûûu Ç
,ûûÇ É
emissaoûûÑ ã
,ûûã å
	EstadoNfeûûç ñ
.ûûñ ó
MTûûó ô
,ûûô ö
ModeloDocumentoûûõ ™
.ûû™ ´
NFeûû´ Æ
,ûûÆ Ø
$strûû∞ Å
)ûûÅ Ç
)ûûÇ É
;ûûÉ Ñ

endServico
üü 
.
üü 
Add
üü 
(
üü 
new
üü "
EnderecoServico
üü# 2
(
üü2 3

ServicoNFe
üü3 =
.
üü= >
NFeAutorizacao
üü> L
,
üüL M
VersaoServico
üüN [
.
üü[ \
ve310
üü\ a
,
üüa b
TipoAmbiente
üüc o
.
üüo p
taHomologacao
üüp }
,
üü} ~
emissaoüü Ü
,üüÜ á
	EstadoNfeüüà ë
.üüë í
MTüüí î
,üüî ï
ModeloDocumentoüüñ •
.üü• ¶
NFeüü¶ ©
,üü© ™
$strüü´ ˆ
)üüˆ ˜
)üü˜ ¯
;üü¯ ˘

endServico
†† 
.
†† 
Add
†† 
(
†† 
new
†† "
EnderecoServico
††# 2
(
††2 3

ServicoNFe
††3 =
.
††= >
NFeRetAutorizacao
††> O
,
††O P
VersaoServico
††Q ^
.
††^ _
ve310
††_ d
,
††d e
TipoAmbiente
††f r
.
††r s
taHomologacao††s Ä
,††Ä Å
emissao††Ç â
,††â ä
	EstadoNfe††ã î
.††î ï
MT††ï ó
,††ó ò
ModeloDocumento††ô ®
.††® ©
NFe††© ¨
,††¨ ≠
$str††Æ ¸
)††¸ ˝
)††˝ ˛
;††˛ ˇ

endServico
¶¶ 
.
¶¶ 
Add
¶¶ 
(
¶¶ 
new
¶¶ "
EnderecoServico
¶¶# 2
(
¶¶2 3

ServicoNFe
¶¶3 =
.
¶¶= >
NFeAutorizacao
¶¶> L
,
¶¶L M
VersaoServico
¶¶N [
.
¶¶[ \
ve310
¶¶\ a
,
¶¶a b
TipoAmbiente
¶¶c o
.
¶¶o p
taHomologacao
¶¶p }
,
¶¶} ~
emissao¶¶ Ü
,¶¶Ü á
	EstadoNfe¶¶à ë
.¶¶ë í
MT¶¶í î
,¶¶î ï
ModeloDocumento¶¶ñ •
.¶¶• ¶
NFCe¶¶¶ ™
,¶¶™ ´
$str¶¶¨ ı
)¶¶ı ˆ
)¶¶ˆ ˜
;¶¶˜ ¯

endServico
ßß 
.
ßß 
Add
ßß 
(
ßß 
new
ßß "
EnderecoServico
ßß# 2
(
ßß2 3

ServicoNFe
ßß3 =
.
ßß= >
NFeRetAutorizacao
ßß> O
,
ßßO P
VersaoServico
ßßQ ^
.
ßß^ _
ve310
ßß_ d
,
ßßd e
TipoAmbiente
ßßf r
.
ßßr s
taHomologacaoßßs Ä
,ßßÄ Å
emissaoßßÇ â
,ßßâ ä
	EstadoNfeßßã î
.ßßî ï
MTßßï ó
,ßßó ò
ModeloDocumentoßßô ®
.ßß® ©
NFCeßß© ≠
,ßß≠ Æ
$strßßØ ˚
)ßß˚ ¸
)ßß¸ ˝
;ßß˝ ˛

endServico
®® 
.
®® 
Add
®® 
(
®® 
new
®® "
EnderecoServico
®®# 2
(
®®2 3

ServicoNFe
®®3 =
.
®®= >
NfeInutilizacao
®®> M
,
®®M N
VersaoServico
®®O \
.
®®\ ]
ve310
®®] b
,
®®b c
TipoAmbiente
®®d p
.
®®p q
taHomologacao
®®q ~
,
®®~ 
emissao®®Ä á
,®®á à
	EstadoNfe®®â í
.®®í ì
MT®®ì ï
,®®ï ñ
ModeloDocumento®®ó ¶
.®®¶ ß
NFCe®®ß ´
,®®´ ¨
$str®®≠ ¯
)®®¯ ˘
)®®˘ ˙
;®®˙ ˚

endServico
©© 
.
©© 
Add
©© 
(
©© 
new
©© "
EnderecoServico
©©# 2
(
©©2 3

ServicoNFe
©©3 =
.
©©= >'
RecepcaoEventoCancelmento
©©> W
,
©©W X
VersaoServico
©©Y f
.
©©f g
ve100
©©g l
,
©©l m
TipoAmbiente
©©n z
.
©©z {
taHomologacao©©{ à
,©©à â
emissao©©ä ë
,©©ë í
	EstadoNfe©©ì ú
.©©ú ù
MT©©ù ü
,©©ü †
ModeloDocumento©©° ∞
.©©∞ ±
NFCe©©± µ
,©©µ ∂
$str©©∑ Ä
)©©Ä Å
)©©Å Ç
;©©Ç É

endServico
™™ 
.
™™ 
Add
™™ 
(
™™ 
new
™™ "
EnderecoServico
™™# 2
(
™™2 3

ServicoNFe
™™3 =
.
™™= >
NfeStatusServico
™™> N
,
™™N O
VersaoServico
™™P ]
.
™™] ^
ve310
™™^ c
,
™™c d
TipoAmbiente
™™e q
.
™™q r
taHomologacao
™™r 
,™™ Ä
emissao™™Å à
,™™à â
	EstadoNfe™™ä ì
.™™ì î
MT™™î ñ
,™™ñ ó
ModeloDocumento™™ò ß
.™™ß ®
NFCe™™® ¨
,™™¨ ≠
$str™™Æ ˙
)™™˙ ˚
)™™˚ ¸
;™™¸ ˝

endServico
´´ 
.
´´ 
Add
´´ 
(
´´ 
new
´´ "
EnderecoServico
´´# 2
(
´´2 3

ServicoNFe
´´3 =
.
´´= >"
NfeConsultaProtocolo
´´> R
,
´´R S
VersaoServico
´´T a
.
´´a b
ve310
´´b g
,
´´g h
TipoAmbiente
´´i u
.
´´u v
taHomologacao´´v É
,´´É Ñ
emissao´´Ö å
,´´å ç
	EstadoNfe´´é ó
.´´ó ò
MT´´ò ö
,´´ö õ
ModeloDocumento´´ú ´
.´´´ ¨
NFCe´´¨ ∞
,´´∞ ±
$str´´≤ ˘
)´´˘ ˙
)´´˙ ˚
;´´˚ ¸
}
ÆÆ 
foreach
¥¥ 
(
¥¥ 
var
¥¥ 
emissao
¥¥  
in
¥¥! #
emissaoComum
¥¥$ 0
)
¥¥0 1
{
µµ 

endServico
∏∏ 
.
∏∏ 
Add
∏∏ 
(
∏∏ 
new
∏∏ "
EnderecoServico
∏∏# 2
(
∏∏2 3

ServicoNFe
∏∏3 =
.
∏∏= >
NfeRecepcao
∏∏> I
,
∏∏I J
VersaoServico
∏∏K X
.
∏∏X Y
ve200
∏∏Y ^
,
∏∏^ _
TipoAmbiente
∏∏` l
.
∏∏l m

taProducao
∏∏m w
,
∏∏w x
emissao∏∏y Ä
,∏∏Ä Å
	EstadoNfe∏∏Ç ã
.∏∏ã å
MT∏∏å é
,∏∏é è
ModeloDocumento∏∏ê ü
.∏∏ü †
NFe∏∏† £
,∏∏£ §
$str∏∏• Ê
)∏∏Ê Á
)∏∏Á Ë
;∏∏Ë È

endServico
ππ 
.
ππ 
Add
ππ 
(
ππ 
new
ππ "
EnderecoServico
ππ# 2
(
ππ2 3

ServicoNFe
ππ3 =
.
ππ= >
NfeRetRecepcao
ππ> L
,
ππL M
VersaoServico
ππN [
.
ππ[ \
ve200
ππ\ a
,
ππa b
TipoAmbiente
ππc o
.
ππo p

taProducao
ππp z
,
ππz {
emissaoππ| É
,ππÉ Ñ
	EstadoNfeππÖ é
.ππé è
MTππè ë
,ππë í
ModeloDocumentoππì ¢
.ππ¢ £
NFeππ£ ¶
,ππ¶ ß
$strππ® Ï
)ππÏ Ì
)ππÌ Ó
;ππÓ Ô

endServico
∫∫ 
.
∫∫ 
AddRange
∫∫ #
(
∫∫# $
versaoDoisETres
ªª #
.
ªª# $
Select
ªª$ *
(
ªª* +
versao
ªª+ 1
=>
ªª2 4
new
ªª5 8
EnderecoServico
ªª9 H
(
ªªH I

ServicoNFe
ªªI S
.
ªªS T
NfeInutilizacao
ªªT c
,
ªªc d
versao
ªªe k
,
ªªk l
TipoAmbiente
ªªm y
.
ªªy z

taProducaoªªz Ñ
,ªªÑ Ö
emissaoªªÜ ç
,ªªç é
	EstadoNfeªªè ò
.ªªò ô
MTªªô õ
,ªªõ ú
ModeloDocumentoªªù ¨
.ªª¨ ≠
NFeªª≠ ∞
,ªª∞ ±
$strªª≤ ˜
)ªª˜ ¯
)ªª¯ ˘
)ªª˘ ˙
;ªª˙ ˚

endServico
ºº 
.
ºº 
AddRange
ºº #
(
ºº# $
versaoDoisETres
ΩΩ #
.
ΩΩ# $
Select
ΩΩ$ *
(
ΩΩ* +
versao
ΩΩ+ 1
=>
ΩΩ2 4
new
ΩΩ5 8
EnderecoServico
ΩΩ9 H
(
ΩΩH I

ServicoNFe
ΩΩI S
.
ΩΩS T"
NfeConsultaProtocolo
ΩΩT h
,
ΩΩh i
versao
ΩΩj p
,
ΩΩp q
TipoAmbiente
ΩΩr ~
.
ΩΩ~ 

taProducaoΩΩ â
,ΩΩâ ä
emissaoΩΩã í
,ΩΩí ì
	EstadoNfeΩΩî ù
.ΩΩù û
MTΩΩû †
,ΩΩ† °
ModeloDocumentoΩΩ¢ ±
.ΩΩ± ≤
NFeΩΩ≤ µ
,ΩΩµ ∂
$strΩΩ∑ ¯
)ΩΩ¯ ˘
)ΩΩ˘ ˙
)ΩΩ˙ ˚
;ΩΩ˚ ¸

endServico
ææ 
.
ææ 
AddRange
ææ #
(
ææ# $
versaoDoisETres
øø #
.
øø# $
Select
øø$ *
(
øø* +
versao
øø+ 1
=>
øø2 4
new
øø5 8
EnderecoServico
øø9 H
(
øøH I

ServicoNFe
øøI S
.
øøS T
NfeStatusServico
øøT d
,
øød e
versao
øøf l
,
øøl m
TipoAmbiente
øøn z
.
øøz {

taProducaoøø{ Ö
,øøÖ Ü
emissaoøøá é
,øøé è
	EstadoNfeøøê ô
.øøô ö
MTøøö ú
,øøú ù
ModeloDocumentoøøû ≠
.øø≠ Æ
NFeøøÆ ±
,øø± ≤
$strøø≥ ˘
)øø˘ ˙
)øø˙ ˚
)øø˚ ¸
;øø¸ ˝

endServico
¿¿ 
.
¿¿ 
AddRange
¿¿ #
(
¿¿# $
versaoDoisETres
¡¡ #
.
¡¡# $
Select
¡¡$ *
(
¡¡* +
versao
¡¡+ 1
=>
¡¡2 4
new
¡¡5 8
EnderecoServico
¡¡9 H
(
¡¡H I

ServicoNFe
¡¡I S
.
¡¡S T!
NfeConsultaCadastro
¡¡T g
,
¡¡g h
versao
¡¡i o
,
¡¡o p
TipoAmbiente
¡¡q }
.
¡¡} ~

taProducao¡¡~ à
,¡¡à â
emissao¡¡ä ë
,¡¡ë í
	EstadoNfe¡¡ì ú
.¡¡ú ù
MT¡¡ù ü
,¡¡ü †
ModeloDocumento¡¡° ∞
.¡¡∞ ±
NFe¡¡± ¥
,¡¡¥ µ
$str¡¡∂ ˇ
)¡¡ˇ Ä
)¡¡Ä Å
)¡¡Å Ç
;¡¡Ç É
if
¬¬ 
(
¬¬ 
emissao
¬¬ 
!=
¬¬ 
TipoEmissao
¬¬ *
.
¬¬* +
teEPEC
¬¬+ 1
)
¬¬1 2
foreach
√√ 
(
√√ 
var
√√  

servicoNFe
√√! +
in
√√, .
eventoCceCanc
√√/ <
)
√√< =

endServico
ƒƒ "
.
ƒƒ" #
AddRange
ƒƒ# +
(
ƒƒ+ ,
versaoDoisETres
≈≈ +
.
≈≈+ ,
Select
≈≈, 2
(
≈≈2 3
versao
≈≈3 9
=>
≈≈: <
new
≈≈= @
EnderecoServico
≈≈A P
(
≈≈P Q

servicoNFe
≈≈Q [
,
≈≈[ \
versao
≈≈] c
,
≈≈c d
TipoAmbiente
≈≈e q
.
≈≈q r

taProducao
≈≈r |
,
≈≈| }
emissao≈≈~ Ö
,≈≈Ö Ü
	EstadoNfe≈≈á ê
.≈≈ê ë
MT≈≈ë ì
,≈≈ì î
ModeloDocumento≈≈ï §
.≈≈§ •
NFe≈≈• ®
,≈≈® ©
$str≈≈™ Ì
)≈≈Ì Ó
)≈≈Ó Ô
)≈≈Ô 
;≈≈ Ò

endServico
∆∆ 
.
∆∆ 
Add
∆∆ 
(
∆∆ 
new
∆∆ "
EnderecoServico
∆∆# 2
(
∆∆2 3

ServicoNFe
∆∆3 =
.
∆∆= >
NFeAutorizacao
∆∆> L
,
∆∆L M
VersaoServico
∆∆N [
.
∆∆[ \
ve310
∆∆\ a
,
∆∆a b
TipoAmbiente
∆∆c o
.
∆∆o p

taProducao
∆∆p z
,
∆∆z {
emissao∆∆| É
,∆∆É Ñ
	EstadoNfe∆∆Ö é
.∆∆é è
MT∆∆è ë
,∆∆ë í
ModeloDocumento∆∆ì ¢
.∆∆¢ £
NFe∆∆£ ¶
,∆∆¶ ß
$str∆∆® Î
)∆∆Î Ï
)∆∆Ï Ì
;∆∆Ì Ó

endServico
«« 
.
«« 
Add
«« 
(
«« 
new
«« "
EnderecoServico
««# 2
(
««2 3

ServicoNFe
««3 =
.
««= >
NFeRetAutorizacao
««> O
,
««O P
VersaoServico
««Q ^
.
««^ _
ve310
««_ d
,
««d e
TipoAmbiente
««f r
.
««r s

taProducao
««s }
,
««} ~
emissao«« Ü
,««Ü á
	EstadoNfe««à ë
.««ë í
MT««í î
,««î ï
ModeloDocumento««ñ •
.««• ¶
NFe««¶ ©
,««© ™
$str««´ Ò
)««Ò Ú
)««Ú Û
;««Û Ù

endServico
ÕÕ 
.
ÕÕ 
Add
ÕÕ 
(
ÕÕ 
new
ÕÕ "
EnderecoServico
ÕÕ# 2
(
ÕÕ2 3

ServicoNFe
ÕÕ3 =
.
ÕÕ= >
NFeAutorizacao
ÕÕ> L
,
ÕÕL M
VersaoServico
ÕÕN [
.
ÕÕ[ \
ve310
ÕÕ\ a
,
ÕÕa b
TipoAmbiente
ÕÕc o
.
ÕÕo p

taProducao
ÕÕp z
,
ÕÕz {
emissaoÕÕ| É
,ÕÕÉ Ñ
	EstadoNfeÕÕÖ é
.ÕÕé è
MTÕÕè ë
,ÕÕë í
ModeloDocumentoÕÕì ¢
.ÕÕ¢ £
NFCeÕÕ£ ß
,ÕÕß ®
$strÕÕ© Î
)ÕÕÎ Ï
)ÕÕÏ Ì
;ÕÕÌ Ó

endServico
ŒŒ 
.
ŒŒ 
Add
ŒŒ 
(
ŒŒ 
new
ŒŒ "
EnderecoServico
ŒŒ# 2
(
ŒŒ2 3

ServicoNFe
ŒŒ3 =
.
ŒŒ= >
NFeRetAutorizacao
ŒŒ> O
,
ŒŒO P
VersaoServico
ŒŒQ ^
.
ŒŒ^ _
ve310
ŒŒ_ d
,
ŒŒd e
TipoAmbiente
ŒŒf r
.
ŒŒr s

taProducao
ŒŒs }
,
ŒŒ} ~
emissaoŒŒ Ü
,ŒŒÜ á
	EstadoNfeŒŒà ë
.ŒŒë í
MTŒŒí î
,ŒŒî ï
ModeloDocumentoŒŒñ •
.ŒŒ• ¶
NFCeŒŒ¶ ™
,ŒŒ™ ´
$strŒŒ¨ Ò
)ŒŒÒ Ú
)ŒŒÚ Û
;ŒŒÛ Ù

endServico
œœ 
.
œœ 
Add
œœ 
(
œœ 
new
œœ "
EnderecoServico
œœ# 2
(
œœ2 3

ServicoNFe
œœ3 =
.
œœ= >
NfeInutilizacao
œœ> M
,
œœM N
VersaoServico
œœO \
.
œœ\ ]
ve310
œœ] b
,
œœb c
TipoAmbiente
œœd p
.
œœp q

taProducao
œœq {
,
œœ{ |
emissaoœœ} Ñ
,œœÑ Ö
	EstadoNfeœœÜ è
.œœè ê
MTœœê í
,œœí ì
ModeloDocumentoœœî £
.œœ£ §
NFCeœœ§ ®
,œœ® ©
$strœœ™ Ó
)œœÓ Ô
)œœÔ 
;œœ Ò

endServico
–– 
.
–– 
Add
–– 
(
–– 
new
–– "
EnderecoServico
––# 2
(
––2 3

ServicoNFe
––3 =
.
––= >'
RecepcaoEventoCancelmento
––> W
,
––W X
VersaoServico
––Y f
.
––f g
ve100
––g l
,
––l m
TipoAmbiente
––n z
.
––z {

taProducao––{ Ö
,––Ö Ü
emissao––á é
,––é è
	EstadoNfe––ê ô
.––ô ö
MT––ö ú
,––ú ù
ModeloDocumento––û ≠
.––≠ Æ
NFCe––Æ ≤
,––≤ ≥
$str––¥ ˆ
)––ˆ ˜
)––˜ ¯
;––¯ ˘

endServico
—— 
.
—— 
Add
—— 
(
—— 
new
—— "
EnderecoServico
——# 2
(
——2 3

ServicoNFe
——3 =
.
——= >
NfeStatusServico
——> N
,
——N O
VersaoServico
——P ]
.
——] ^
ve310
——^ c
,
——c d
TipoAmbiente
——e q
.
——q r

taProducao
——r |
,
——| }
emissao——~ Ö
,——Ö Ü
	EstadoNfe——á ê
.——ê ë
MT——ë ì
,——ì î
ModeloDocumento——ï §
.——§ •
NFCe——• ©
,——© ™
$str——´ 
)—— Ò
)——Ò Ú
;——Ú Û

endServico
““ 
.
““ 
Add
““ 
(
““ 
new
““ "
EnderecoServico
““# 2
(
““2 3

ServicoNFe
““3 =
.
““= >"
NfeConsultaProtocolo
““> R
,
““R S
VersaoServico
““T a
.
““a b
ve310
““b g
,
““g h
TipoAmbiente
““i u
.
““u v

taProducao““v Ä
,““Ä Å
emissao““Ç â
,““â ä
	EstadoNfe““ã î
.““î ï
MT““ï ó
,““ó ò
ModeloDocumento““ô ®
.““® ©
NFCe““© ≠
,““≠ Æ
$str““Ø Ô
)““Ô 
)““ Ò
;““Ò Ú
}
’’ 
foreach
ÌÌ 
(
ÌÌ 
var
ÌÌ 
emissao
ÌÌ  
in
ÌÌ! #
emissaoComum
ÌÌ$ 0
)
ÌÌ0 1
{
ÓÓ 
if
ÔÔ 
(
ÔÔ 
emissao
ÔÔ 
!=
ÔÔ 
TipoEmissao
ÔÔ *
.
ÔÔ* +
teEPEC
ÔÔ+ 1
)
ÔÔ1 2

endServico
 
.
 
AddRange
 '
(
' (
eventoCceCanc
( 5
.
5 6
Select
6 <
(
< =

servicoNFe
= G
=>
H J
new
K N
EnderecoServico
O ^
(
^ _

servicoNFe
_ i
,
i j
VersaoServico
k x
.
x y
ve100
y ~
,
~ 
TipoAmbienteÄ å
.å ç
taHomologacaoç ö
,ö õ
emissaoú £
,£ §
	EstadoNfe• Æ
.Æ Ø
PEØ ±
,± ≤
ModeloDocumento≥ ¬
.¬ √
NFe√ ∆
,∆ «
$str» ê
)ê ë
)ë í
)í ì
;ì î

endServico
ÒÒ 
.
ÒÒ 
Add
ÒÒ 
(
ÒÒ 
new
ÒÒ "
EnderecoServico
ÒÒ# 2
(
ÒÒ2 3

ServicoNFe
ÒÒ3 =
.
ÒÒ= >
NfeRecepcao
ÒÒ> I
,
ÒÒI J
VersaoServico
ÒÒK X
.
ÒÒX Y
ve200
ÒÒY ^
,
ÒÒ^ _
TipoAmbiente
ÒÒ` l
.
ÒÒl m
taHomologacao
ÒÒm z
,
ÒÒz {
emissaoÒÒ| É
,ÒÒÉ Ñ
	EstadoNfeÒÒÖ é
.ÒÒé è
PEÒÒè ë
,ÒÒë í
ModeloDocumentoÒÒì ¢
.ÒÒ¢ £
NFeÒÒ£ ¶
,ÒÒ¶ ß
$strÒÒ® Ó
)ÒÒÓ Ô
)ÒÒÔ 
;ÒÒ Ò

endServico
ÚÚ 
.
ÚÚ 
Add
ÚÚ 
(
ÚÚ 
new
ÚÚ "
EnderecoServico
ÚÚ# 2
(
ÚÚ2 3

ServicoNFe
ÚÚ3 =
.
ÚÚ= >
NfeRetRecepcao
ÚÚ> L
,
ÚÚL M
VersaoServico
ÚÚN [
.
ÚÚ[ \
ve200
ÚÚ\ a
,
ÚÚa b
TipoAmbiente
ÚÚc o
.
ÚÚo p
taHomologacao
ÚÚp }
,
ÚÚ} ~
emissaoÚÚ Ü
,ÚÚÜ á
	EstadoNfeÚÚà ë
.ÚÚë í
PEÚÚí î
,ÚÚî ï
ModeloDocumentoÚÚñ •
.ÚÚ• ¶
NFeÚÚ¶ ©
,ÚÚ© ™
$strÚÚ´ Ù
)ÚÚÙ ı
)ÚÚı ˆ
;ÚÚˆ ˜

endServico
ÛÛ 
.
ÛÛ 
AddRange
ÛÛ #
(
ÛÛ# $
versaoDoisETres
ÛÛ$ 3
.
ÛÛ3 4
Select
ÛÛ4 :
(
ÛÛ: ;
versao
ÛÛ; A
=>
ÛÛB D
new
ÛÛE H
EnderecoServico
ÛÛI X
(
ÛÛX Y

ServicoNFe
ÛÛY c
.
ÛÛc d
NfeInutilizacao
ÛÛd s
,
ÛÛs t
versao
ÛÛu {
,
ÛÛ{ |
TipoAmbienteÛÛ} â
.ÛÛâ ä
taHomologacaoÛÛä ó
,ÛÛó ò
emissaoÛÛô †
,ÛÛ† °
	EstadoNfeÛÛ¢ ´
.ÛÛ´ ¨
PEÛÛ¨ Æ
,ÛÛÆ Ø
ModeloDocumentoÛÛ∞ ø
.ÛÛø ¿
NFeÛÛ¿ √
,ÛÛ√ ƒ
$strÛÛ≈ è
)ÛÛè ê
)ÛÛê ë
)ÛÛë í
;ÛÛí ì

endServico
ÙÙ 
.
ÙÙ 
AddRange
ÙÙ #
(
ÙÙ# $
versaoDoisETres
ıı #
.
ıı# $
Select
ıı$ *
(
ıı* +
versao
ıı+ 1
=>
ıı2 4
new
ıı5 8
EnderecoServico
ıı9 H
(
ııH I

ServicoNFe
ııI S
.
ııS T"
NfeConsultaProtocolo
ııT h
,
ııh i
versao
ııj p
,
ııp q
TipoAmbiente
ıır ~
.
ıı~ 
taHomologacaoıı å
,ııå ç
emissaoııé ï
,ııï ñ
	EstadoNfeııó †
.ıı† °
PEıı° £
,ıı£ §
ModeloDocumentoıı• ¥
.ıı¥ µ
NFeııµ ∏
,ıı∏ π
$strıı∫ Ä
)ııÄ Å
)ııÅ Ç
)ııÇ É
;ııÉ Ñ

endServico
ˆˆ 
.
ˆˆ 
AddRange
ˆˆ #
(
ˆˆ# $
versaoDoisETres
˜˜ #
.
˜˜# $
Select
˜˜$ *
(
˜˜* +
versao
˜˜+ 1
=>
˜˜2 4
new
˜˜5 8
EnderecoServico
˜˜9 H
(
˜˜H I

ServicoNFe
˜˜I S
.
˜˜S T
NfeStatusServico
˜˜T d
,
˜˜d e
versao
˜˜f l
,
˜˜l m
TipoAmbiente
˜˜n z
.
˜˜z {
taHomologacao˜˜{ à
,˜˜à â
emissao˜˜ä ë
,˜˜ë í
	EstadoNfe˜˜ì ú
.˜˜ú ù
PE˜˜ù ü
,˜˜ü †
ModeloDocumento˜˜° ∞
.˜˜∞ ±
NFe˜˜± ¥
,˜˜¥ µ
$str˜˜∂ Å
)˜˜Å Ç
)˜˜Ç É
)˜˜É Ñ
;˜˜Ñ Ö

endServico
¯¯ 
.
¯¯ 
Add
¯¯ 
(
¯¯ 
new
¯¯ "
EnderecoServico
¯¯# 2
(
¯¯2 3

ServicoNFe
¯¯3 =
.
¯¯= >
NFeAutorizacao
¯¯> L
,
¯¯L M
VersaoServico
¯¯N [
.
¯¯[ \
ve310
¯¯\ a
,
¯¯a b
TipoAmbiente
¯¯c o
.
¯¯o p
taHomologacao
¯¯p }
,
¯¯} ~
emissao¯¯ Ü
,¯¯Ü á
	EstadoNfe¯¯à ë
.¯¯ë í
PE¯¯í î
,¯¯î ï
ModeloDocumento¯¯ñ •
.¯¯• ¶
NFe¯¯¶ ©
,¯¯© ™
$str¯¯´ ¯
)¯¯¯ ˘
)¯¯˘ ˙
;¯¯˙ ˚

endServico
˘˘ 
.
˘˘ 
Add
˘˘ 
(
˘˘ 
new
˘˘ "
EnderecoServico
˘˘# 2
(
˘˘2 3

ServicoNFe
˘˘3 =
.
˘˘= >
NFeRetAutorizacao
˘˘> O
,
˘˘O P
VersaoServico
˘˘Q ^
.
˘˘^ _
ve310
˘˘_ d
,
˘˘d e
TipoAmbiente
˘˘f r
.
˘˘r s
taHomologacao˘˘s Ä
,˘˘Ä Å
emissao˘˘Ç â
,˘˘â ä
	EstadoNfe˘˘ã î
.˘˘î ï
PE˘˘ï ó
,˘˘ó ò
ModeloDocumento˘˘ô ®
.˘˘® ©
NFe˘˘© ¨
,˘˘¨ ≠
$str˘˘Æ ˛
)˘˘˛ ˇ
)˘˘ˇ Ä
;˘˘Ä Å
}
˙˙ 
foreach
ÄÄ 
(
ÄÄ 
var
ÄÄ 
emissao
ÄÄ  
in
ÄÄ! #
emissaoComum
ÄÄ$ 0
)
ÄÄ0 1
{
ÅÅ 
if
ÇÇ 
(
ÇÇ 
emissao
ÇÇ 
!=
ÇÇ 
TipoEmissao
ÇÇ *
.
ÇÇ* +
teEPEC
ÇÇ+ 1
)
ÇÇ1 2

endServico
ÉÉ 
.
ÉÉ 
AddRange
ÉÉ '
(
ÉÉ' (
eventoCceCanc
ÉÉ( 5
.
ÉÉ5 6
Select
ÉÉ6 <
(
ÉÉ< =

servicoNFe
ÉÉ= G
=>
ÉÉH J
new
ÉÉK N
EnderecoServico
ÉÉO ^
(
ÉÉ^ _

servicoNFe
ÉÉ_ i
,
ÉÉi j
VersaoServico
ÉÉk x
.
ÉÉx y
ve100
ÉÉy ~
,
ÉÉ~ 
TipoAmbienteÉÉÄ å
.ÉÉå ç

taProducaoÉÉç ó
,ÉÉó ò
emissaoÉÉô †
,ÉÉ† °
	EstadoNfeÉÉ¢ ´
.ÉÉ´ ¨
PEÉÉ¨ Æ
,ÉÉÆ Ø
ModeloDocumentoÉÉ∞ ø
.ÉÉø ¿
NFeÉÉ¿ √
,ÉÉ√ ƒ
$strÉÉ≈ Ü
)ÉÉÜ á
)ÉÉá à
)ÉÉà â
;ÉÉâ ä

endServico
ÑÑ 
.
ÑÑ 
Add
ÑÑ 
(
ÑÑ 
new
ÑÑ "
EnderecoServico
ÑÑ# 2
(
ÑÑ2 3

ServicoNFe
ÑÑ3 =
.
ÑÑ= >
NfeRecepcao
ÑÑ> I
,
ÑÑI J
VersaoServico
ÑÑK X
.
ÑÑX Y
ve200
ÑÑY ^
,
ÑÑ^ _
TipoAmbiente
ÑÑ` l
.
ÑÑl m

taProducao
ÑÑm w
,
ÑÑw x
emissaoÑÑy Ä
,ÑÑÄ Å
	EstadoNfeÑÑÇ ã
.ÑÑã å
PEÑÑå é
,ÑÑé è
ModeloDocumentoÑÑê ü
.ÑÑü †
NFeÑÑ† £
,ÑÑ£ §
$strÑÑ• ‰
)ÑÑ‰ Â
)ÑÑÂ Ê
;ÑÑÊ Á

endServico
ÖÖ 
.
ÖÖ 
Add
ÖÖ 
(
ÖÖ 
new
ÖÖ "
EnderecoServico
ÖÖ# 2
(
ÖÖ2 3

ServicoNFe
ÖÖ3 =
.
ÖÖ= >
NfeRetRecepcao
ÖÖ> L
,
ÖÖL M
VersaoServico
ÖÖN [
.
ÖÖ[ \
ve200
ÖÖ\ a
,
ÖÖa b
TipoAmbiente
ÖÖc o
.
ÖÖo p

taProducao
ÖÖp z
,
ÖÖz {
emissaoÖÖ| É
,ÖÖÉ Ñ
	EstadoNfeÖÖÖ é
.ÖÖé è
PEÖÖè ë
,ÖÖë í
ModeloDocumentoÖÖì ¢
.ÖÖ¢ £
NFeÖÖ£ ¶
,ÖÖ¶ ß
$strÖÖ® Í
)ÖÖÍ Î
)ÖÖÎ Ï
;ÖÖÏ Ì

endServico
ÜÜ 
.
ÜÜ 
AddRange
ÜÜ #
(
ÜÜ# $
versaoDoisETres
ÜÜ$ 3
.
ÜÜ3 4
Select
ÜÜ4 :
(
ÜÜ: ;
versao
ÜÜ; A
=>
ÜÜB D
new
ÜÜE H
EnderecoServico
ÜÜI X
(
ÜÜX Y

ServicoNFe
ÜÜY c
.
ÜÜc d
NfeInutilizacao
ÜÜd s
,
ÜÜs t
versao
ÜÜu {
,
ÜÜ{ |
TipoAmbienteÜÜ} â
.ÜÜâ ä

taProducaoÜÜä î
,ÜÜî ï
emissaoÜÜñ ù
,ÜÜù û
	EstadoNfeÜÜü ®
.ÜÜ® ©
PEÜÜ© ´
,ÜÜ´ ¨
ModeloDocumentoÜÜ≠ º
.ÜÜº Ω
NFeÜÜΩ ¿
,ÜÜ¿ ¡
$strÜÜ¬ Ö
)ÜÜÖ Ü
)ÜÜÜ á
)ÜÜá à
;ÜÜà â

endServico
áá 
.
áá 
AddRange
áá #
(
áá# $
versaoDoisETres
áá$ 3
.
áá3 4
Select
áá4 :
(
áá: ;
versao
áá; A
=>
ááB D
new
ááE H
EnderecoServico
ááI X
(
ááX Y

ServicoNFe
ááY c
.
áác d"
NfeConsultaProtocolo
áád x
,
ááx y
versaoááz Ä
,ááÄ Å
TipoAmbienteááÇ é
.ááé è

taProducaoááè ô
,ááô ö
emissaoááõ ¢
,áá¢ £
	EstadoNfeáá§ ≠
.áá≠ Æ
PEááÆ ∞
,áá∞ ±
ModeloDocumentoáá≤ ¡
.áá¡ ¬
NFeáá¬ ≈
,áá≈ ∆
$stráá« Ü
)ááÜ á
)ááá à
)ááà â
;ááâ ä

endServico
àà 
.
àà 
AddRange
àà #
(
àà# $
versaoDoisETres
àà$ 3
.
àà3 4
Select
àà4 :
(
àà: ;
versao
àà; A
=>
ààB D
new
ààE H
EnderecoServico
ààI X
(
ààX Y

ServicoNFe
ààY c
.
ààc d
NfeStatusServico
ààd t
,
ààt u
versao
ààv |
,
àà| }
TipoAmbienteàà~ ä
.ààä ã

taProducaoààã ï
,ààï ñ
emissaoààó û
,ààû ü
	EstadoNfeàà† ©
.àà© ™
PEàà™ ¨
,àà¨ ≠
ModeloDocumentoààÆ Ω
.ààΩ æ
NFeààæ ¡
,àà¡ ¬
$stràà√ á
)ààá à
)ààà â
)ààâ ä
;ààä ã

endServico
ââ 
.
ââ 
AddRange
ââ #
(
ââ# $
versaoDoisETres
ââ$ 3
.
ââ3 4
Select
ââ4 :
(
ââ: ;
versao
ââ; A
=>
ââB D
new
ââE H
EnderecoServico
ââI X
(
ââX Y

ServicoNFe
ââY c
.
ââc d!
NfeConsultaCadastro
ââd w
,
ââw x
versao
âây 
,ââ Ä
TipoAmbienteââÅ ç
.ââç é

taProducaoââé ò
,ââò ô
emissaoââö °
,ââ° ¢
	EstadoNfeââ£ ¨
.ââ¨ ≠
PEââ≠ Ø
,ââØ ∞
ModeloDocumentoââ± ¿
.ââ¿ ¡
NFeââ¡ ƒ
,ââƒ ≈
$strââ∆ ç
)ââç é
)ââé è
)ââè ê
;ââê ë

endServico
ää 
.
ää 
Add
ää 
(
ää 
new
ää "
EnderecoServico
ää# 2
(
ää2 3

ServicoNFe
ää3 =
.
ää= >
NFeAutorizacao
ää> L
,
ääL M
VersaoServico
ääN [
.
ää[ \
ve310
ää\ a
,
ääa b
TipoAmbiente
ääc o
.
ääo p

taProducao
ääp z
,
ääz {
emissaoää| É
,ääÉ Ñ
	EstadoNfeääÖ é
.ääé è
PEääè ë
,ääë í
ModeloDocumentoääì ¢
.ää¢ £
NFeää£ ¶
,ää¶ ß
$strää® Ó
)ääÓ Ô
)ääÔ 
;ää Ò

endServico
ãã 
.
ãã 
Add
ãã 
(
ãã 
new
ãã "
EnderecoServico
ãã# 2
(
ãã2 3

ServicoNFe
ãã3 =
.
ãã= >
NFeRetAutorizacao
ãã> O
,
ããO P
VersaoServico
ããQ ^
.
ãã^ _
ve310
ãã_ d
,
ããd e
TipoAmbiente
ããf r
.
ããr s

taProducao
ããs }
,
ãã} ~
emissaoãã Ü
,ããÜ á
	EstadoNfeããà ë
.ããë í
PEããí î
,ããî ï
ModeloDocumentoããñ •
.ãã• ¶
NFeãã¶ ©
,ãã© ™
$strãã´ Ù
)ããÙ ı
)ããı ˆ
;ããˆ ˜
}
åå 
foreach
°° 
(
°° 
var
°° 
emissao
°°  
in
°°! #
emissaoComum
°°$ 0
)
°°0 1
{
¢¢ 

endServico
•• 
.
•• 
Add
•• 
(
•• 
new
•• "
EnderecoServico
••# 2
(
••2 3

ServicoNFe
••3 =
.
••= >
NfeRecepcao
••> I
,
••I J
VersaoServico
••K X
.
••X Y
ve200
••Y ^
,
••^ _
TipoAmbiente
••` l
.
••l m
taHomologacao
••m z
,
••z {
emissao••| É
,••É Ñ
	EstadoNfe••Ö é
.••é è
PR••è ë
,••ë í
ModeloDocumento••ì ¢
.••¢ £
NFe••£ ¶
,••¶ ß
$str••® Í
)••Í Î
)••Î Ï
;••Ï Ì

endServico
¶¶ 
.
¶¶ 
Add
¶¶ 
(
¶¶ 
new
¶¶ "
EnderecoServico
¶¶# 2
(
¶¶2 3

ServicoNFe
¶¶3 =
.
¶¶= >
NfeRetRecepcao
¶¶> L
,
¶¶L M
VersaoServico
¶¶N [
.
¶¶[ \
ve200
¶¶\ a
,
¶¶a b
TipoAmbiente
¶¶c o
.
¶¶o p
taHomologacao
¶¶p }
,
¶¶} ~
emissao¶¶ Ü
,¶¶Ü á
	EstadoNfe¶¶à ë
.¶¶ë í
PR¶¶í î
,¶¶î ï
ModeloDocumento¶¶ñ •
.¶¶• ¶
NFe¶¶¶ ©
,¶¶© ™
$str¶¶´ 
)¶¶ Ò
)¶¶Ò Ú
;¶¶Ú Û

endServico
ßß 
.
ßß 
Add
ßß 
(
ßß 
new
ßß "
EnderecoServico
ßß# 2
(
ßß2 3

ServicoNFe
ßß3 =
.
ßß= >
NfeInutilizacao
ßß> M
,
ßßM N
VersaoServico
ßßO \
.
ßß\ ]
ve200
ßß] b
,
ßßb c
TipoAmbiente
ßßd p
.
ßßp q
taHomologacao
ßßq ~
,
ßß~ 
emissaoßßÄ á
,ßßá à
	EstadoNfeßßâ í
.ßßí ì
PRßßì ï
,ßßï ñ
ModeloDocumentoßßó ¶
.ßß¶ ß
NFeßßß ™
,ßß™ ´
$strßß¨ Ú
)ßßÚ Û
)ßßÛ Ù
;ßßÙ ı

endServico
®® 
.
®® 
Add
®® 
(
®® 
new
®® "
EnderecoServico
®®# 2
(
®®2 3

ServicoNFe
®®3 =
.
®®= >"
NfeConsultaProtocolo
®®> R
,
®®R S
VersaoServico
®®T a
.
®®a b
ve200
®®b g
,
®®g h
TipoAmbiente
®®i u
.
®®u v
taHomologacao®®v É
,®®É Ñ
emissao®®Ö å
,®®å ç
	EstadoNfe®®é ó
.®®ó ò
PR®®ò ö
,®®ö õ
ModeloDocumento®®ú ´
.®®´ ¨
NFe®®¨ Ø
,®®Ø ∞
$str®®± Û
)®®Û Ù
)®®Ù ı
;®®ı ˆ

endServico
©© 
.
©© 
Add
©© 
(
©© 
new
©© "
EnderecoServico
©©# 2
(
©©2 3

ServicoNFe
©©3 =
.
©©= >
NfeStatusServico
©©> N
,
©©N O
VersaoServico
©©P ]
.
©©] ^
ve200
©©^ c
,
©©c d
TipoAmbiente
©©e q
.
©©q r
taHomologacao
©©r 
,©© Ä
emissao©©Å à
,©©à â
	EstadoNfe©©ä ì
.©©ì î
PR©©î ñ
,©©ñ ó
ModeloDocumento©©ò ß
.©©ß ®
NFe©©® ´
,©©´ ¨
$str©©≠ Ù
)©©Ù ı
)©©ı ˆ
;©©ˆ ˜
if
´´ 
(
´´ 
emissao
´´ 
!=
´´ 
TipoEmissao
´´ *
.
´´* +
teEPEC
´´+ 1
)
´´1 2

endServico
¨¨ 
.
¨¨ 
AddRange
¨¨ '
(
¨¨' (
eventoCceCanc
¨¨( 5
.
¨¨5 6
Select
¨¨6 <
(
¨¨< =

servicoNFe
¨¨= G
=>
¨¨H J
new
¨¨K N
EnderecoServico
¨¨O ^
(
¨¨^ _

servicoNFe
¨¨_ i
,
¨¨i j
VersaoServico
¨¨k x
.
¨¨x y
ve200
¨¨y ~
,
¨¨~ 
TipoAmbiente¨¨Ä å
.¨¨å ç
taHomologacao¨¨ç ö
,¨¨ö õ
emissao¨¨ú £
,¨¨£ §
	EstadoNfe¨¨• Æ
.¨¨Æ Ø
PR¨¨Ø ±
,¨¨± ≤
ModeloDocumento¨¨≥ ¬
.¨¨¬ √
NFe¨¨√ ∆
,¨¨∆ «
$str¨¨» ñ
)¨¨ñ ó
)¨¨ó ò
)¨¨ò ô
;¨¨ô ö

endServico
≠≠ 
.
≠≠ 
Add
≠≠ 
(
≠≠ 
new
≠≠ "
EnderecoServico
≠≠# 2
(
≠≠2 3

ServicoNFe
≠≠3 =
.
≠≠= >
NfeInutilizacao
≠≠> M
,
≠≠M N
VersaoServico
≠≠O \
.
≠≠\ ]
ve310
≠≠] b
,
≠≠b c
TipoAmbiente
≠≠d p
.
≠≠p q
taHomologacao
≠≠q ~
,
≠≠~ 
emissao≠≠Ä á
,≠≠á à
	EstadoNfe≠≠â í
.≠≠í ì
PR≠≠ì ï
,≠≠ï ñ
ModeloDocumento≠≠ó ¶
.≠≠¶ ß
NFe≠≠ß ™
,≠≠™ ´
$str≠≠¨ Ò
)≠≠Ò Ú
)≠≠Ú Û
;≠≠Û Ù

endServico
ÆÆ 
.
ÆÆ 
Add
ÆÆ 
(
ÆÆ 
new
ÆÆ "
EnderecoServico
ÆÆ# 2
(
ÆÆ2 3

ServicoNFe
ÆÆ3 =
.
ÆÆ= >"
NfeConsultaProtocolo
ÆÆ> R
,
ÆÆR S
VersaoServico
ÆÆT a
.
ÆÆa b
ve310
ÆÆb g
,
ÆÆg h
TipoAmbiente
ÆÆi u
.
ÆÆu v
taHomologacaoÆÆv É
,ÆÆÉ Ñ
emissaoÆÆÖ å
,ÆÆå ç
	EstadoNfeÆÆé ó
.ÆÆó ò
PRÆÆò ö
,ÆÆö õ
ModeloDocumentoÆÆú ´
.ÆÆ´ ¨
NFeÆÆ¨ Ø
,ÆÆØ ∞
$strÆÆ± Ú
)ÆÆÚ Û
)ÆÆÛ Ù
;ÆÆÙ ı

endServico
ØØ 
.
ØØ 
Add
ØØ 
(
ØØ 
new
ØØ "
EnderecoServico
ØØ# 2
(
ØØ2 3

ServicoNFe
ØØ3 =
.
ØØ= >
NfeStatusServico
ØØ> N
,
ØØN O
VersaoServico
ØØP ]
.
ØØ] ^
ve310
ØØ^ c
,
ØØc d
TipoAmbiente
ØØe q
.
ØØq r
taHomologacao
ØØr 
,ØØ Ä
emissaoØØÅ à
,ØØà â
	EstadoNfeØØä ì
.ØØì î
PRØØî ñ
,ØØñ ó
ModeloDocumentoØØò ß
.ØØß ®
NFeØØ® ´
,ØØ´ ¨
$strØØ≠ Û
)ØØÛ Ù
)ØØÙ ı
;ØØı ˆ

endServico
∞∞ 
.
∞∞ 
Add
∞∞ 
(
∞∞ 
new
∞∞ "
EnderecoServico
∞∞# 2
(
∞∞2 3

ServicoNFe
∞∞3 =
.
∞∞= >!
NfeConsultaCadastro
∞∞> Q
,
∞∞Q R
VersaoServico
∞∞S `
.
∞∞` a
ve200
∞∞a f
,
∞∞f g
TipoAmbiente
∞∞h t
.
∞∞t u
taHomologacao∞∞u Ç
,∞∞Ç É
emissao∞∞Ñ ã
,∞∞ã å
	EstadoNfe∞∞ç ñ
.∞∞ñ ó
PR∞∞ó ô
,∞∞ô ö
ModeloDocumento∞∞õ ™
.∞∞™ ´
NFe∞∞´ Æ
,∞∞Æ Ø
$str∞∞∞ ˘
)∞∞˘ ˙
)∞∞˙ ˚
;∞∞˚ ¸
if
±± 
(
±± 
emissao
±± 
!=
±± 
TipoEmissao
±± *
.
±±* +
teEPEC
±±+ 1
)
±±1 2

endServico
≤≤ 
.
≤≤ 
AddRange
≤≤ '
(
≤≤' (
eventoCceCanc
≤≤( 5
.
≤≤5 6
Select
≤≤6 <
(
≤≤< =

servicoNFe
≤≤= G
=>
≤≤H J
new
≤≤K N
EnderecoServico
≤≤O ^
(
≤≤^ _

servicoNFe
≤≤_ i
,
≤≤i j
VersaoServico
≤≤k x
.
≤≤x y
ve100
≤≤y ~
,
≤≤~ 
TipoAmbiente≤≤Ä å
.≤≤å ç
taHomologacao≤≤ç ö
,≤≤ö õ
emissao≤≤ú £
,≤≤£ §
	EstadoNfe≤≤• Æ
.≤≤Æ Ø
PR≤≤Ø ±
,≤≤± ≤
ModeloDocumento≤≤≥ ¬
.≤≤¬ √
NFe≤≤√ ∆
,≤≤∆ «
$str≤≤» é
)≤≤é è
)≤≤è ê
)≤≤ê ë
;≤≤ë í

endServico
≥≥ 
.
≥≥ 
Add
≥≥ 
(
≥≥ 
new
≥≥ "
EnderecoServico
≥≥# 2
(
≥≥2 3

ServicoNFe
≥≥3 =
.
≥≥= >
NFeAutorizacao
≥≥> L
,
≥≥L M
VersaoServico
≥≥N [
.
≥≥[ \
ve310
≥≥\ a
,
≥≥a b
TipoAmbiente
≥≥c o
.
≥≥o p
taHomologacao
≥≥p }
,
≥≥} ~
emissao≥≥ Ü
,≥≥Ü á
	EstadoNfe≥≥à ë
.≥≥ë í
PR≥≥í î
,≥≥î ï
ModeloDocumento≥≥ñ •
.≥≥• ¶
NFe≥≥¶ ©
,≥≥© ™
$str≥≥´ Ô
)≥≥Ô 
)≥≥ Ò
;≥≥Ò Ú

endServico
¥¥ 
.
¥¥ 
Add
¥¥ 
(
¥¥ 
new
¥¥ "
EnderecoServico
¥¥# 2
(
¥¥2 3

ServicoNFe
¥¥3 =
.
¥¥= >
NFeRetAutorizacao
¥¥> O
,
¥¥O P
VersaoServico
¥¥Q ^
.
¥¥^ _
ve310
¥¥_ d
,
¥¥d e
TipoAmbiente
¥¥f r
.
¥¥r s
taHomologacao¥¥s Ä
,¥¥Ä Å
emissao¥¥Ç â
,¥¥â ä
	EstadoNfe¥¥ã î
.¥¥î ï
PR¥¥ï ó
,¥¥ó ò
ModeloDocumento¥¥ô ®
.¥¥® ©
NFe¥¥© ¨
,¥¥¨ ≠
$str¥¥Æ ı
)¥¥ı ˆ
)¥¥ˆ ˜
;¥¥˜ ¯

endServico
∫∫ 
.
∫∫ 
Add
∫∫ 
(
∫∫ 
new
∫∫ "
EnderecoServico
∫∫# 2
(
∫∫2 3

ServicoNFe
∫∫3 =
.
∫∫= >
NFeAutorizacao
∫∫> L
,
∫∫L M
VersaoServico
∫∫N [
.
∫∫[ \
ve310
∫∫\ a
,
∫∫a b
TipoAmbiente
∫∫c o
.
∫∫o p
taHomologacao
∫∫p }
,
∫∫} ~
emissao∫∫ Ü
,∫∫Ü á
	EstadoNfe∫∫à ë
.∫∫ë í
PR∫∫í î
,∫∫î ï
ModeloDocumento∫∫ñ •
.∫∫• ¶
NFCe∫∫¶ ™
,∫∫™ ´
$str∫∫¨ Ì
)∫∫Ì Ó
)∫∫Ó Ô
;∫∫Ô 

endServico
ªª 
.
ªª 
Add
ªª 
(
ªª 
new
ªª "
EnderecoServico
ªª# 2
(
ªª2 3

ServicoNFe
ªª3 =
.
ªª= >
NFeRetAutorizacao
ªª> O
,
ªªO P
VersaoServico
ªªQ ^
.
ªª^ _
ve310
ªª_ d
,
ªªd e
TipoAmbiente
ªªf r
.
ªªr s
taHomologacaoªªs Ä
,ªªÄ Å
emissaoªªÇ â
,ªªâ ä
	EstadoNfeªªã î
.ªªî ï
PRªªï ó
,ªªó ò
ModeloDocumentoªªô ®
.ªª® ©
NFCeªª© ≠
,ªª≠ Æ
$strªªØ Û
)ªªÛ Ù
)ªªÙ ı
;ªªı ˆ

endServico
ºº 
.
ºº 
Add
ºº 
(
ºº 
new
ºº "
EnderecoServico
ºº# 2
(
ºº2 3

ServicoNFe
ºº3 =
.
ºº= >"
NfeConsultaProtocolo
ºº> R
,
ººR S
VersaoServico
ººT a
.
ººa b
ve310
ººb g
,
ººg h
TipoAmbiente
ººi u
.
ººu v
taHomologacaoººv É
,ººÉ Ñ
emissaoººÖ å
,ººå ç
	EstadoNfeººé ó
.ººó ò
PRººò ö
,ººö õ
ModeloDocumentoººú ´
.ºº´ ¨
NFCeºº¨ ∞
,ºº∞ ±
$strºº≤ 
)ºº Ò
)ººÒ Ú
;ººÚ Û

endServico
ΩΩ 
.
ΩΩ 
Add
ΩΩ 
(
ΩΩ 
new
ΩΩ "
EnderecoServico
ΩΩ# 2
(
ΩΩ2 3

ServicoNFe
ΩΩ3 =
.
ΩΩ= >
NfeInutilizacao
ΩΩ> M
,
ΩΩM N
VersaoServico
ΩΩO \
.
ΩΩ\ ]
ve310
ΩΩ] b
,
ΩΩb c
TipoAmbiente
ΩΩd p
.
ΩΩp q
taHomologacao
ΩΩq ~
,
ΩΩ~ 
emissaoΩΩÄ á
,ΩΩá à
	EstadoNfeΩΩâ í
.ΩΩí ì
PRΩΩì ï
,ΩΩï ñ
ModeloDocumentoΩΩó ¶
.ΩΩ¶ ß
NFCeΩΩß ´
,ΩΩ´ ¨
$strΩΩ≠ Ô
)ΩΩÔ 
)ΩΩ Ò
;ΩΩÒ Ú

endServico
ææ 
.
ææ 
Add
ææ 
(
ææ 
new
ææ "
EnderecoServico
ææ# 2
(
ææ2 3

ServicoNFe
ææ3 =
.
ææ= >
NfeStatusServico
ææ> N
,
ææN O
VersaoServico
ææP ]
.
ææ] ^
ve310
ææ^ c
,
ææc d
TipoAmbiente
ææe q
.
ææq r
taHomologacao
æær 
,ææ Ä
emissaoææÅ à
,ææà â
	EstadoNfeææä ì
.ææì î
PRææî ñ
,ææñ ó
ModeloDocumentoææò ß
.ææß ®
NFCeææ® ¨
,ææ¨ ≠
$strææÆ Ò
)ææÒ Ú
)ææÚ Û
;ææÛ Ù

endServico
øø 
.
øø 
Add
øø 
(
øø 
new
øø "
EnderecoServico
øø# 2
(
øø2 3

ServicoNFe
øø3 =
.
øø= >'
RecepcaoEventoCancelmento
øø> W
,
øøW X
VersaoServico
øøY f
.
øøf g
ve100
øøg l
,
øøl m
TipoAmbiente
øøn z
.
øøz {
taHomologacaoøø{ à
,øøà â
emissaoøøä ë
,øøë í
	EstadoNfeøøì ú
.øøú ù
PRøøù ü
,øøü †
ModeloDocumentoøø° ∞
.øø∞ ±
NFCeøø± µ
,øøµ ∂
$strøø∑ ˙
)øø˙ ˚
)øø˚ ¸
;øø¸ ˝
}
¬¬ 
foreach
»» 
(
»» 
var
»» 
emissao
»»  
in
»»! #
emissaoComum
»»$ 0
)
»»0 1
{
…… 

endServico
ÃÃ 
.
ÃÃ 
Add
ÃÃ 
(
ÃÃ 
new
ÃÃ "
EnderecoServico
ÃÃ# 2
(
ÃÃ2 3

ServicoNFe
ÃÃ3 =
.
ÃÃ= >
NfeRecepcao
ÃÃ> I
,
ÃÃI J
VersaoServico
ÃÃK X
.
ÃÃX Y
ve200
ÃÃY ^
,
ÃÃ^ _
TipoAmbiente
ÃÃ` l
.
ÃÃl m

taProducao
ÃÃm w
,
ÃÃw x
emissaoÃÃy Ä
,ÃÃÄ Å
	EstadoNfeÃÃÇ ã
.ÃÃã å
PRÃÃå é
,ÃÃé è
ModeloDocumentoÃÃê ü
.ÃÃü †
NFeÃÃ† £
,ÃÃ£ §
$strÃÃ• €
)ÃÃ€ ‹
)ÃÃ‹ ›
;ÃÃ› ﬁ

endServico
ÕÕ 
.
ÕÕ 
Add
ÕÕ 
(
ÕÕ 
new
ÕÕ "
EnderecoServico
ÕÕ# 2
(
ÕÕ2 3

ServicoNFe
ÕÕ3 =
.
ÕÕ= >
NfeRetRecepcao
ÕÕ> L
,
ÕÕL M
VersaoServico
ÕÕN [
.
ÕÕ[ \
ve200
ÕÕ\ a
,
ÕÕa b
TipoAmbiente
ÕÕc o
.
ÕÕo p

taProducao
ÕÕp z
,
ÕÕz {
emissaoÕÕ| É
,ÕÕÉ Ñ
	EstadoNfeÕÕÖ é
.ÕÕé è
PRÕÕè ë
,ÕÕë í
ModeloDocumentoÕÕì ¢
.ÕÕ¢ £
NFeÕÕ£ ¶
,ÕÕ¶ ß
$strÕÕ® ·
)ÕÕ· ‚
)ÕÕ‚ „
;ÕÕ„ ‰

endServico
ŒŒ 
.
ŒŒ 
Add
ŒŒ 
(
ŒŒ 
new
ŒŒ "
EnderecoServico
ŒŒ# 2
(
ŒŒ2 3

ServicoNFe
ŒŒ3 =
.
ŒŒ= >
NfeInutilizacao
ŒŒ> M
,
ŒŒM N
VersaoServico
ŒŒO \
.
ŒŒ\ ]
ve200
ŒŒ] b
,
ŒŒb c
TipoAmbiente
ŒŒd p
.
ŒŒp q

taProducao
ŒŒq {
,
ŒŒ{ |
emissaoŒŒ} Ñ
,ŒŒÑ Ö
	EstadoNfeŒŒÜ è
.ŒŒè ê
PRŒŒê í
,ŒŒí ì
ModeloDocumentoŒŒî £
.ŒŒ£ §
NFeŒŒ§ ß
,ŒŒß ®
$strŒŒ© „
)ŒŒ„ ‰
)ŒŒ‰ Â
;ŒŒÂ Ê

endServico
œœ 
.
œœ 
Add
œœ 
(
œœ 
new
œœ "
EnderecoServico
œœ# 2
(
œœ2 3

ServicoNFe
œœ3 =
.
œœ= >"
NfeConsultaProtocolo
œœ> R
,
œœR S
VersaoServico
œœT a
.
œœa b
ve200
œœb g
,
œœg h
TipoAmbiente
œœi u
.
œœu v

taProducaoœœv Ä
,œœÄ Å
emissaoœœÇ â
,œœâ ä
	EstadoNfeœœã î
.œœî ï
PRœœï ó
,œœó ò
ModeloDocumentoœœô ®
.œœ® ©
NFeœœ© ¨
,œœ¨ ≠
$strœœÆ ‰
)œœ‰ Â
)œœÂ Ê
;œœÊ Á

endServico
–– 
.
–– 
Add
–– 
(
–– 
new
–– "
EnderecoServico
––# 2
(
––2 3

ServicoNFe
––3 =
.
––= >
NfeStatusServico
––> N
,
––N O
VersaoServico
––P ]
.
––] ^
ve200
––^ c
,
––c d
TipoAmbiente
––e q
.
––q r

taProducao
––r |
,
––| }
emissao––~ Ö
,––Ö Ü
	EstadoNfe––á ê
.––ê ë
PR––ë ì
,––ì î
ModeloDocumento––ï §
.––§ •
NFe––• ®
,––® ©
$str––™ Â
)––Â Ê
)––Ê Á
;––Á Ë
if
““ 
(
““ 
emissao
““ 
!=
““ 
TipoEmissao
““ *
.
““* +
teEPEC
““+ 1
)
““1 2

endServico
”” 
.
”” 
AddRange
”” '
(
””' (
eventoCceCanc
””( 5
.
””5 6
Select
””6 <
(
””< =

servicoNFe
””= G
=>
””H J
new
””K N
EnderecoServico
””O ^
(
””^ _

servicoNFe
””_ i
,
””i j
VersaoServico
””k x
.
””x y
ve200
””y ~
,
””~ 
TipoAmbiente””Ä å
.””å ç

taProducao””ç ó
,””ó ò
emissao””ô †
,””† °
	EstadoNfe””¢ ´
.””´ ¨
PR””¨ Æ
,””Æ Ø
ModeloDocumento””∞ ø
.””ø ¿
NFe””¿ √
,””√ ƒ
$str””≈ á
)””á à
)””à â
)””â ä
;””ä ã

endServico
‘‘ 
.
‘‘ 
Add
‘‘ 
(
‘‘ 
new
‘‘ "
EnderecoServico
‘‘# 2
(
‘‘2 3

ServicoNFe
‘‘3 =
.
‘‘= >
NfeInutilizacao
‘‘> M
,
‘‘M N
VersaoServico
‘‘O \
.
‘‘\ ]
ve310
‘‘] b
,
‘‘b c
TipoAmbiente
‘‘d p
.
‘‘p q

taProducao
‘‘q {
,
‘‘{ |
emissao‘‘} Ñ
,‘‘Ñ Ö
	EstadoNfe‘‘Ü è
.‘‘è ê
PR‘‘ê í
,‘‘í ì
ModeloDocumento‘‘î £
.‘‘£ §
NFe‘‘§ ß
,‘‘ß ®
$str‘‘© ‚
)‘‘‚ „
)‘‘„ ‰
;‘‘‰ Â

endServico
’’ 
.
’’ 
Add
’’ 
(
’’ 
new
’’ "
EnderecoServico
’’# 2
(
’’2 3

ServicoNFe
’’3 =
.
’’= >"
NfeConsultaProtocolo
’’> R
,
’’R S
VersaoServico
’’T a
.
’’a b
ve310
’’b g
,
’’g h
TipoAmbiente
’’i u
.
’’u v

taProducao’’v Ä
,’’Ä Å
emissao’’Ç â
,’’â ä
	EstadoNfe’’ã î
.’’î ï
PR’’ï ó
,’’ó ò
ModeloDocumento’’ô ®
.’’® ©
NFe’’© ¨
,’’¨ ≠
$str’’Æ „
)’’„ ‰
)’’‰ Â
;’’Â Ê

endServico
÷÷ 
.
÷÷ 
Add
÷÷ 
(
÷÷ 
new
÷÷ "
EnderecoServico
÷÷# 2
(
÷÷2 3

ServicoNFe
÷÷3 =
.
÷÷= >
NfeStatusServico
÷÷> N
,
÷÷N O
VersaoServico
÷÷P ]
.
÷÷] ^
ve310
÷÷^ c
,
÷÷c d
TipoAmbiente
÷÷e q
.
÷÷q r

taProducao
÷÷r |
,
÷÷| }
emissao÷÷~ Ö
,÷÷Ö Ü
	EstadoNfe÷÷á ê
.÷÷ê ë
PR÷÷ë ì
,÷÷ì î
ModeloDocumento÷÷ï §
.÷÷§ •
NFe÷÷• ®
,÷÷® ©
$str÷÷™ ‰
)÷÷‰ Â
)÷÷Â Ê
;÷÷Ê Á

endServico
◊◊ 
.
◊◊ 
Add
◊◊ 
(
◊◊ 
new
◊◊ "
EnderecoServico
◊◊# 2
(
◊◊2 3

ServicoNFe
◊◊3 =
.
◊◊= >!
NfeConsultaCadastro
◊◊> Q
,
◊◊Q R
VersaoServico
◊◊S `
.
◊◊` a
ve200
◊◊a f
,
◊◊f g
TipoAmbiente
◊◊h t
.
◊◊t u

taProducao
◊◊u 
,◊◊ Ä
emissao◊◊Å à
,◊◊à â
	EstadoNfe◊◊ä ì
.◊◊ì î
PR◊◊î ñ
,◊◊ñ ó
ModeloDocumento◊◊ò ß
.◊◊ß ®
NFe◊◊® ´
,◊◊´ ¨
$str◊◊≠ Í
)◊◊Í Î
)◊◊Î Ï
;◊◊Ï Ì
if
ÿÿ 
(
ÿÿ 
emissao
ÿÿ 
!=
ÿÿ 
TipoEmissao
ÿÿ *
.
ÿÿ* +
teEPEC
ÿÿ+ 1
)
ÿÿ1 2

endServico
ŸŸ 
.
ŸŸ 
AddRange
ŸŸ '
(
ŸŸ' (
eventoCceCanc
ŸŸ( 5
.
ŸŸ5 6
Select
ŸŸ6 <
(
ŸŸ< =

servicoNFe
ŸŸ= G
=>
ŸŸH J
new
ŸŸK N
EnderecoServico
ŸŸO ^
(
ŸŸ^ _

servicoNFe
ŸŸ_ i
,
ŸŸi j
VersaoServico
ŸŸk x
.
ŸŸx y
ve100
ŸŸy ~
,
ŸŸ~ 
TipoAmbienteŸŸÄ å
.ŸŸå ç

taProducaoŸŸç ó
,ŸŸó ò
emissaoŸŸô †
,ŸŸ† °
	EstadoNfeŸŸ¢ ´
.ŸŸ´ ¨
PRŸŸ¨ Æ
,ŸŸÆ Ø
ModeloDocumentoŸŸ∞ ø
.ŸŸø ¿
NFeŸŸ¿ √
,ŸŸ√ ƒ
$strŸŸ≈ ˇ
)ŸŸˇ Ä
)ŸŸÄ Å
)ŸŸÅ Ç
;ŸŸÇ É

endServico
⁄⁄ 
.
⁄⁄ 
Add
⁄⁄ 
(
⁄⁄ 
new
⁄⁄ "
EnderecoServico
⁄⁄# 2
(
⁄⁄2 3

ServicoNFe
⁄⁄3 =
.
⁄⁄= >
NFeAutorizacao
⁄⁄> L
,
⁄⁄L M
VersaoServico
⁄⁄N [
.
⁄⁄[ \
ve310
⁄⁄\ a
,
⁄⁄a b
TipoAmbiente
⁄⁄c o
.
⁄⁄o p

taProducao
⁄⁄p z
,
⁄⁄z {
emissao⁄⁄| É
,⁄⁄É Ñ
	EstadoNfe⁄⁄Ö é
.⁄⁄é è
PR⁄⁄è ë
,⁄⁄ë í
ModeloDocumento⁄⁄ì ¢
.⁄⁄¢ £
NFe⁄⁄£ ¶
,⁄⁄¶ ß
$str⁄⁄® ‡
)⁄⁄‡ ·
)⁄⁄· ‚
;⁄⁄‚ „

endServico
€€ 
.
€€ 
Add
€€ 
(
€€ 
new
€€ "
EnderecoServico
€€# 2
(
€€2 3

ServicoNFe
€€3 =
.
€€= >
NFeRetAutorizacao
€€> O
,
€€O P
VersaoServico
€€Q ^
.
€€^ _
ve310
€€_ d
,
€€d e
TipoAmbiente
€€f r
.
€€r s

taProducao
€€s }
,
€€} ~
emissao€€ Ü
,€€Ü á
	EstadoNfe€€à ë
.€€ë í
PR€€í î
,€€î ï
ModeloDocumento€€ñ •
.€€• ¶
NFe€€¶ ©
,€€© ™
$str€€´ Ê
)€€Ê Á
)€€Á Ë
;€€Ë È

endServico
·· 
.
·· 
Add
·· 
(
·· 
new
·· "
EnderecoServico
··# 2
(
··2 3

ServicoNFe
··3 =
.
··= >
NFeAutorizacao
··> L
,
··L M
VersaoServico
··N [
.
··[ \
ve310
··\ a
,
··a b
TipoAmbiente
··c o
.
··o p

taProducao
··p z
,
··z {
emissao··| É
,··É Ñ
	EstadoNfe··Ö é
.··é è
PR··è ë
,··ë í
ModeloDocumento··ì ¢
.··¢ £
NFCe··£ ß
,··ß ®
$str··© ﬁ
)··ﬁ ﬂ
)··ﬂ ‡
;··‡ ·

endServico
‚‚ 
.
‚‚ 
Add
‚‚ 
(
‚‚ 
new
‚‚ "
EnderecoServico
‚‚# 2
(
‚‚2 3

ServicoNFe
‚‚3 =
.
‚‚= >
NFeRetAutorizacao
‚‚> O
,
‚‚O P
VersaoServico
‚‚Q ^
.
‚‚^ _
ve310
‚‚_ d
,
‚‚d e
TipoAmbiente
‚‚f r
.
‚‚r s

taProducao
‚‚s }
,
‚‚} ~
emissao‚‚ Ü
,‚‚Ü á
	EstadoNfe‚‚à ë
.‚‚ë í
PR‚‚í î
,‚‚î ï
ModeloDocumento‚‚ñ •
.‚‚• ¶
NFCe‚‚¶ ™
,‚‚™ ´
$str‚‚¨ ‰
)‚‚‰ Â
)‚‚Â Ê
;‚‚Ê Á

endServico
„„ 
.
„„ 
Add
„„ 
(
„„ 
new
„„ "
EnderecoServico
„„# 2
(
„„2 3

ServicoNFe
„„3 =
.
„„= >"
NfeConsultaProtocolo
„„> R
,
„„R S
VersaoServico
„„T a
.
„„a b
ve310
„„b g
,
„„g h
TipoAmbiente
„„i u
.
„„u v

taProducao„„v Ä
,„„Ä Å
emissao„„Ç â
,„„â ä
	EstadoNfe„„ã î
.„„î ï
PR„„ï ó
,„„ó ò
ModeloDocumento„„ô ®
.„„® ©
NFCe„„© ≠
,„„≠ Æ
$str„„Ø ·
)„„· ‚
)„„‚ „
;„„„ ‰

endServico
‰‰ 
.
‰‰ 
Add
‰‰ 
(
‰‰ 
new
‰‰ "
EnderecoServico
‰‰# 2
(
‰‰2 3

ServicoNFe
‰‰3 =
.
‰‰= >
NfeInutilizacao
‰‰> M
,
‰‰M N
VersaoServico
‰‰O \
.
‰‰\ ]
ve310
‰‰] b
,
‰‰b c
TipoAmbiente
‰‰d p
.
‰‰p q

taProducao
‰‰q {
,
‰‰{ |
emissao‰‰} Ñ
,‰‰Ñ Ö
	EstadoNfe‰‰Ü è
.‰‰è ê
PR‰‰ê í
,‰‰í ì
ModeloDocumento‰‰î £
.‰‰£ §
NFCe‰‰§ ®
,‰‰® ©
$str‰‰™ ‡
)‰‰‡ ·
)‰‰· ‚
;‰‰‚ „

endServico
ÂÂ 
.
ÂÂ 
Add
ÂÂ 
(
ÂÂ 
new
ÂÂ "
EnderecoServico
ÂÂ# 2
(
ÂÂ2 3

ServicoNFe
ÂÂ3 =
.
ÂÂ= >
NfeStatusServico
ÂÂ> N
,
ÂÂN O
VersaoServico
ÂÂP ]
.
ÂÂ] ^
ve310
ÂÂ^ c
,
ÂÂc d
TipoAmbiente
ÂÂe q
.
ÂÂq r

taProducao
ÂÂr |
,
ÂÂ| }
emissaoÂÂ~ Ö
,ÂÂÖ Ü
	EstadoNfeÂÂá ê
.ÂÂê ë
PRÂÂë ì
,ÂÂì î
ModeloDocumentoÂÂï §
.ÂÂ§ •
NFCeÂÂ• ©
,ÂÂ© ™
$strÂÂ´ ‚
)ÂÂ‚ „
)ÂÂ„ ‰
;ÂÂ‰ Â

endServico
ÊÊ 
.
ÊÊ 
Add
ÊÊ 
(
ÊÊ 
new
ÊÊ "
EnderecoServico
ÊÊ# 2
(
ÊÊ2 3

ServicoNFe
ÊÊ3 =
.
ÊÊ= >'
RecepcaoEventoCancelmento
ÊÊ> W
,
ÊÊW X
VersaoServico
ÊÊY f
.
ÊÊf g
ve100
ÊÊg l
,
ÊÊl m
TipoAmbiente
ÊÊn z
.
ÊÊz {

taProducaoÊÊ{ Ö
,ÊÊÖ Ü
emissaoÊÊá é
,ÊÊé è
	EstadoNfeÊÊê ô
.ÊÊô ö
PRÊÊö ú
,ÊÊú ù
ModeloDocumentoÊÊû ≠
.ÊÊ≠ Æ
NFCeÊÊÆ ≤
,ÊÊ≤ ≥
$strÊÊ¥ Î
)ÊÊÎ Ï
)ÊÊÏ Ì
;ÊÊÌ Ó
}
ÈÈ 
foreach
áá 
(
áá 
var
áá 
emissao
áá  
in
áá! #
emissaoComum
áá$ 0
)
áá0 1
{
àà 
if
ãã 
(
ãã 
emissao
ãã 
!=
ãã 
TipoEmissao
ãã *
.
ãã* +
teEPEC
ãã+ 1
)
ãã1 2

endServico
åå 
.
åå 
AddRange
åå '
(
åå' (
eventoCceCanc
åå( 5
.
åå5 6
Select
åå6 <
(
åå< =

servicoNFe
åå= G
=>
ååH J
new
ååK N
EnderecoServico
ååO ^
(
åå^ _

servicoNFe
åå_ i
,
ååi j
VersaoServico
ååk x
.
ååx y
ve100
ååy ~
,
åå~ 
TipoAmbienteååÄ å
.ååå ç
taHomologacaoååç ö
,ååö õ
emissaoååú £
,åå£ §
	EstadoNfeåå• Æ
.ååÆ Ø
RSååØ ±
,åå± ≤
ModeloDocumentoåå≥ ¬
.åå¬ √
NFeåå√ ∆
,åå∆ «
$stråå» ô
)ååô ö
)ååö õ
)ååõ ú
;ååú ù

endServico
çç 
.
çç 
Add
çç 
(
çç 
new
çç "
EnderecoServico
çç# 2
(
çç2 3

ServicoNFe
çç3 =
.
çç= >!
NfeConsultaCadastro
çç> Q
,
ççQ R
VersaoServico
ççS `
.
çç` a
ve200
çça f
,
ççf g
TipoAmbiente
ççh t
.
ççt u
taHomologacaoççu Ç
,ççÇ É
emissaoççÑ ã
,ççã å
	EstadoNfeççç ñ
.ççñ ó
RSççó ô
,ççô ö
ModeloDocumentoççõ ™
.çç™ ´
NFeçç´ Æ
,ççÆ Ø
$strçç∞ Ä
)ççÄ Å
)ççÅ Ç
;ççÇ É

endServico
éé 
.
éé 
Add
éé 
(
éé 
new
éé "
EnderecoServico
éé# 2
(
éé2 3

ServicoNFe
éé3 =
.
éé= >
NfeInutilizacao
éé> M
,
ééM N
VersaoServico
ééO \
.
éé\ ]
ve310
éé] b
,
ééb c
TipoAmbiente
ééd p
.
éép q
taHomologacao
ééq ~
,
éé~ 
emissaoééÄ á
,ééá à
	EstadoNfeééâ í
.ééí ì
RSééì ï
,ééï ñ
ModeloDocumentoééó ¶
.éé¶ ß
NFeééß ™
,éé™ ´
$stréé¨ Ä
)ééÄ Å
)ééÅ Ç
;ééÇ É

endServico
èè 
.
èè 
Add
èè 
(
èè 
new
èè "
EnderecoServico
èè# 2
(
èè2 3

ServicoNFe
èè3 =
.
èè= >"
NfeConsultaProtocolo
èè> R
,
èèR S
VersaoServico
èèT a
.
èèa b
ve310
èèb g
,
èèg h
TipoAmbiente
èèi u
.
èèu v
taHomologacaoèèv É
,èèÉ Ñ
emissaoèèÖ å
,èèå ç
	EstadoNfeèèé ó
.èèó ò
RSèèò ö
,èèö õ
ModeloDocumentoèèú ´
.èè´ ¨
NFeèè¨ Ø
,èèØ ∞
$strèè± ˝
)èè˝ ˛
)èè˛ ˇ
;èèˇ Ä

endServico
êê 
.
êê 
Add
êê 
(
êê 
new
êê "
EnderecoServico
êê# 2
(
êê2 3

ServicoNFe
êê3 =
.
êê= >
NfeStatusServico
êê> N
,
êêN O
VersaoServico
êêP ]
.
êê] ^
ve310
êê^ c
,
êêc d
TipoAmbiente
êêe q
.
êêq r
taHomologacao
êêr 
,êê Ä
emissaoêêÅ à
,êêà â
	EstadoNfeêêä ì
.êêì î
RSêêî ñ
,êêñ ó
ModeloDocumentoêêò ß
.êêß ®
NFeêê® ´
,êê´ ¨
$strêê≠ É
)êêÉ Ñ
)êêÑ Ö
;êêÖ Ü

endServico
ëë 
.
ëë 
Add
ëë 
(
ëë 
new
ëë "
EnderecoServico
ëë# 2
(
ëë2 3

ServicoNFe
ëë3 =
.
ëë= >
NFeAutorizacao
ëë> L
,
ëëL M
VersaoServico
ëëN [
.
ëë[ \
ve310
ëë\ a
,
ëëa b
TipoAmbiente
ëëc o
.
ëëo p
taHomologacao
ëëp }
,
ëë} ~
emissaoëë Ü
,ëëÜ á
	EstadoNfeëëà ë
.ëëë í
RSëëí î
,ëëî ï
ModeloDocumentoëëñ •
.ëë• ¶
NFeëë¶ ©
,ëë© ™
$strëë´ ¸
)ëë¸ ˝
)ëë˝ ˛
;ëë˛ ˇ

endServico
íí 
.
íí 
Add
íí 
(
íí 
new
íí "
EnderecoServico
íí# 2
(
íí2 3

ServicoNFe
íí3 =
.
íí= >
NFeRetAutorizacao
íí> O
,
ííO P
VersaoServico
ííQ ^
.
íí^ _
ve310
íí_ d
,
ííd e
TipoAmbiente
ííf r
.
íír s
taHomologacaoíís Ä
,ííÄ Å
emissaoííÇ â
,ííâ ä
	EstadoNfeííã î
.ííî ï
RSííï ó
,ííó ò
ModeloDocumentoííô ®
.íí® ©
NFeíí© ¨
,íí¨ ≠
$strííÆ Ö
)ííÖ Ü
)ííÜ á
;ííá à

endServico
òò 
.
òò 
Add
òò 
(
òò 
new
òò "
EnderecoServico
òò# 2
(
òò2 3

ServicoNFe
òò3 =
.
òò= >
NFeAutorizacao
òò> L
,
òòL M
VersaoServico
òòN [
.
òò[ \
ve310
òò\ a
,
òòa b
TipoAmbiente
òòc o
.
òòo p
taHomologacao
òòp }
,
òò} ~
emissaoòò Ü
,òòÜ á
	EstadoNfeòòà ë
.òòë í
RSòòí î
,òòî ï
ModeloDocumentoòòñ •
.òò• ¶
NFCeòò¶ ™
,òò™ ´
$stròò¨ ˛
)òò˛ ˇ
)òòˇ Ä
;òòÄ Å

endServico
ôô 
.
ôô 
Add
ôô 
(
ôô 
new
ôô "
EnderecoServico
ôô# 2
(
ôô2 3

ServicoNFe
ôô3 =
.
ôô= >
NFeRetAutorizacao
ôô> O
,
ôôO P
VersaoServico
ôôQ ^
.
ôô^ _
ve310
ôô_ d
,
ôôd e
TipoAmbiente
ôôf r
.
ôôr s
taHomologacaoôôs Ä
,ôôÄ Å
emissaoôôÇ â
,ôôâ ä
	EstadoNfeôôã î
.ôôî ï
RSôôï ó
,ôôó ò
ModeloDocumentoôôô ®
.ôô® ©
NFCeôô© ≠
,ôô≠ Æ
$strôôØ á
)ôôá à
)ôôà â
;ôôâ ä

endServico
öö 
.
öö 
Add
öö 
(
öö 
new
öö "
EnderecoServico
öö# 2
(
öö2 3

ServicoNFe
öö3 =
.
öö= >
NfeInutilizacao
öö> M
,
ööM N
VersaoServico
ööO \
.
öö\ ]
ve310
öö] b
,
ööb c
TipoAmbiente
ööd p
.
ööp q
taHomologacao
ööq ~
,
öö~ 
emissaoööÄ á
,ööá à
	EstadoNfeööâ í
.ööí ì
RSööì ï
,ööï ñ
ModeloDocumentoööó ¶
.öö¶ ß
NFCeööß ´
,öö´ ¨
$ströö≠ Ç
)ööÇ É
)ööÉ Ñ
;ööÑ Ö

endServico
õõ 
.
õõ 
Add
õõ 
(
õõ 
new
õõ "
EnderecoServico
õõ# 2
(
õõ2 3

ServicoNFe
õõ3 =
.
õõ= >"
NfeConsultaProtocolo
õõ> R
,
õõR S
VersaoServico
õõT a
.
õõa b
ve310
õõb g
,
õõg h
TipoAmbiente
õõi u
.
õõu v
taHomologacaoõõv É
,õõÉ Ñ
emissaoõõÖ å
,õõå ç
	EstadoNfeõõé ó
.õõó ò
RSõõò ö
,õõö õ
ModeloDocumentoõõú ´
.õõ´ ¨
NFCeõõ¨ ∞
,õõ∞ ±
$strõõ≤ ˇ
)õõˇ Ä
)õõÄ Å
;õõÅ Ç

endServico
úú 
.
úú 
Add
úú 
(
úú 
new
úú "
EnderecoServico
úú# 2
(
úú2 3

ServicoNFe
úú3 =
.
úú= >
NfeStatusServico
úú> N
,
úúN O
VersaoServico
úúP ]
.
úú] ^
ve310
úú^ c
,
úúc d
TipoAmbiente
úúe q
.
úúq r
taHomologacao
úúr 
,úú Ä
emissaoúúÅ à
,úúà â
	EstadoNfeúúä ì
.úúì î
RSúúî ñ
,úúñ ó
ModeloDocumentoúúò ß
.úúß ®
NFCeúú® ¨
,úú¨ ≠
$strúúÆ Ö
)úúÖ Ü
)úúÜ á
;úúá à

endServico
ùù 
.
ùù 
Add
ùù 
(
ùù 
new
ùù "
EnderecoServico
ùù# 2
(
ùù2 3

ServicoNFe
ùù3 =
.
ùù= >'
RecepcaoEventoCancelmento
ùù> W
,
ùùW X
VersaoServico
ùùY f
.
ùùf g
ve100
ùùg l
,
ùùl m
TipoAmbiente
ùùn z
.
ùùz {
taHomologacaoùù{ à
,ùùà â
emissaoùùä ë
,ùùë í
	EstadoNfeùùì ú
.ùùú ù
RSùùù ü
,ùùü †
ModeloDocumentoùù° ∞
.ùù∞ ±
NFCeùù± µ
,ùùµ ∂
$strùù∑ â
)ùùâ ä
)ùùä ã
;ùùã å
}
†† 
foreach
¶¶ 
(
¶¶ 
var
¶¶ 
emissao
¶¶  
in
¶¶! #
emissaoComum
¶¶$ 0
)
¶¶0 1
{
ßß 

endServico
™™ 
.
™™ 
Add
™™ 
(
™™ 
new
™™ "
EnderecoServico
™™# 2
(
™™2 3

ServicoNFe
™™3 =
.
™™= >!
NfeConsultaCadastro
™™> Q
,
™™Q R
VersaoServico
™™S `
.
™™` a
ve200
™™a f
,
™™f g
TipoAmbiente
™™h t
.
™™t u

taProducao
™™u 
,™™ Ä
emissao™™Å à
,™™à â
	EstadoNfe™™ä ì
.™™ì î
RS™™î ñ
,™™ñ ó
ModeloDocumento™™ò ß
.™™ß ®
NFe™™® ´
,™™´ ¨
$str™™≠ ˝
)™™˝ ˛
)™™˛ ˇ
;™™ˇ Ä
if
´´ 
(
´´ 
emissao
´´ 
!=
´´ 
TipoEmissao
´´ *
.
´´* +
teEPEC
´´+ 1
)
´´1 2

endServico
¨¨ 
.
¨¨ 
AddRange
¨¨ '
(
¨¨' (
eventoCceCanc
¨¨( 5
.
¨¨5 6
Select
¨¨6 <
(
¨¨< =

servicoNFe
¨¨= G
=>
¨¨H J
new
¨¨K N
EnderecoServico
¨¨O ^
(
¨¨^ _

servicoNFe
¨¨_ i
,
¨¨i j
VersaoServico
¨¨k x
.
¨¨x y
ve100
¨¨y ~
,
¨¨~ 
TipoAmbiente¨¨Ä å
.¨¨å ç

taProducao¨¨ç ó
,¨¨ó ò
emissao¨¨ô †
,¨¨† °
	EstadoNfe¨¨¢ ´
.¨¨´ ¨
RS¨¨¨ Æ
,¨¨Æ Ø
ModeloDocumento¨¨∞ ø
.¨¨ø ¿
NFe¨¨¿ √
,¨¨√ ƒ
$str¨¨≈ ä
)¨¨ä ã
)¨¨ã å
)¨¨å ç
;¨¨ç é

endServico
≠≠ 
.
≠≠ 
Add
≠≠ 
(
≠≠ 
new
≠≠ "
EnderecoServico
≠≠# 2
(
≠≠2 3

ServicoNFe
≠≠3 =
.
≠≠= >
NfeInutilizacao
≠≠> M
,
≠≠M N
VersaoServico
≠≠O \
.
≠≠\ ]
ve310
≠≠] b
,
≠≠b c
TipoAmbiente
≠≠d p
.
≠≠p q

taProducao
≠≠q {
,
≠≠{ |
emissao≠≠} Ñ
,≠≠Ñ Ö
	EstadoNfe≠≠Ü è
.≠≠è ê
RS≠≠ê í
,≠≠í ì
ModeloDocumento≠≠î £
.≠≠£ §
NFe≠≠§ ß
,≠≠ß ®
$str≠≠© Ò
)≠≠Ò Ú
)≠≠Ú Û
;≠≠Û Ù

endServico
ÆÆ 
.
ÆÆ 
Add
ÆÆ 
(
ÆÆ 
new
ÆÆ "
EnderecoServico
ÆÆ# 2
(
ÆÆ2 3

ServicoNFe
ÆÆ3 =
.
ÆÆ= >"
NfeConsultaProtocolo
ÆÆ> R
,
ÆÆR S
VersaoServico
ÆÆT a
.
ÆÆa b
ve310
ÆÆb g
,
ÆÆg h
TipoAmbiente
ÆÆi u
.
ÆÆu v

taProducaoÆÆv Ä
,ÆÆÄ Å
emissaoÆÆÇ â
,ÆÆâ ä
	EstadoNfeÆÆã î
.ÆÆî ï
RSÆÆï ó
,ÆÆó ò
ModeloDocumentoÆÆô ®
.ÆÆ® ©
NFeÆÆ© ¨
,ÆÆ¨ ≠
$strÆÆÆ Ó
)ÆÆÓ Ô
)ÆÆÔ 
;ÆÆ Ò

endServico
ØØ 
.
ØØ 
Add
ØØ 
(
ØØ 
new
ØØ "
EnderecoServico
ØØ# 2
(
ØØ2 3

ServicoNFe
ØØ3 =
.
ØØ= >
NfeStatusServico
ØØ> N
,
ØØN O
VersaoServico
ØØP ]
.
ØØ] ^
ve310
ØØ^ c
,
ØØc d
TipoAmbiente
ØØe q
.
ØØq r

taProducao
ØØr |
,
ØØ| }
emissaoØØ~ Ö
,ØØÖ Ü
	EstadoNfeØØá ê
.ØØê ë
RSØØë ì
,ØØì î
ModeloDocumentoØØï §
.ØØ§ •
NFeØØ• ®
,ØØ® ©
$strØØ™ Ù
)ØØÙ ı
)ØØı ˆ
;ØØˆ ˜

endServico
∞∞ 
.
∞∞ 
Add
∞∞ 
(
∞∞ 
new
∞∞ "
EnderecoServico
∞∞# 2
(
∞∞2 3

ServicoNFe
∞∞3 =
.
∞∞= >
NFeAutorizacao
∞∞> L
,
∞∞L M
VersaoServico
∞∞N [
.
∞∞[ \
ve310
∞∞\ a
,
∞∞a b
TipoAmbiente
∞∞c o
.
∞∞o p

taProducao
∞∞p z
,
∞∞z {
emissao∞∞| É
,∞∞É Ñ
	EstadoNfe∞∞Ö é
.∞∞é è
RS∞∞è ë
,∞∞ë í
ModeloDocumento∞∞ì ¢
.∞∞¢ £
NFe∞∞£ ¶
,∞∞¶ ß
$str∞∞® Ì
)∞∞Ì Ó
)∞∞Ó Ô
;∞∞Ô 

endServico
±± 
.
±± 
Add
±± 
(
±± 
new
±± "
EnderecoServico
±±# 2
(
±±2 3

ServicoNFe
±±3 =
.
±±= >
NFeRetAutorizacao
±±> O
,
±±O P
VersaoServico
±±Q ^
.
±±^ _
ve310
±±_ d
,
±±d e
TipoAmbiente
±±f r
.
±±r s

taProducao
±±s }
,
±±} ~
emissao±± Ü
,±±Ü á
	EstadoNfe±±à ë
.±±ë í
RS±±í î
,±±î ï
ModeloDocumento±±ñ •
.±±• ¶
NFe±±¶ ©
,±±© ™
$str±±´ ˆ
)±±ˆ ˜
)±±˜ ¯
;±±¯ ˘

endServico
∑∑ 
.
∑∑ 
Add
∑∑ 
(
∑∑ 
new
∑∑ "
EnderecoServico
∑∑# 2
(
∑∑2 3

ServicoNFe
∑∑3 =
.
∑∑= >
NFeAutorizacao
∑∑> L
,
∑∑L M
VersaoServico
∑∑N [
.
∑∑[ \
ve310
∑∑\ a
,
∑∑a b
TipoAmbiente
∑∑c o
.
∑∑o p

taProducao
∑∑p z
,
∑∑z {
emissao∑∑| É
,∑∑É Ñ
	EstadoNfe∑∑Ö é
.∑∑é è
RS∑∑è ë
,∑∑ë í
ModeloDocumento∑∑ì ¢
.∑∑¢ £
NFCe∑∑£ ß
,∑∑ß ®
$str∑∑© Ô
)∑∑Ô 
)∑∑ Ò
;∑∑Ò Ú

endServico
∏∏ 
.
∏∏ 
Add
∏∏ 
(
∏∏ 
new
∏∏ "
EnderecoServico
∏∏# 2
(
∏∏2 3

ServicoNFe
∏∏3 =
.
∏∏= >
NFeRetAutorizacao
∏∏> O
,
∏∏O P
VersaoServico
∏∏Q ^
.
∏∏^ _
ve310
∏∏_ d
,
∏∏d e
TipoAmbiente
∏∏f r
.
∏∏r s

taProducao
∏∏s }
,
∏∏} ~
emissao∏∏ Ü
,∏∏Ü á
	EstadoNfe∏∏à ë
.∏∏ë í
RS∏∏í î
,∏∏î ï
ModeloDocumento∏∏ñ •
.∏∏• ¶
NFCe∏∏¶ ™
,∏∏™ ´
$str∏∏¨ ¯
)∏∏¯ ˘
)∏∏˘ ˙
;∏∏˙ ˚

endServico
ππ 
.
ππ 
Add
ππ 
(
ππ 
new
ππ "
EnderecoServico
ππ# 2
(
ππ2 3

ServicoNFe
ππ3 =
.
ππ= >
NfeInutilizacao
ππ> M
,
ππM N
VersaoServico
ππO \
.
ππ\ ]
ve310
ππ] b
,
ππb c
TipoAmbiente
ππd p
.
ππp q

taProducao
ππq {
,
ππ{ |
emissaoππ} Ñ
,ππÑ Ö
	EstadoNfeππÜ è
.ππè ê
RSππê í
,ππí ì
ModeloDocumentoππî £
.ππ£ §
NFCeππ§ ®
,ππ® ©
$strππ™ Û
)ππÛ Ù
)ππÙ ı
;ππı ˆ

endServico
∫∫ 
.
∫∫ 
Add
∫∫ 
(
∫∫ 
new
∫∫ "
EnderecoServico
∫∫# 2
(
∫∫2 3

ServicoNFe
∫∫3 =
.
∫∫= >"
NfeConsultaProtocolo
∫∫> R
,
∫∫R S
VersaoServico
∫∫T a
.
∫∫a b
ve310
∫∫b g
,
∫∫g h
TipoAmbiente
∫∫i u
.
∫∫u v

taProducao∫∫v Ä
,∫∫Ä Å
emissao∫∫Ç â
,∫∫â ä
	EstadoNfe∫∫ã î
.∫∫î ï
RS∫∫ï ó
,∫∫ó ò
ModeloDocumento∫∫ô ®
.∫∫® ©
NFCe∫∫© ≠
,∫∫≠ Æ
$str∫∫Ø 
)∫∫ Ò
)∫∫Ò Ú
;∫∫Ú Û

endServico
ªª 
.
ªª 
Add
ªª 
(
ªª 
new
ªª "
EnderecoServico
ªª# 2
(
ªª2 3

ServicoNFe
ªª3 =
.
ªª= >
NfeStatusServico
ªª> N
,
ªªN O
VersaoServico
ªªP ]
.
ªª] ^
ve310
ªª^ c
,
ªªc d
TipoAmbiente
ªªe q
.
ªªq r

taProducao
ªªr |
,
ªª| }
emissaoªª~ Ö
,ªªÖ Ü
	EstadoNfeªªá ê
.ªªê ë
RSªªë ì
,ªªì î
ModeloDocumentoªªï §
.ªª§ •
NFCeªª• ©
,ªª© ™
$strªª´ ˆ
)ªªˆ ˜
)ªª˜ ¯
;ªª¯ ˘

endServico
ºº 
.
ºº 
Add
ºº 
(
ºº 
new
ºº "
EnderecoServico
ºº# 2
(
ºº2 3

ServicoNFe
ºº3 =
.
ºº= >'
RecepcaoEventoCancelmento
ºº> W
,
ººW X
VersaoServico
ººY f
.
ººf g
ve100
ººg l
,
ººl m
TipoAmbiente
ººn z
.
ººz {

taProducaoºº{ Ö
,ººÖ Ü
emissaoººá é
,ººé è
	EstadoNfeººê ô
.ººô ö
RSººö ú
,ººú ù
ModeloDocumentoººû ≠
.ºº≠ Æ
NFCeººÆ ≤
,ºº≤ ≥
$strºº¥ ˙
)ºº˙ ˚
)ºº˚ ¸
;ºº¸ ˝
}
øø 
foreach
›› 
(
›› 
var
›› 
emissao
››  
in
››! #
emissaoComum
››$ 0
)
››0 1
{
ﬁﬁ 
if
‡‡ 
(
‡‡ 
emissao
‡‡ 
!=
‡‡ 
TipoEmissao
‡‡ *
.
‡‡* +
teEPEC
‡‡+ 1
)
‡‡1 2

endServico
·· 
.
·· 
AddRange
·· '
(
··' (
eventoCceCanc
··( 5
.
··5 6
Select
··6 <
(
··< =

servicoNFe
··= G
=>
··H J
new
··K N
EnderecoServico
··O ^
(
··^ _

servicoNFe
··_ i
,
··i j
VersaoServico
··k x
.
··x y
ve100
··y ~
,
··~ 
TipoAmbiente··Ä å
.··å ç
taHomologacao··ç ö
,··ö õ
emissao··ú £
,··£ §
	EstadoNfe··• Æ
.··Æ Ø
SP··Ø ±
,··± ≤
ModeloDocumento··≥ ¬
.··¬ √
NFe··√ ∆
,··∆ «
$str··» ä
)··ä ã
)··ã å
)··å ç
;··ç é

endServico
‚‚ 
.
‚‚ 
Add
‚‚ 
(
‚‚ 
new
‚‚ "
EnderecoServico
‚‚# 2
(
‚‚2 3

ServicoNFe
‚‚3 =
.
‚‚= >!
NfeConsultaCadastro
‚‚> Q
,
‚‚Q R
VersaoServico
‚‚S `
.
‚‚` a
ve200
‚‚a f
,
‚‚f g
TipoAmbiente
‚‚h t
.
‚‚t u
taHomologacao‚‚u Ç
,‚‚Ç É
emissao‚‚Ñ ã
,‚‚ã å
	EstadoNfe‚‚ç ñ
.‚‚ñ ó
SP‚‚ó ô
,‚‚ô ö
ModeloDocumento‚‚õ ™
.‚‚™ ´
NFe‚‚´ Æ
,‚‚Æ Ø
$str‚‚∞ ¯
)‚‚¯ ˘
)‚‚˘ ˙
;‚‚˙ ˚

endServico
„„ 
.
„„ 
Add
„„ 
(
„„ 
new
„„ "
EnderecoServico
„„# 2
(
„„2 3

ServicoNFe
„„3 =
.
„„= >
NfeInutilizacao
„„> M
,
„„M N
VersaoServico
„„O \
.
„„\ ]
ve310
„„] b
,
„„b c
TipoAmbiente
„„d p
.
„„p q
taHomologacao
„„q ~
,
„„~ 
emissao„„Ä á
,„„á à
	EstadoNfe„„â í
.„„í ì
SP„„ì ï
,„„ï ñ
ModeloDocumento„„ó ¶
.„„¶ ß
NFe„„ß ™
,„„™ ´
$str„„¨ 
)„„ Ò
)„„Ò Ú
;„„Ú Û

endServico
‰‰ 
.
‰‰ 
Add
‰‰ 
(
‰‰ 
new
‰‰ "
EnderecoServico
‰‰# 2
(
‰‰2 3

ServicoNFe
‰‰3 =
.
‰‰= >"
NfeConsultaProtocolo
‰‰> R
,
‰‰R S
VersaoServico
‰‰T a
.
‰‰a b
ve310
‰‰b g
,
‰‰g h
TipoAmbiente
‰‰i u
.
‰‰u v
taHomologacao‰‰v É
,‰‰É Ñ
emissao‰‰Ö å
,‰‰å ç
	EstadoNfe‰‰é ó
.‰‰ó ò
SP‰‰ò ö
,‰‰ö õ
ModeloDocumento‰‰ú ´
.‰‰´ ¨
NFe‰‰¨ Ø
,‰‰Ø ∞
$str‰‰± Ò
)‰‰Ò Ú
)‰‰Ú Û
;‰‰Û Ù

endServico
ÂÂ 
.
ÂÂ 
Add
ÂÂ 
(
ÂÂ 
new
ÂÂ "
EnderecoServico
ÂÂ# 2
(
ÂÂ2 3

ServicoNFe
ÂÂ3 =
.
ÂÂ= >
NfeStatusServico
ÂÂ> N
,
ÂÂN O
VersaoServico
ÂÂP ]
.
ÂÂ] ^
ve310
ÂÂ^ c
,
ÂÂc d
TipoAmbiente
ÂÂe q
.
ÂÂq r
taHomologacao
ÂÂr 
,ÂÂ Ä
emissaoÂÂÅ à
,ÂÂà â
	EstadoNfeÂÂä ì
.ÂÂì î
SPÂÂî ñ
,ÂÂñ ó
ModeloDocumentoÂÂò ß
.ÂÂß ®
NFeÂÂ® ´
,ÂÂ´ ¨
$strÂÂ≠ Ú
)ÂÂÚ Û
)ÂÂÛ Ù
;ÂÂÙ ı

endServico
ÊÊ 
.
ÊÊ 
Add
ÊÊ 
(
ÊÊ 
new
ÊÊ "
EnderecoServico
ÊÊ# 2
(
ÊÊ2 3

ServicoNFe
ÊÊ3 =
.
ÊÊ= >
NFeAutorizacao
ÊÊ> L
,
ÊÊL M
VersaoServico
ÊÊN [
.
ÊÊ[ \
ve310
ÊÊ\ a
,
ÊÊa b
TipoAmbiente
ÊÊc o
.
ÊÊo p
taHomologacao
ÊÊp }
,
ÊÊ} ~
emissaoÊÊ Ü
,ÊÊÜ á
	EstadoNfeÊÊà ë
.ÊÊë í
SPÊÊí î
,ÊÊî ï
ModeloDocumentoÊÊñ •
.ÊÊ• ¶
NFeÊÊ¶ ©
,ÊÊ© ™
$strÊÊ´ Ì
)ÊÊÌ Ó
)ÊÊÓ Ô
;ÊÊÔ 

endServico
ÁÁ 
.
ÁÁ 
Add
ÁÁ 
(
ÁÁ 
new
ÁÁ "
EnderecoServico
ÁÁ# 2
(
ÁÁ2 3

ServicoNFe
ÁÁ3 =
.
ÁÁ= >
NFeRetAutorizacao
ÁÁ> O
,
ÁÁO P
VersaoServico
ÁÁQ ^
.
ÁÁ^ _
ve310
ÁÁ_ d
,
ÁÁd e
TipoAmbiente
ÁÁf r
.
ÁÁr s
taHomologacaoÁÁs Ä
,ÁÁÄ Å
emissaoÁÁÇ â
,ÁÁâ ä
	EstadoNfeÁÁã î
.ÁÁî ï
SPÁÁï ó
,ÁÁó ò
ModeloDocumentoÁÁô ®
.ÁÁ® ©
NFeÁÁ© ¨
,ÁÁ¨ ≠
$strÁÁÆ Û
)ÁÁÛ Ù
)ÁÁÙ ı
;ÁÁı ˆ

endServico
ÌÌ 
.
ÌÌ 
Add
ÌÌ 
(
ÌÌ 
new
ÌÌ "
EnderecoServico
ÌÌ# 2
(
ÌÌ2 3

ServicoNFe
ÌÌ3 =
.
ÌÌ= >
NFeAutorizacao
ÌÌ> L
,
ÌÌL M
VersaoServico
ÌÌN [
.
ÌÌ[ \
ve310
ÌÌ\ a
,
ÌÌa b
TipoAmbiente
ÌÌc o
.
ÌÌo p
taHomologacao
ÌÌp }
,
ÌÌ} ~
emissaoÌÌ Ü
,ÌÌÜ á
	EstadoNfeÌÌà ë
.ÌÌë í
SPÌÌí î
,ÌÌî ï
ModeloDocumentoÌÌñ •
.ÌÌ• ¶
NFCeÌÌ¶ ™
,ÌÌ™ ´
$strÌÌ¨ Ô
)ÌÌÔ 
)ÌÌ Ò
;ÌÌÒ Ú

endServico
ÓÓ 
.
ÓÓ 
Add
ÓÓ 
(
ÓÓ 
new
ÓÓ "
EnderecoServico
ÓÓ# 2
(
ÓÓ2 3

ServicoNFe
ÓÓ3 =
.
ÓÓ= >
NFeRetAutorizacao
ÓÓ> O
,
ÓÓO P
VersaoServico
ÓÓQ ^
.
ÓÓ^ _
ve310
ÓÓ_ d
,
ÓÓd e
TipoAmbiente
ÓÓf r
.
ÓÓr s
taHomologacaoÓÓs Ä
,ÓÓÄ Å
emissaoÓÓÇ â
,ÓÓâ ä
	EstadoNfeÓÓã î
.ÓÓî ï
SPÓÓï ó
,ÓÓó ò
ModeloDocumentoÓÓô ®
.ÓÓ® ©
NFCeÓÓ© ≠
,ÓÓ≠ Æ
$strÓÓØ ı
)ÓÓı ˆ
)ÓÓˆ ˜
;ÓÓ˜ ¯

endServico
ÔÔ 
.
ÔÔ 
Add
ÔÔ 
(
ÔÔ 
new
ÔÔ "
EnderecoServico
ÔÔ# 2
(
ÔÔ2 3

ServicoNFe
ÔÔ3 =
.
ÔÔ= >
NfeInutilizacao
ÔÔ> M
,
ÔÔM N
VersaoServico
ÔÔO \
.
ÔÔ\ ]
ve310
ÔÔ] b
,
ÔÔb c
TipoAmbiente
ÔÔd p
.
ÔÔp q
taHomologacao
ÔÔq ~
,
ÔÔ~ 
emissaoÔÔÄ á
,ÔÔá à
	EstadoNfeÔÔâ í
.ÔÔí ì
SPÔÔì ï
,ÔÔï ñ
ModeloDocumentoÔÔó ¶
.ÔÔ¶ ß
NFCeÔÔß ´
,ÔÔ´ ¨
$strÔÔ≠ Ú
)ÔÔÚ Û
)ÔÔÛ Ù
;ÔÔÙ ı

endServico
 
.
 
Add
 
(
 
new
 "
EnderecoServico
# 2
(
2 3

ServicoNFe
3 =
.
= >"
NfeConsultaProtocolo
> R
,
R S
VersaoServico
T a
.
a b
ve310
b g
,
g h
TipoAmbiente
i u
.
u v
taHomologacaov É
,É Ñ
emissaoÖ å
,å ç
	EstadoNfeé ó
.ó ò
SPò ö
,ö õ
ModeloDocumentoú ´
.´ ¨
NFCe¨ ∞
,∞ ±
$str≤ Û
)Û Ù
)Ù ı
;ı ˆ
if
ÚÚ 
(
ÚÚ 
emissao
ÚÚ 
!=
ÚÚ 
TipoEmissao
ÚÚ *
.
ÚÚ* +
teEPEC
ÚÚ+ 1
)
ÚÚ1 2

endServico
ÛÛ 
.
ÛÛ 
Add
ÛÛ "
(
ÛÛ" #
new
ÛÛ# &
EnderecoServico
ÛÛ' 6
(
ÛÛ6 7

ServicoNFe
ÛÛ7 A
.
ÛÛA B'
RecepcaoEventoCancelmento
ÛÛB [
,
ÛÛ[ \
VersaoServico
ÛÛ] j
.
ÛÛj k
ve100
ÛÛk p
,
ÛÛp q
TipoAmbiente
ÛÛr ~
.
ÛÛ~ 
taHomologacaoÛÛ å
,ÛÛå ç
emissaoÛÛé ï
,ÛÛï ñ
	EstadoNfeÛÛó †
.ÛÛ† °
SPÛÛ° £
,ÛÛ£ §
ModeloDocumentoÛÛ• ¥
.ÛÛ¥ µ
NFCeÛÛµ π
,ÛÛπ ∫
$strÛÛª ˛
)ÛÛ˛ ˇ
)ÛÛˇ Ä
;ÛÛÄ Å
else
ÙÙ 

endServico
ıı 
.
ıı 
Add
ıı "
(
ıı" #
new
ıı# &
EnderecoServico
ıı' 6
(
ıı6 7

ServicoNFe
ıı7 A
.
ııA B 
RecepcaoEventoEpec
ııB T
,
ııT U
VersaoServico
ııV c
.
ııc d
ve100
ııd i
,
ııi j
TipoAmbiente
ıık w
.
ııw x
taHomologacaoııx Ö
,ııÖ Ü
emissaoııá é
,ııé è
	EstadoNfeııê ô
.ııô ö
SPııö ú
,ııú ù
ModeloDocumentoııû ≠
.ıı≠ Æ
NFCeııÆ ≤
,ıı≤ ≥
$strıı¥ ˛
)ıı˛ ˇ
)ııˇ Ä
;ııÄ Å

endServico
ˆˆ 
.
ˆˆ 
Add
ˆˆ 
(
ˆˆ 
new
ˆˆ "
EnderecoServico
ˆˆ# 2
(
ˆˆ2 3

ServicoNFe
ˆˆ3 =
.
ˆˆ= >
NfeStatusServico
ˆˆ> N
,
ˆˆN O
VersaoServico
ˆˆP ]
.
ˆˆ] ^
ve310
ˆˆ^ c
,
ˆˆc d
TipoAmbiente
ˆˆe q
.
ˆˆq r
taHomologacao
ˆˆr 
,ˆˆ Ä
emissaoˆˆÅ à
,ˆˆà â
	EstadoNfeˆˆä ì
.ˆˆì î
SPˆˆî ñ
,ˆˆñ ó
ModeloDocumentoˆˆò ß
.ˆˆß ®
NFCeˆˆ® ¨
,ˆˆ¨ ≠
$strˆˆÆ Ù
)ˆˆÙ ı
)ˆˆı ˆ
;ˆˆˆ ˜
}
˘˘ 
foreach
ˇˇ 
(
ˇˇ 
var
ˇˇ 
emissao
ˇˇ  
in
ˇˇ! #
emissaoComum
ˇˇ$ 0
)
ˇˇ0 1
{
ÄÄ 
if
ÉÉ 
(
ÉÉ 
emissao
ÉÉ 
!=
ÉÉ 
TipoEmissao
ÉÉ *
.
ÉÉ* +
teEPEC
ÉÉ+ 1
)
ÉÉ1 2

endServico
ÑÑ 
.
ÑÑ 
AddRange
ÑÑ '
(
ÑÑ' (
eventoCceCanc
ÑÑ( 5
.
ÑÑ5 6
Select
ÑÑ6 <
(
ÑÑ< =

servicoNFe
ÑÑ= G
=>
ÑÑH J
new
ÑÑK N
EnderecoServico
ÑÑO ^
(
ÑÑ^ _

servicoNFe
ÑÑ_ i
,
ÑÑi j
VersaoServico
ÑÑk x
.
ÑÑx y
ve100
ÑÑy ~
,
ÑÑ~ 
TipoAmbienteÑÑÄ å
.ÑÑå ç

taProducaoÑÑç ó
,ÑÑó ò
emissaoÑÑô †
,ÑÑ† °
	EstadoNfeÑÑ¢ ´
.ÑÑ´ ¨
SPÑÑ¨ Æ
,ÑÑÆ Ø
ModeloDocumentoÑÑ∞ ø
.ÑÑø ¿
NFeÑÑ¿ √
,ÑÑ√ ƒ
$strÑÑ≈ ˚
)ÑÑ˚ ¸
)ÑÑ¸ ˝
)ÑÑ˝ ˛
;ÑÑ˛ ˇ

endServico
ÖÖ 
.
ÖÖ 
Add
ÖÖ 
(
ÖÖ 
new
ÖÖ "
EnderecoServico
ÖÖ# 2
(
ÖÖ2 3

ServicoNFe
ÖÖ3 =
.
ÖÖ= >!
NfeConsultaCadastro
ÖÖ> Q
,
ÖÖQ R
VersaoServico
ÖÖS `
.
ÖÖ` a
ve200
ÖÖa f
,
ÖÖf g
TipoAmbiente
ÖÖh t
.
ÖÖt u

taProducao
ÖÖu 
,ÖÖ Ä
emissaoÖÖÅ à
,ÖÖà â
	EstadoNfeÖÖä ì
.ÖÖì î
SPÖÖî ñ
,ÖÖñ ó
ModeloDocumentoÖÖò ß
.ÖÖß ®
NFeÖÖ® ´
,ÖÖ´ ¨
$strÖÖ≠ È
)ÖÖÈ Í
)ÖÖÍ Î
;ÖÖÎ Ï

endServico
ÜÜ 
.
ÜÜ 
Add
ÜÜ 
(
ÜÜ 
new
ÜÜ "
EnderecoServico
ÜÜ# 2
(
ÜÜ2 3

ServicoNFe
ÜÜ3 =
.
ÜÜ= >
NfeInutilizacao
ÜÜ> M
,
ÜÜM N
VersaoServico
ÜÜO \
.
ÜÜ\ ]
ve310
ÜÜ] b
,
ÜÜb c
TipoAmbiente
ÜÜd p
.
ÜÜp q

taProducao
ÜÜq {
,
ÜÜ{ |
emissaoÜÜ} Ñ
,ÜÜÑ Ö
	EstadoNfeÜÜÜ è
.ÜÜè ê
SPÜÜê í
,ÜÜí ì
ModeloDocumentoÜÜî £
.ÜÜ£ §
NFeÜÜ§ ß
,ÜÜß ®
$strÜÜ© ·
)ÜÜ· ‚
)ÜÜ‚ „
;ÜÜ„ ‰

endServico
áá 
.
áá 
Add
áá 
(
áá 
new
áá "
EnderecoServico
áá# 2
(
áá2 3

ServicoNFe
áá3 =
.
áá= >"
NfeConsultaProtocolo
áá> R
,
ááR S
VersaoServico
ááT a
.
ááa b
ve310
ááb g
,
áág h
TipoAmbiente
áái u
.
ááu v

taProducaoááv Ä
,ááÄ Å
emissaoááÇ â
,ááâ ä
	EstadoNfeááã î
.ááî ï
SPááï ó
,ááó ò
ModeloDocumentoááô ®
.áá® ©
NFeáá© ¨
,áá¨ ≠
$strááÆ ‚
)áá‚ „
)áá„ ‰
;áá‰ Â

endServico
àà 
.
àà 
Add
àà 
(
àà 
new
àà "
EnderecoServico
àà# 2
(
àà2 3

ServicoNFe
àà3 =
.
àà= >
NfeStatusServico
àà> N
,
ààN O
VersaoServico
ààP ]
.
àà] ^
ve310
àà^ c
,
ààc d
TipoAmbiente
ààe q
.
ààq r

taProducao
ààr |
,
àà| }
emissaoàà~ Ö
,ààÖ Ü
	EstadoNfeààá ê
.ààê ë
SPààë ì
,ààì î
ModeloDocumentoààï §
.àà§ •
NFeàà• ®
,àà® ©
$stràà™ „
)àà„ ‰
)àà‰ Â
;ààÂ Ê

endServico
ââ 
.
ââ 
Add
ââ 
(
ââ 
new
ââ "
EnderecoServico
ââ# 2
(
ââ2 3

ServicoNFe
ââ3 =
.
ââ= >
NFeAutorizacao
ââ> L
,
ââL M
VersaoServico
ââN [
.
ââ[ \
ve310
ââ\ a
,
ââa b
TipoAmbiente
ââc o
.
ââo p

taProducao
ââp z
,
ââz {
emissaoââ| É
,ââÉ Ñ
	EstadoNfeââÖ é
.ââé è
SPââè ë
,ââë í
ModeloDocumentoââì ¢
.ââ¢ £
NFeââ£ ¶
,ââ¶ ß
$strââ® ﬁ
)ââﬁ ﬂ
)ââﬂ ‡
;ââ‡ ·

endServico
ää 
.
ää 
Add
ää 
(
ää 
new
ää "
EnderecoServico
ää# 2
(
ää2 3

ServicoNFe
ää3 =
.
ää= >
NFeRetAutorizacao
ää> O
,
ääO P
VersaoServico
ääQ ^
.
ää^ _
ve310
ää_ d
,
ääd e
TipoAmbiente
ääf r
.
äär s

taProducao
ääs }
,
ää} ~
emissaoää Ü
,ääÜ á
	EstadoNfeääà ë
.ääë í
SPääí î
,ääî ï
ModeloDocumentoääñ •
.ää• ¶
NFeää¶ ©
,ää© ™
$strää´ ‰
)ää‰ Â
)ääÂ Ê
;ääÊ Á

endServico
êê 
.
êê 
Add
êê 
(
êê 
new
êê "
EnderecoServico
êê# 2
(
êê2 3

ServicoNFe
êê3 =
.
êê= >
NFeAutorizacao
êê> L
,
êêL M
VersaoServico
êêN [
.
êê[ \
ve310
êê\ a
,
êêa b
TipoAmbiente
êêc o
.
êêo p

taProducao
êêp z
,
êêz {
emissaoêê| É
,êêÉ Ñ
	EstadoNfeêêÖ é
.êêé è
SPêêè ë
,êêë í
ModeloDocumentoêêì ¢
.êê¢ £
NFCeêê£ ß
,êêß ®
$strêê© ‡
)êê‡ ·
)êê· ‚
;êê‚ „

endServico
ëë 
.
ëë 
Add
ëë 
(
ëë 
new
ëë "
EnderecoServico
ëë# 2
(
ëë2 3

ServicoNFe
ëë3 =
.
ëë= >
NFeRetAutorizacao
ëë> O
,
ëëO P
VersaoServico
ëëQ ^
.
ëë^ _
ve310
ëë_ d
,
ëëd e
TipoAmbiente
ëëf r
.
ëër s

taProducao
ëës }
,
ëë} ~
emissaoëë Ü
,ëëÜ á
	EstadoNfeëëà ë
.ëëë í
SPëëí î
,ëëî ï
ModeloDocumentoëëñ •
.ëë• ¶
NFCeëë¶ ™
,ëë™ ´
$strëë¨ Ê
)ëëÊ Á
)ëëÁ Ë
;ëëË È

endServico
íí 
.
íí 
Add
íí 
(
íí 
new
íí "
EnderecoServico
íí# 2
(
íí2 3

ServicoNFe
íí3 =
.
íí= >
NfeInutilizacao
íí> M
,
ííM N
VersaoServico
ííO \
.
íí\ ]
ve310
íí] b
,
ííb c
TipoAmbiente
ííd p
.
ííp q

taProducao
ííq {
,
íí{ |
emissaoíí} Ñ
,ííÑ Ö
	EstadoNfeííÜ è
.ííè ê
SPííê í
,ííí ì
ModeloDocumentoííî £
.íí£ §
NFCeíí§ ®
,íí® ©
$stríí™ „
)íí„ ‰
)íí‰ Â
;ííÂ Ê

endServico
ìì 
.
ìì 
Add
ìì 
(
ìì 
new
ìì "
EnderecoServico
ìì# 2
(
ìì2 3

ServicoNFe
ìì3 =
.
ìì= >"
NfeConsultaProtocolo
ìì> R
,
ììR S
VersaoServico
ììT a
.
ììa b
ve310
ììb g
,
ììg h
TipoAmbiente
ììi u
.
ììu v

taProducaoììv Ä
,ììÄ Å
emissaoììÇ â
,ììâ ä
	EstadoNfeììã î
.ììî ï
SPììï ó
,ììó ò
ModeloDocumentoììô ®
.ìì® ©
NFCeìì© ≠
,ìì≠ Æ
$strììØ ‰
)ìì‰ Â
)ììÂ Ê
;ììÊ Á
if
ïï 
(
ïï 
emissao
ïï 
!=
ïï 
TipoEmissao
ïï *
.
ïï* +
teEPEC
ïï+ 1
)
ïï1 2

endServico
ññ 
.
ññ 
Add
ññ "
(
ññ" #
new
ññ# &
EnderecoServico
ññ' 6
(
ññ6 7

ServicoNFe
ññ7 A
.
ññA B'
RecepcaoEventoCancelmento
ññB [
,
ññ[ \
VersaoServico
ññ] j
.
ññj k
ve100
ññk p
,
ññp q
TipoAmbiente
ññr ~
.
ññ~ 

taProducaoññ â
,ññâ ä
emissaoññã í
,ññí ì
	EstadoNfeññî ù
.ññù û
SPññû †
,ññ† °
ModeloDocumentoññ¢ ±
.ññ± ≤
NFCeññ≤ ∂
,ññ∂ ∑
$strññ∏ Ô
)ññÔ 
)ññ Ò
;ññÒ Ú
else
óó 

endServico
òò 
.
òò 
Add
òò "
(
òò" #
new
òò# &
EnderecoServico
òò' 6
(
òò6 7

ServicoNFe
òò7 A
.
òòA B 
RecepcaoEventoEpec
òòB T
,
òòT U
VersaoServico
òòV c
.
òòc d
ve100
òòd i
,
òòi j
TipoAmbiente
òòk w
.
òòw x

taProducaoòòx Ç
,òòÇ É
emissaoòòÑ ã
,òòã å
	EstadoNfeòòç ñ
.òòñ ó
SPòòó ô
,òòô ö
ModeloDocumentoòòõ ™
.òò™ ´
NFCeòò´ Ø
,òòØ ∞
$stròò± Ô
)òòÔ 
)òò Ò
;òòÒ Ú

endServico
ôô 
.
ôô 
Add
ôô 
(
ôô 
new
ôô "
EnderecoServico
ôô# 2
(
ôô2 3

ServicoNFe
ôô3 =
.
ôô= >
NfeStatusServico
ôô> N
,
ôôN O
VersaoServico
ôôP ]
.
ôô] ^
ve310
ôô^ c
,
ôôc d
TipoAmbiente
ôôe q
.
ôôq r

taProducao
ôôr |
,
ôô| }
emissaoôô~ Ö
,ôôÖ Ü
	EstadoNfeôôá ê
.ôôê ë
SPôôë ì
,ôôì î
ModeloDocumentoôôï §
.ôô§ •
NFCeôô• ©
,ôô© ™
$strôô´ Â
)ôôÂ Ê
)ôôÊ Á
;ôôÁ Ë
}
úú 
foreach
ÆÆ 
(
ÆÆ 
var
ÆÆ 
estado
ÆÆ 
in
ÆÆ  "
svanEstados
ÆÆ# .
)
ÆÆ. /
{
ØØ 
foreach
∞∞ 
(
∞∞ 
var
∞∞ 
emissao
∞∞ $
in
∞∞% '
emissaoComum
∞∞( 4
)
∞∞4 5
{
±± 
if
≤≤ 
(
≤≤ 
emissao
≤≤ 
!=
≤≤  "
TipoEmissao
≤≤# .
.
≤≤. /
teEPEC
≤≤/ 5
)
≤≤5 6

endServico
≥≥ "
.
≥≥" #
AddRange
≥≥# +
(
≥≥+ ,
eventoCceCanc
≥≥, 9
.
≥≥9 :
Select
≥≥: @
(
≥≥@ A

servicoNFe
≥≥A K
=>
≥≥L N
new
≥≥O R
EnderecoServico
≥≥S b
(
≥≥b c

servicoNFe
≥≥c m
,
≥≥m n
VersaoServico
≥≥o |
.
≥≥| }
ve100≥≥} Ç
,≥≥Ç É
TipoAmbiente≥≥Ñ ê
.≥≥ê ë
taHomologacao≥≥ë û
,≥≥û ü
emissao≥≥† ß
,≥≥ß ®
estado≥≥© Ø
,≥≥Ø ∞
ModeloDocumento≥≥± ¿
.≥≥¿ ¡
NFe≥≥¡ ƒ
,≥≥ƒ ≈
$str≥≥∆ í
)≥≥í ì
)≥≥ì î
)≥≥î ï
;≥≥ï ñ

endServico
¥¥ 
.
¥¥ 
Add
¥¥ "
(
¥¥" #
new
¥¥# &
EnderecoServico
¥¥' 6
(
¥¥6 7

ServicoNFe
¥¥7 A
.
¥¥A B
NfeInutilizacao
¥¥B Q
,
¥¥Q R
VersaoServico
¥¥S `
.
¥¥` a
ve310
¥¥a f
,
¥¥f g
TipoAmbiente
¥¥h t
.
¥¥t u
taHomologacao¥¥u Ç
,¥¥Ç É
emissao¥¥Ñ ã
,¥¥ã å
estado¥¥ç ì
,¥¥ì î
ModeloDocumento¥¥ï §
.¥¥§ •
NFe¥¥• ®
,¥¥® ©
$str¥¥™ ˙
)¥¥˙ ˚
)¥¥˚ ¸
;¥¥¸ ˝

endServico
µµ 
.
µµ 
Add
µµ "
(
µµ" #
new
µµ# &
EnderecoServico
µµ' 6
(
µµ6 7

ServicoNFe
µµ7 A
.
µµA B"
NfeConsultaProtocolo
µµB V
,
µµV W
VersaoServico
µµX e
.
µµe f
ve310
µµf k
,
µµk l
TipoAmbiente
µµm y
.
µµy z
taHomologacaoµµz á
,µµá à
emissaoµµâ ê
,µµê ë
estadoµµí ò
,µµò ô
ModeloDocumentoµµö ©
.µµ© ™
NFeµµ™ ≠
,µµ≠ Æ
$strµµØ ˜
)µµ˜ ¯
)µµ¯ ˘
;µµ˘ ˙

endServico
∂∂ 
.
∂∂ 
Add
∂∂ "
(
∂∂" #
new
∂∂# &
EnderecoServico
∂∂' 6
(
∂∂6 7

ServicoNFe
∂∂7 A
.
∂∂A B
NfeStatusServico
∂∂B R
,
∂∂R S
VersaoServico
∂∂T a
.
∂∂a b
ve310
∂∂b g
,
∂∂g h
TipoAmbiente
∂∂i u
.
∂∂u v
taHomologacao∂∂v É
,∂∂É Ñ
emissao∂∂Ö å
,∂∂å ç
estado∂∂é î
,∂∂î ï
ModeloDocumento∂∂ñ •
.∂∂• ¶
NFe∂∂¶ ©
,∂∂© ™
$str∂∂´ ˝
)∂∂˝ ˛
)∂∂˛ ˇ
;∂∂ˇ Ä

endServico
∑∑ 
.
∑∑ 
Add
∑∑ "
(
∑∑" #
new
∑∑# &
EnderecoServico
∑∑' 6
(
∑∑6 7

ServicoNFe
∑∑7 A
.
∑∑A B
NfeDownloadNF
∑∑B O
,
∑∑O P
VersaoServico
∑∑Q ^
.
∑∑^ _
ve310
∑∑_ d
,
∑∑d e
TipoAmbiente
∑∑f r
.
∑∑r s
taHomologacao∑∑s Ä
,∑∑Ä Å
emissao∑∑Ç â
,∑∑â ä
estado∑∑ã ë
,∑∑ë í
ModeloDocumento∑∑ì ¢
.∑∑¢ £
NFe∑∑£ ¶
,∑∑¶ ß
$str∑∑® Ú
)∑∑Ú Û
)∑∑Û Ù
;∑∑Ù ı

endServico
∏∏ 
.
∏∏ 
Add
∏∏ "
(
∏∏" #
new
∏∏# &
EnderecoServico
∏∏' 6
(
∏∏6 7

ServicoNFe
∏∏7 A
.
∏∏A B
NFeAutorizacao
∏∏B P
,
∏∏P Q
VersaoServico
∏∏R _
.
∏∏_ `
ve310
∏∏` e
,
∏∏e f
TipoAmbiente
∏∏g s
.
∏∏s t
taHomologacao∏∏t Å
,∏∏Å Ç
emissao∏∏É ä
,∏∏ä ã
estado∏∏å í
,∏∏í ì
ModeloDocumento∏∏î £
.∏∏£ §
NFe∏∏§ ß
,∏∏ß ®
$str∏∏© ı
)∏∏ı ˆ
)∏∏ˆ ˜
;∏∏˜ ¯

endServico
ππ 
.
ππ 
Add
ππ "
(
ππ" #
new
ππ# &
EnderecoServico
ππ' 6
(
ππ6 7

ServicoNFe
ππ7 A
.
ππA B
NFeRetAutorizacao
ππB S
,
ππS T
VersaoServico
ππU b
.
ππb c
ve310
ππc h
,
ππh i
TipoAmbiente
ππj v
.
ππv w
taHomologacaoππw Ñ
,ππÑ Ö
emissaoππÜ ç
,ππç é
estadoππè ï
,ππï ñ
ModeloDocumentoππó ¶
.ππ¶ ß
NFeππß ™
,ππ™ ´
$strππ¨ ˛
)ππ˛ ˇ
)ππˇ Ä
;ππÄ Å
}
∫∫ 
}
ªª 
foreach
¡¡ 
(
¡¡ 
var
¡¡ 
estado
¡¡ 
in
¡¡  "
svanEstados
¡¡# .
)
¡¡. /
{
¬¬ 
foreach
√√ 
(
√√ 
var
√√ 
emissao
√√ $
in
√√% '
emissaoComum
√√( 4
)
√√4 5
{
ƒƒ 
if
≈≈ 
(
≈≈ 
emissao
≈≈ 
!=
≈≈  "
TipoEmissao
≈≈# .
.
≈≈. /
teEPEC
≈≈/ 5
)
≈≈5 6

endServico
∆∆ "
.
∆∆" #
AddRange
∆∆# +
(
∆∆+ ,
eventoCceCanc
∆∆, 9
.
∆∆9 :
Select
∆∆: @
(
∆∆@ A

servicoNFe
∆∆A K
=>
∆∆L N
new
∆∆O R
EnderecoServico
∆∆S b
(
∆∆b c

servicoNFe
∆∆c m
,
∆∆m n
VersaoServico
∆∆o |
.
∆∆| }
ve100∆∆} Ç
,∆∆Ç É
TipoAmbiente∆∆Ñ ê
.∆∆ê ë

taProducao∆∆ë õ
,∆∆õ ú
emissao∆∆ù §
,∆∆§ •
estado∆∆¶ ¨
,∆∆¨ ≠
ModeloDocumento∆∆Æ Ω
.∆∆Ω æ
NFe∆∆æ ¡
,∆∆¡ ¬
$str∆∆√ è
)∆∆è ê
)∆∆ê ë
)∆∆ë í
;∆∆í ì

endServico
«« 
.
«« 
Add
«« "
(
««" #
new
««# &
EnderecoServico
««' 6
(
««6 7

ServicoNFe
««7 A
.
««A B
NfeInutilizacao
««B Q
,
««Q R
VersaoServico
««S `
.
««` a
ve310
««a f
,
««f g
TipoAmbiente
««h t
.
««t u

taProducao
««u 
,«« Ä
emissao««Å à
,««à â
estado««ä ê
,««ê ë
ModeloDocumento««í °
.««° ¢
NFe««¢ •
,««• ¶
$str««ß ˜
)««˜ ¯
)««¯ ˘
;««˘ ˙

endServico
»» 
.
»» 
Add
»» "
(
»»" #
new
»»# &
EnderecoServico
»»' 6
(
»»6 7

ServicoNFe
»»7 A
.
»»A B"
NfeConsultaProtocolo
»»B V
,
»»V W
VersaoServico
»»X e
.
»»e f
ve310
»»f k
,
»»k l
TipoAmbiente
»»m y
.
»»y z

taProducao»»z Ñ
,»»Ñ Ö
emissao»»Ü ç
,»»ç é
estado»»è ï
,»»ï ñ
ModeloDocumento»»ó ¶
.»»¶ ß
NFe»»ß ™
,»»™ ´
$str»»¨ Ù
)»»Ù ı
)»»ı ˆ
;»»ˆ ˜

endServico
…… 
.
…… 
Add
…… "
(
……" #
new
……# &
EnderecoServico
……' 6
(
……6 7

ServicoNFe
……7 A
.
……A B
NfeStatusServico
……B R
,
……R S
VersaoServico
……T a
.
……a b
ve310
……b g
,
……g h
TipoAmbiente
……i u
.
……u v

taProducao……v Ä
,……Ä Å
emissao……Ç â
,……â ä
estado……ã ë
,……ë í
ModeloDocumento……ì ¢
.……¢ £
NFe……£ ¶
,……¶ ß
$str……® ˙
)……˙ ˚
)……˚ ¸
;……¸ ˝

endServico
   
.
   
Add
   "
(
  " #
new
  # &
EnderecoServico
  ' 6
(
  6 7

ServicoNFe
  7 A
.
  A B
NfeDownloadNF
  B O
,
  O P
VersaoServico
  Q ^
.
  ^ _
ve310
  _ d
,
  d e
TipoAmbiente
  f r
.
  r s

taProducao
  s }
,
  } ~
emissao   Ü
,  Ü á
estado  à é
,  é è
ModeloDocumento  ê ü
.  ü †
NFe  † £
,  £ §
$str  • Ô
)  Ô 
)   Ò
;  Ò Ú

endServico
ÀÀ 
.
ÀÀ 
Add
ÀÀ "
(
ÀÀ" #
new
ÀÀ# &
EnderecoServico
ÀÀ' 6
(
ÀÀ6 7

ServicoNFe
ÀÀ7 A
.
ÀÀA B
NFeAutorizacao
ÀÀB P
,
ÀÀP Q
VersaoServico
ÀÀR _
.
ÀÀ_ `
ve310
ÀÀ` e
,
ÀÀe f
TipoAmbiente
ÀÀg s
.
ÀÀs t

taProducao
ÀÀt ~
,
ÀÀ~ 
emissaoÀÀÄ á
,ÀÀá à
estadoÀÀâ è
,ÀÀè ê
ModeloDocumentoÀÀë †
.ÀÀ† °
NFeÀÀ° §
,ÀÀ§ •
$strÀÀ¶ Ú
)ÀÀÚ Û
)ÀÀÛ Ù
;ÀÀÙ ı

endServico
ÃÃ 
.
ÃÃ 
Add
ÃÃ "
(
ÃÃ" #
new
ÃÃ# &
EnderecoServico
ÃÃ' 6
(
ÃÃ6 7

ServicoNFe
ÃÃ7 A
.
ÃÃA B
NFeRetAutorizacao
ÃÃB S
,
ÃÃS T
VersaoServico
ÃÃU b
.
ÃÃb c
ve310
ÃÃc h
,
ÃÃh i
TipoAmbiente
ÃÃj v
.
ÃÃv w

taProducaoÃÃw Å
,ÃÃÅ Ç
emissaoÃÃÉ ä
,ÃÃä ã
estadoÃÃå í
,ÃÃí ì
ModeloDocumentoÃÃî £
.ÃÃ£ §
NFeÃÃ§ ß
,ÃÃß ®
$strÃÃ© ˚
)ÃÃ˚ ¸
)ÃÃ¸ ˝
;ÃÃ˝ ˛
}
ÕÕ 
}
ŒŒ 
foreach
⁄⁄ 
(
⁄⁄ 
var
⁄⁄ 
estado
⁄⁄ 
in
⁄⁄  "'
svrsEstadosDemaisServicos
⁄⁄# <
)
⁄⁄< =
{
€€ 
foreach
‹‹ 
(
‹‹ 
var
‹‹ 
emissao
‹‹ $
in
‹‹% '
emissaoComum
‹‹( 4
)
‹‹4 5
{
›› 
if
‡‡ 
(
‡‡ 
estado
‡‡ 
!=
‡‡ !
	EstadoNfe
‡‡" +
.
‡‡+ ,
BA
‡‡, .
&
‡‡/ 0
estado
‡‡1 7
!=
‡‡8 :
	EstadoNfe
‡‡; D
.
‡‡D E
MA
‡‡E G
&
‡‡H I
estado
‡‡J P
!=
‡‡Q S
	EstadoNfe
‡‡T ]
.
‡‡] ^
PA
‡‡^ `
&
‡‡a b
estado
‡‡c i
!=
‡‡j l
	EstadoNfe
‡‡m v
.
‡‡v w
PI
‡‡w y
)
‡‡y z
{
·· 
if
‚‚ 
(
‚‚ 
emissao
‚‚ #
!=
‚‚$ &
TipoEmissao
‚‚' 2
.
‚‚2 3
teEPEC
‚‚3 9
)
‚‚9 :

endServico
„„ &
.
„„& '
AddRange
„„' /
(
„„/ 0
eventoCceCanc
„„0 =
.
„„= >
Select
„„> D
(
„„D E

servicoNFe
„„E O
=>
„„P R
new
„„S V
EnderecoServico
„„W f
(
„„f g

servicoNFe
„„g q
,
„„q r
VersaoServico„„s Ä
.„„Ä Å
ve100„„Å Ü
,„„Ü á
TipoAmbiente„„à î
.„„î ï
taHomologacao„„ï ¢
,„„¢ £
emissao„„§ ´
,„„´ ¨
estado„„≠ ≥
,„„≥ ¥
ModeloDocumento„„µ ƒ
.„„ƒ ≈
NFe„„≈ »
,„„» …
$str„„  ò
)„„ò ô
)„„ô ö
)„„ö õ
;„„õ ú

endServico
‰‰ "
.
‰‰" #
Add
‰‰# &
(
‰‰& '
new
‰‰' *
EnderecoServico
‰‰+ :
(
‰‰: ;

ServicoNFe
‰‰; E
.
‰‰E F
NfeInutilizacao
‰‰F U
,
‰‰U V
VersaoServico
‰‰W d
.
‰‰d e
ve310
‰‰e j
,
‰‰j k
TipoAmbiente
‰‰l x
.
‰‰x y
taHomologacao‰‰y Ü
,‰‰Ü á
emissao‰‰à è
,‰‰è ê
estado‰‰ë ó
,‰‰ó ò
ModeloDocumento‰‰ô ®
.‰‰® ©
NFe‰‰© ¨
,‰‰¨ ≠
$str‰‰Æ ˇ
)‰‰ˇ Ä
)‰‰Ä Å
;‰‰Å Ç

endServico
ÂÂ "
.
ÂÂ" #
Add
ÂÂ# &
(
ÂÂ& '
new
ÂÂ' *
EnderecoServico
ÂÂ+ :
(
ÂÂ: ;

ServicoNFe
ÂÂ; E
.
ÂÂE F"
NfeConsultaProtocolo
ÂÂF Z
,
ÂÂZ [
VersaoServico
ÂÂ\ i
.
ÂÂi j
ve310
ÂÂj o
,
ÂÂo p
TipoAmbiente
ÂÂq }
.
ÂÂ} ~
taHomologacaoÂÂ~ ã
,ÂÂã å
emissaoÂÂç î
,ÂÂî ï
estadoÂÂñ ú
,ÂÂú ù
ModeloDocumentoÂÂû ≠
.ÂÂ≠ Æ
NFeÂÂÆ ±
,ÂÂ± ≤
$strÂÂ≥ ¸
)ÂÂ¸ ˝
)ÂÂ˝ ˛
;ÂÂ˛ ˇ

endServico
ÊÊ "
.
ÊÊ" #
Add
ÊÊ# &
(
ÊÊ& '
new
ÊÊ' *
EnderecoServico
ÊÊ+ :
(
ÊÊ: ;

ServicoNFe
ÊÊ; E
.
ÊÊE F
NfeStatusServico
ÊÊF V
,
ÊÊV W
VersaoServico
ÊÊX e
.
ÊÊe f
ve310
ÊÊf k
,
ÊÊk l
TipoAmbiente
ÊÊm y
.
ÊÊy z
taHomologacaoÊÊz á
,ÊÊá à
emissaoÊÊâ ê
,ÊÊê ë
estadoÊÊí ò
,ÊÊò ô
ModeloDocumentoÊÊö ©
.ÊÊ© ™
NFeÊÊ™ ≠
,ÊÊ≠ Æ
$strÊÊØ Ç
)ÊÊÇ É
)ÊÊÉ Ñ
;ÊÊÑ Ö

endServico
ÁÁ "
.
ÁÁ" #
Add
ÁÁ# &
(
ÁÁ& '
new
ÁÁ' *
EnderecoServico
ÁÁ+ :
(
ÁÁ: ;

ServicoNFe
ÁÁ; E
.
ÁÁE F
NFeAutorizacao
ÁÁF T
,
ÁÁT U
VersaoServico
ÁÁV c
.
ÁÁc d
ve310
ÁÁd i
,
ÁÁi j
TipoAmbiente
ÁÁk w
.
ÁÁw x
taHomologacaoÁÁx Ö
,ÁÁÖ Ü
emissaoÁÁá é
,ÁÁé è
estadoÁÁê ñ
,ÁÁñ ó
ModeloDocumentoÁÁò ß
.ÁÁß ®
NFeÁÁ® ´
,ÁÁ´ ¨
$strÁÁ≠ ˚
)ÁÁ˚ ¸
)ÁÁ¸ ˝
;ÁÁ˝ ˛

endServico
ËË "
.
ËË" #
Add
ËË# &
(
ËË& '
new
ËË' *
EnderecoServico
ËË+ :
(
ËË: ;

ServicoNFe
ËË; E
.
ËËE F
NFeRetAutorizacao
ËËF W
,
ËËW X
VersaoServico
ËËY f
.
ËËf g
ve310
ËËg l
,
ËËl m
TipoAmbiente
ËËn z
.
ËËz {
taHomologacaoËË{ à
,ËËà â
emissaoËËä ë
,ËËë í
estadoËËì ô
,ËËô ö
ModeloDocumentoËËõ ™
.ËË™ ´
NFeËË´ Æ
,ËËÆ Ø
$strËË∞ Ñ
)ËËÑ Ö
)ËËÖ Ü
;ËËÜ á
}
ÈÈ 

endServico
ÔÔ 
.
ÔÔ 
Add
ÔÔ "
(
ÔÔ" #
new
ÔÔ# &
EnderecoServico
ÔÔ' 6
(
ÔÔ6 7

ServicoNFe
ÔÔ7 A
.
ÔÔA B
NFeAutorizacao
ÔÔB P
,
ÔÔP Q
VersaoServico
ÔÔR _
.
ÔÔ_ `
ve310
ÔÔ` e
,
ÔÔe f
TipoAmbiente
ÔÔg s
.
ÔÔs t
taHomologacaoÔÔt Å
,ÔÔÅ Ç
emissaoÔÔÉ ä
,ÔÔä ã
estadoÔÔå í
,ÔÔí ì
ModeloDocumentoÔÔî £
.ÔÔ£ §
NFCeÔÔ§ ®
,ÔÔ® ©
$strÔÔ™ ˘
)ÔÔ˘ ˙
)ÔÔ˙ ˚
;ÔÔ˚ ¸

endServico
 
.
 
Add
 "
(
" #
new
# &
EnderecoServico
' 6
(
6 7

ServicoNFe
7 A
.
A B
NFeRetAutorizacao
B S
,
S T
VersaoServico
U b
.
b c
ve310
c h
,
h i
TipoAmbiente
j v
.
v w
taHomologacaow Ñ
,Ñ Ö
emissaoÜ ç
,ç é
estadoè ï
,ï ñ
ModeloDocumentoó ¶
.¶ ß
NFCeß ´
,´ ¨
$str≠ Ç
)Ç É
)É Ñ
;Ñ Ö

endServico
ÒÒ 
.
ÒÒ 
Add
ÒÒ "
(
ÒÒ" #
new
ÒÒ# &
EnderecoServico
ÒÒ' 6
(
ÒÒ6 7

ServicoNFe
ÒÒ7 A
.
ÒÒA B
NfeInutilizacao
ÒÒB Q
,
ÒÒQ R
VersaoServico
ÒÒS `
.
ÒÒ` a
ve310
ÒÒa f
,
ÒÒf g
TipoAmbiente
ÒÒh t
.
ÒÒt u
taHomologacaoÒÒu Ç
,ÒÒÇ É
emissaoÒÒÑ ã
,ÒÒã å
estadoÒÒç ì
,ÒÒì î
ModeloDocumentoÒÒï §
.ÒÒ§ •
NFCeÒÒ• ©
,ÒÒ© ™
$strÒÒ´ ˝
)ÒÒ˝ ˛
)ÒÒ˛ ˇ
;ÒÒˇ Ä

endServico
ÚÚ 
.
ÚÚ 
Add
ÚÚ "
(
ÚÚ" #
new
ÚÚ# &
EnderecoServico
ÚÚ' 6
(
ÚÚ6 7

ServicoNFe
ÚÚ7 A
.
ÚÚA B"
NfeConsultaProtocolo
ÚÚB V
,
ÚÚV W
VersaoServico
ÚÚX e
.
ÚÚe f
ve310
ÚÚf k
,
ÚÚk l
TipoAmbiente
ÚÚm y
.
ÚÚy z
taHomologacaoÚÚz á
,ÚÚá à
emissaoÚÚâ ê
,ÚÚê ë
estadoÚÚí ò
,ÚÚò ô
ModeloDocumentoÚÚö ©
.ÚÚ© ™
NFCeÚÚ™ Æ
,ÚÚÆ Ø
$strÚÚ∞ ˙
)ÚÚ˙ ˚
)ÚÚ˚ ¸
;ÚÚ¸ ˝

endServico
ÛÛ 
.
ÛÛ 
Add
ÛÛ "
(
ÛÛ" #
new
ÛÛ# &
EnderecoServico
ÛÛ' 6
(
ÛÛ6 7

ServicoNFe
ÛÛ7 A
.
ÛÛA B
NfeStatusServico
ÛÛB R
,
ÛÛR S
VersaoServico
ÛÛT a
.
ÛÛa b
ve310
ÛÛb g
,
ÛÛg h
TipoAmbiente
ÛÛi u
.
ÛÛu v
taHomologacaoÛÛv É
,ÛÛÉ Ñ
emissaoÛÛÖ å
,ÛÛå ç
estadoÛÛé î
,ÛÛî ï
ModeloDocumentoÛÛñ •
.ÛÛ• ¶
NFCeÛÛ¶ ™
,ÛÛ™ ´
$strÛÛ¨ Ä
)ÛÛÄ Å
)ÛÛÅ Ç
;ÛÛÇ É

endServico
ÙÙ 
.
ÙÙ 
Add
ÙÙ "
(
ÙÙ" #
new
ÙÙ# &
EnderecoServico
ÙÙ' 6
(
ÙÙ6 7

ServicoNFe
ÙÙ7 A
.
ÙÙA B'
RecepcaoEventoCancelmento
ÙÙB [
,
ÙÙ[ \
VersaoServico
ÙÙ] j
.
ÙÙj k
ve100
ÙÙk p
,
ÙÙp q
TipoAmbiente
ÙÙr ~
.
ÙÙ~ 
taHomologacaoÙÙ å
,ÙÙå ç
emissaoÙÙé ï
,ÙÙï ñ
estadoÙÙó ù
,ÙÙù û
ModeloDocumentoÙÙü Æ
.ÙÙÆ Ø
NFCeÙÙØ ≥
,ÙÙ≥ ¥
$strÙÙµ Ñ
)ÙÙÑ Ö
)ÙÙÖ Ü
;ÙÙÜ á
}
˜˜ 
}
¯¯ 
foreach
˙˙ 
(
˙˙ 
var
˙˙ 
estado
˙˙ 
in
˙˙  ")
svrsEstadosConsultaCadastro
˙˙# >
)
˙˙> ?
{
˚˚ 
foreach
¸¸ 
(
¸¸ 
var
¸¸ 
emissao
¸¸ $
in
¸¸% '
emissaoComum
¸¸( 4
)
¸¸4 5
{
˝˝ 
foreach
˛˛ 
(
˛˛ 
var
˛˛  
modelo
˛˛! '
in
˛˛( *
todosOsModelos
˛˛+ 9
)
˛˛9 :
{
ˇˇ 

endServico
ÄÄ "
.
ÄÄ" #
Add
ÄÄ# &
(
ÄÄ& '
new
ÄÄ' *
EnderecoServico
ÄÄ+ :
(
ÄÄ: ;

ServicoNFe
ÄÄ; E
.
ÄÄE F!
NfeConsultaCadastro
ÄÄF Y
,
ÄÄY Z
VersaoServico
ÄÄ[ h
.
ÄÄh i
ve200
ÄÄi n
,
ÄÄn o
TipoAmbiente
ÄÄp |
.
ÄÄ| }
taHomologacaoÄÄ} ä
,ÄÄä ã
emissaoÄÄå ì
,ÄÄì î
estadoÄÄï õ
,ÄÄõ ú
modeloÄÄù £
,ÄÄ£ §
$strÄÄ• ˛
)ÄÄ˛ ˇ
)ÄÄˇ Ä
;ÄÄÄ Å
}
ÅÅ 
}
ÇÇ 
}
ÉÉ 
foreach
ââ 
(
ââ 
var
ââ 
estado
ââ 
in
ââ  "'
svrsEstadosDemaisServicos
ââ# <
)
ââ< =
{
ää 
foreach
ãã 
(
ãã 
var
ãã 
emissao
ãã $
in
ãã% '
emissaoComum
ãã( 4
)
ãã4 5
{
åå 
if
êê 
(
êê 
estado
êê 
!=
êê !
	EstadoNfe
êê" +
.
êê+ ,
BA
êê, .
&
êê/ 0
estado
êê1 7
!=
êê8 :
	EstadoNfe
êê; D
.
êêD E
MA
êêE G
&
êêH I
estado
êêJ P
!=
êêQ S
	EstadoNfe
êêT ]
.
êê] ^
PA
êê^ `
&
êêa b
estado
êêc i
!=
êêj l
	EstadoNfe
êêm v
.
êêv w
PI
êêw y
)
êêy z
{
ëë 
if
íí 
(
íí 
emissao
íí #
!=
íí$ &
TipoEmissao
íí' 2
.
íí2 3
teEPEC
íí3 9
)
íí9 :

endServico
ìì &
.
ìì& '
AddRange
ìì' /
(
ìì/ 0
eventoCceCanc
ìì0 =
.
ìì= >
Select
ìì> D
(
ììD E

servicoNFe
ììE O
=>
ììP R
new
ììS V
EnderecoServico
ììW f
(
ììf g

servicoNFe
ììg q
,
ììq r
VersaoServicoììs Ä
.ììÄ Å
ve100ììÅ Ü
,ììÜ á
TipoAmbienteììà î
.ììî ï

taProducaoììï ü
,ììü †
emissaoìì° ®
,ìì® ©
estadoìì™ ∞
,ìì∞ ±
ModeloDocumentoìì≤ ¡
.ìì¡ ¬
NFeìì¬ ≈
,ìì≈ ∆
$strìì« â
)ììâ ä
)ììä ã
)ììã å
;ììå ç

endServico
îî "
.
îî" #
Add
îî# &
(
îî& '
new
îî' *
EnderecoServico
îî+ :
(
îî: ;

ServicoNFe
îî; E
.
îîE F
NfeInutilizacao
îîF U
,
îîU V
VersaoServico
îîW d
.
îîd e
ve310
îîe j
,
îîj k
TipoAmbiente
îîl x
.
îîx y

taProducaoîîy É
,îîÉ Ñ
emissaoîîÖ å
,îîå ç
estadoîîé î
,îîî ï
ModeloDocumentoîîñ •
.îî• ¶
NFeîî¶ ©
,îî© ™
$strîî´ 
)îî Ò
)îîÒ Ú
;îîÚ Û

endServico
ïï "
.
ïï" #
Add
ïï# &
(
ïï& '
new
ïï' *
EnderecoServico
ïï+ :
(
ïï: ;

ServicoNFe
ïï; E
.
ïïE F"
NfeConsultaProtocolo
ïïF Z
,
ïïZ [
VersaoServico
ïï\ i
.
ïïi j
ve310
ïïj o
,
ïïo p
TipoAmbiente
ïïq }
.
ïï} ~

taProducaoïï~ à
,ïïà â
emissaoïïä ë
,ïïë í
estadoïïì ô
,ïïô ö
ModeloDocumentoïïõ ™
.ïï™ ´
NFeïï´ Æ
,ïïÆ Ø
$strïï∞ Ì
)ïïÌ Ó
)ïïÓ Ô
;ïïÔ 

endServico
ññ "
.
ññ" #
Add
ññ# &
(
ññ& '
new
ññ' *
EnderecoServico
ññ+ :
(
ññ: ;

ServicoNFe
ññ; E
.
ññE F
NfeStatusServico
ññF V
,
ññV W
VersaoServico
ññX e
.
ññe f
ve310
ññf k
,
ññk l
TipoAmbiente
ññm y
.
ññy z

taProducaoññz Ñ
,ññÑ Ö
emissaoññÜ ç
,ññç é
estadoññè ï
,ññï ñ
ModeloDocumentoññó ¶
.ññ¶ ß
NFeññß ™
,ññ™ ´
$strññ¨ Û
)ññÛ Ù
)ññÙ ı
;ññı ˆ

endServico
óó "
.
óó" #
Add
óó# &
(
óó& '
new
óó' *
EnderecoServico
óó+ :
(
óó: ;

ServicoNFe
óó; E
.
óóE F
NFeAutorizacao
óóF T
,
óóT U
VersaoServico
óóV c
.
óóc d
ve310
óód i
,
óói j
TipoAmbiente
óók w
.
óów x

taProducaoóóx Ç
,óóÇ É
emissaoóóÑ ã
,óóã å
estadoóóç ì
,óóì î
ModeloDocumentoóóï §
.óó§ •
NFeóó• ®
,óó® ©
$stróó™ Ï
)óóÏ Ì
)óóÌ Ó
;óóÓ Ô

endServico
òò "
.
òò" #
Add
òò# &
(
òò& '
new
òò' *
EnderecoServico
òò+ :
(
òò: ;

ServicoNFe
òò; E
.
òòE F
NFeRetAutorizacao
òòF W
,
òòW X
VersaoServico
òòY f
.
òòf g
ve310
òòg l
,
òòl m
TipoAmbiente
òòn z
.
òòz {

taProducaoòò{ Ö
,òòÖ Ü
emissaoòòá é
,òòé è
estadoòòê ñ
,òòñ ó
ModeloDocumentoòòò ß
.òòß ®
NFeòò® ´
,òò´ ¨
$stròò≠ ı
)òòı ˆ
)òòˆ ˜
;òò˜ ¯
}
ôô 

endServico
üü 
.
üü 
Add
üü "
(
üü" #
new
üü# &
EnderecoServico
üü' 6
(
üü6 7

ServicoNFe
üü7 A
.
üüA B
NFeAutorizacao
üüB P
,
üüP Q
VersaoServico
üüR _
.
üü_ `
ve310
üü` e
,
üüe f
TipoAmbiente
üüg s
.
üüs t

taProducao
üüt ~
,
üü~ 
emissaoüüÄ á
,üüá à
estadoüüâ è
,üüè ê
ModeloDocumentoüüë †
.üü† °
NFCeüü° •
,üü• ¶
$strüüß Í
)üüÍ Î
)üüÎ Ï
;üüÏ Ì

endServico
†† 
.
†† 
Add
†† "
(
††" #
new
††# &
EnderecoServico
††' 6
(
††6 7

ServicoNFe
††7 A
.
††A B
NFeRetAutorizacao
††B S
,
††S T
VersaoServico
††U b
.
††b c
ve310
††c h
,
††h i
TipoAmbiente
††j v
.
††v w

taProducao††w Å
,††Å Ç
emissao††É ä
,††ä ã
estado††å í
,††í ì
ModeloDocumento††î £
.††£ §
NFCe††§ ®
,††® ©
$str††™ Û
)††Û Ù
)††Ù ı
;††ı ˆ

endServico
°° 
.
°° 
Add
°° "
(
°°" #
new
°°# &
EnderecoServico
°°' 6
(
°°6 7

ServicoNFe
°°7 A
.
°°A B
NfeInutilizacao
°°B Q
,
°°Q R
VersaoServico
°°S `
.
°°` a
ve310
°°a f
,
°°f g
TipoAmbiente
°°h t
.
°°t u

taProducao
°°u 
,°° Ä
emissao°°Å à
,°°à â
estado°°ä ê
,°°ê ë
ModeloDocumento°°í °
.°°° ¢
NFCe°°¢ ¶
,°°¶ ß
$str°°® Ó
)°°Ó Ô
)°°Ô 
;°° Ò

endServico
¢¢ 
.
¢¢ 
Add
¢¢ "
(
¢¢" #
new
¢¢# &
EnderecoServico
¢¢' 6
(
¢¢6 7

ServicoNFe
¢¢7 A
.
¢¢A B"
NfeConsultaProtocolo
¢¢B V
,
¢¢V W
VersaoServico
¢¢X e
.
¢¢e f
ve310
¢¢f k
,
¢¢k l
TipoAmbiente
¢¢m y
.
¢¢y z

taProducao¢¢z Ñ
,¢¢Ñ Ö
emissao¢¢Ü ç
,¢¢ç é
estado¢¢è ï
,¢¢ï ñ
ModeloDocumento¢¢ó ¶
.¢¢¶ ß
NFCe¢¢ß ´
,¢¢´ ¨
$str¢¢≠ Î
)¢¢Î Ï
)¢¢Ï Ì
;¢¢Ì Ó

endServico
££ 
.
££ 
Add
££ "
(
££" #
new
££# &
EnderecoServico
££' 6
(
££6 7

ServicoNFe
££7 A
.
££A B
NfeStatusServico
££B R
,
££R S
VersaoServico
££T a
.
££a b
ve310
££b g
,
££g h
TipoAmbiente
££i u
.
££u v

taProducao££v Ä
,££Ä Å
emissao££Ç â
,££â ä
estado££ã ë
,££ë í
ModeloDocumento££ì ¢
.££¢ £
NFCe£££ ß
,££ß ®
$str££© Ò
)££Ò Ú
)££Ú Û
;££Û Ù

endServico
§§ 
.
§§ 
Add
§§ "
(
§§" #
new
§§# &
EnderecoServico
§§' 6
(
§§6 7

ServicoNFe
§§7 A
.
§§A B'
RecepcaoEventoCancelmento
§§B [
,
§§[ \
VersaoServico
§§] j
.
§§j k
ve100
§§k p
,
§§p q
TipoAmbiente
§§r ~
.
§§~ 

taProducao§§ â
,§§â ä
emissao§§ã í
,§§í ì
estado§§î ö
,§§ö õ
ModeloDocumento§§ú ´
.§§´ ¨
NFCe§§¨ ∞
,§§∞ ±
$str§§≤ ı
)§§ı ˆ
)§§ˆ ˜
;§§˜ ¯
}
ßß 
}
®® 
foreach
™™ 
(
™™ 
var
™™ 
estado
™™ 
in
™™  ")
svrsEstadosConsultaCadastro
™™# >
)
™™> ?
{
´´ 
foreach
¨¨ 
(
¨¨ 
var
¨¨ 
emissao
¨¨ $
in
¨¨% '
emissaoComum
¨¨( 4
)
¨¨4 5
{
≠≠ 
foreach
ÆÆ 
(
ÆÆ 
var
ÆÆ  
modelo
ÆÆ! '
in
ÆÆ( *
todosOsModelos
ÆÆ+ 9
)
ÆÆ9 :
{
ØØ 

endServico
±± "
.
±±" #
Add
±±# &
(
±±& '
new
±±' *
EnderecoServico
±±+ :
(
±±: ;

ServicoNFe
±±; E
.
±±E F!
NfeConsultaCadastro
±±F Y
,
±±Y Z
VersaoServico
±±[ h
.
±±h i
ve200
±±i n
,
±±n o
TipoAmbiente
±±p |
.
±±| }

taProducao±±} á
,±±á à
emissao±±â ê
,±±ê ë
estado±±í ò
,±±ò ô
modelo±±ö †
,±±† °
$str±±¢ Ô
)±±Ô 
)±± Ò
;±±Ò Ú
}
≤≤ 
}
≥≥ 
}
¥¥ 
foreach
¿¿ 
(
¿¿ 
var
¿¿ 
estado
¿¿ 
in
¿¿  "
svcanEstados
¿¿# /
)
¿¿/ 0
{
¡¡ 

endServico
¬¬ 
.
¬¬ 
AddRange
¬¬ #
(
¬¬# $
eventoCceCanc
¬¬$ 1
.
¬¬1 2
Select
¬¬2 8
(
¬¬8 9

servicoNFe
¬¬9 C
=>
¬¬D F
new
¬¬G J
EnderecoServico
¬¬K Z
(
¬¬Z [

servicoNFe
¬¬[ e
,
¬¬e f
VersaoServico
¬¬g t
.
¬¬t u
ve100
¬¬u z
,
¬¬z {
TipoAmbiente¬¬| à
.¬¬à â
taHomologacao¬¬â ñ
,¬¬ñ ó
TipoEmissao¬¬ò £
.¬¬£ §
teSVCAN¬¬§ ´
,¬¬´ ¨
estado¬¬≠ ≥
,¬¬≥ ¥
ModeloDocumento¬¬µ ƒ
.¬¬ƒ ≈
NFe¬¬≈ »
,¬¬» …
$str¬¬  ç
)¬¬ç é
)¬¬é è
)¬¬è ê
;¬¬ê ë

endServico
√√ 
.
√√ 
Add
√√ 
(
√√ 
new
√√ "
EnderecoServico
√√# 2
(
√√2 3

ServicoNFe
√√3 =
.
√√= >'
RecepcaoEventoCancelmento
√√> W
,
√√W X
VersaoServico
√√Y f
.
√√f g
ve100
√√g l
,
√√l m
TipoAmbiente
√√n z
.
√√z {
taHomologacao√√{ à
,√√à â
TipoEmissao√√ä ï
.√√ï ñ
teSVCAN√√ñ ù
,√√ù û
estado√√ü •
,√√• ¶
ModeloDocumento√√ß ∂
.√√∂ ∑
NFCe√√∑ ª
,√√ª º
$str√√Ω Ä
)√√Ä Å
)√√Å Ç
;√√Ç É
foreach
ƒƒ 
(
ƒƒ 
var
ƒƒ 
modelo
ƒƒ #
in
ƒƒ$ &
todosOsModelos
ƒƒ' 5
)
ƒƒ5 6
{
≈≈ 

endServico
∆∆ 
.
∆∆ 
Add
∆∆ "
(
∆∆" #
new
∆∆# &
EnderecoServico
∆∆' 6
(
∆∆6 7

ServicoNFe
∆∆7 A
.
∆∆A B"
NfeConsultaProtocolo
∆∆B V
,
∆∆V W
VersaoServico
∆∆X e
.
∆∆e f
ve310
∆∆f k
,
∆∆k l
TipoAmbiente
∆∆m y
.
∆∆y z
taHomologacao∆∆z á
,∆∆á à
TipoEmissao∆∆â î
.∆∆î ï
teSVCAN∆∆ï ú
,∆∆ú ù
estado∆∆û §
,∆∆§ •
modelo∆∆¶ ¨
,∆∆¨ ≠
$str∆∆Æ Ì
)∆∆Ì Ó
)∆∆Ó Ô
;∆∆Ô 

endServico
«« 
.
«« 
Add
«« "
(
««" #
new
««# &
EnderecoServico
««' 6
(
««6 7

ServicoNFe
««7 A
.
««A B
NfeStatusServico
««B R
,
««R S
VersaoServico
««T a
.
««a b
ve310
««b g
,
««g h
TipoAmbiente
««i u
.
««u v
taHomologacao««v É
,««É Ñ
TipoEmissao««Ö ê
.««ê ë
teSVCAN««ë ò
,««ò ô
estado««ö †
,««† °
modelo««¢ ®
,««® ©
$str««™ Û
)««Û Ù
)««Ù ı
;««ı ˆ

endServico
»» 
.
»» 
Add
»» "
(
»»" #
new
»»# &
EnderecoServico
»»' 6
(
»»6 7

ServicoNFe
»»7 A
.
»»A B
NFeAutorizacao
»»B P
,
»»P Q
VersaoServico
»»R _
.
»»_ `
ve310
»»` e
,
»»e f
TipoAmbiente
»»g s
.
»»s t
taHomologacao»»t Å
,»»Å Ç
TipoEmissao»»É é
.»»é è
teSVCAN»»è ñ
,»»ñ ó
estado»»ò û
,»»û ü
modelo»»† ¶
,»»¶ ß
$str»»® Î
)»»Î Ï
)»»Ï Ì
;»»Ì Ó

endServico
…… 
.
…… 
Add
…… "
(
……" #
new
……# &
EnderecoServico
……' 6
(
……6 7

ServicoNFe
……7 A
.
……A B
NFeRetAutorizacao
……B S
,
……S T
VersaoServico
……U b
.
……b c
ve310
……c h
,
……h i
TipoAmbiente
……j v
.
……v w
taHomologacao……w Ñ
,……Ñ Ö
TipoEmissao……Ü ë
.……ë í
teSVCAN……í ô
,……ô ö
estado……õ °
,……° ¢
modelo……£ ©
,……© ™
$str……´ Ù
)……Ù ı
)……ı ˆ
;……ˆ ˜
}
   
}
ÀÀ 
foreach
—— 
(
—— 
var
—— 
estado
—— 
in
——  "
svcanEstados
——# /
)
——/ 0
{
““ 

endServico
”” 
.
”” 
AddRange
”” #
(
””# $
eventoCceCanc
””$ 1
.
””1 2
Select
””2 8
(
””8 9

servicoNFe
””9 C
=>
””D F
new
””G J
EnderecoServico
””K Z
(
””Z [

servicoNFe
””[ e
,
””e f
VersaoServico
””g t
.
””t u
ve100
””u z
,
””z {
TipoAmbiente””| à
.””à â

taProducao””â ì
,””ì î
TipoEmissao””ï †
.””† °
teSVCAN””° ®
,””® ©
estado””™ ∞
,””∞ ±
ModeloDocumento””≤ ¡
.””¡ ¬
NFe””¬ ≈
,””≈ ∆
$str””« ä
)””ä ã
)””ã å
)””å ç
;””ç é

endServico
‘‘ 
.
‘‘ 
Add
‘‘ 
(
‘‘ 
new
‘‘ "
EnderecoServico
‘‘# 2
(
‘‘2 3

ServicoNFe
‘‘3 =
.
‘‘= >'
RecepcaoEventoCancelmento
‘‘> W
,
‘‘W X
VersaoServico
‘‘Y f
.
‘‘f g
ve100
‘‘g l
,
‘‘l m
TipoAmbiente
‘‘n z
.
‘‘z {

taProducao‘‘{ Ö
,‘‘Ö Ü
TipoEmissao‘‘á í
.‘‘í ì
teSVCAN‘‘ì ö
,‘‘ö õ
estado‘‘ú ¢
,‘‘¢ £
ModeloDocumento‘‘§ ≥
.‘‘≥ ¥
NFCe‘‘¥ ∏
,‘‘∏ π
$str‘‘∫ ˝
)‘‘˝ ˛
)‘‘˛ ˇ
;‘‘ˇ Ä
foreach
’’ 
(
’’ 
var
’’ 
modelo
’’ #
in
’’$ &
todosOsModelos
’’' 5
)
’’5 6
{
÷÷ 

endServico
◊◊ 
.
◊◊ 
Add
◊◊ "
(
◊◊" #
new
◊◊# &
EnderecoServico
◊◊' 6
(
◊◊6 7

ServicoNFe
◊◊7 A
.
◊◊A B"
NfeConsultaProtocolo
◊◊B V
,
◊◊V W
VersaoServico
◊◊X e
.
◊◊e f
ve310
◊◊f k
,
◊◊k l
TipoAmbiente
◊◊m y
.
◊◊y z

taProducao◊◊z Ñ
,◊◊Ñ Ö
TipoEmissao◊◊Ü ë
.◊◊ë í
teSVCAN◊◊í ô
,◊◊ô ö
estado◊◊õ °
,◊◊° ¢
modelo◊◊£ ©
,◊◊© ™
$str◊◊´ Í
)◊◊Í Î
)◊◊Î Ï
;◊◊Ï Ì

endServico
ÿÿ 
.
ÿÿ 
Add
ÿÿ "
(
ÿÿ" #
new
ÿÿ# &
EnderecoServico
ÿÿ' 6
(
ÿÿ6 7

ServicoNFe
ÿÿ7 A
.
ÿÿA B
NfeStatusServico
ÿÿB R
,
ÿÿR S
VersaoServico
ÿÿT a
.
ÿÿa b
ve310
ÿÿb g
,
ÿÿg h
TipoAmbiente
ÿÿi u
.
ÿÿu v

taProducaoÿÿv Ä
,ÿÿÄ Å
TipoEmissaoÿÿÇ ç
.ÿÿç é
teSVCANÿÿé ï
,ÿÿï ñ
estadoÿÿó ù
,ÿÿù û
modeloÿÿü •
,ÿÿ• ¶
$strÿÿß 
)ÿÿ Ò
)ÿÿÒ Ú
;ÿÿÚ Û

endServico
ŸŸ 
.
ŸŸ 
Add
ŸŸ "
(
ŸŸ" #
new
ŸŸ# &
EnderecoServico
ŸŸ' 6
(
ŸŸ6 7

ServicoNFe
ŸŸ7 A
.
ŸŸA B
NFeAutorizacao
ŸŸB P
,
ŸŸP Q
VersaoServico
ŸŸR _
.
ŸŸ_ `
ve310
ŸŸ` e
,
ŸŸe f
TipoAmbiente
ŸŸg s
.
ŸŸs t

taProducao
ŸŸt ~
,
ŸŸ~ 
TipoEmissaoŸŸÄ ã
.ŸŸã å
teSVCANŸŸå ì
,ŸŸì î
estadoŸŸï õ
,ŸŸõ ú
modeloŸŸù £
,ŸŸ£ §
$strŸŸ• Ë
)ŸŸË È
)ŸŸÈ Í
;ŸŸÍ Î

endServico
⁄⁄ 
.
⁄⁄ 
Add
⁄⁄ "
(
⁄⁄" #
new
⁄⁄# &
EnderecoServico
⁄⁄' 6
(
⁄⁄6 7

ServicoNFe
⁄⁄7 A
.
⁄⁄A B
NFeRetAutorizacao
⁄⁄B S
,
⁄⁄S T
VersaoServico
⁄⁄U b
.
⁄⁄b c
ve310
⁄⁄c h
,
⁄⁄h i
TipoAmbiente
⁄⁄j v
.
⁄⁄v w

taProducao⁄⁄w Å
,⁄⁄Å Ç
TipoEmissao⁄⁄É é
.⁄⁄é è
teSVCAN⁄⁄è ñ
,⁄⁄ñ ó
estado⁄⁄ò û
,⁄⁄û ü
modelo⁄⁄† ¶
,⁄⁄¶ ß
$str⁄⁄® Ò
)⁄⁄Ò Ú
)⁄⁄Ú Û
;⁄⁄Û Ù
}
€€ 
}
‹‹ 
foreach
ËË 
(
ËË 
var
ËË 
estado
ËË 
in
ËË  "
svcRsEstados
ËË# /
)
ËË/ 0
{
ÈÈ 

endServico
ÍÍ 
.
ÍÍ 
AddRange
ÍÍ #
(
ÍÍ# $
eventoCceCanc
ÍÍ$ 1
.
ÍÍ1 2
Select
ÍÍ2 8
(
ÍÍ8 9

servicoNFe
ÍÍ9 C
=>
ÍÍD F
new
ÍÍG J
EnderecoServico
ÍÍK Z
(
ÍÍZ [

servicoNFe
ÍÍ[ e
,
ÍÍe f
VersaoServico
ÍÍg t
.
ÍÍt u
ve100
ÍÍu z
,
ÍÍz {
TipoAmbienteÍÍ| à
.ÍÍà â
taHomologacaoÍÍâ ñ
,ÍÍñ ó
TipoEmissaoÍÍò £
.ÍÍ£ §
teSVCRSÍÍ§ ´
,ÍÍ´ ¨
estadoÍÍ≠ ≥
,ÍÍ≥ ¥
ModeloDocumentoÍÍµ ƒ
.ÍÍƒ ≈
NFeÍÍ≈ »
,ÍÍ» …
$strÍÍ  ò
)ÍÍò ô
)ÍÍô ö
)ÍÍö õ
;ÍÍõ ú

endServico
ÎÎ 
.
ÎÎ 
Add
ÎÎ 
(
ÎÎ 
new
ÎÎ "
EnderecoServico
ÎÎ# 2
(
ÎÎ2 3

ServicoNFe
ÎÎ3 =
.
ÎÎ= >'
RecepcaoEventoCancelmento
ÎÎ> W
,
ÎÎW X
VersaoServico
ÎÎY f
.
ÎÎf g
ve100
ÎÎg l
,
ÎÎl m
TipoAmbiente
ÎÎn z
.
ÎÎz {
taHomologacaoÎÎ{ à
,ÎÎà â
TipoEmissaoÎÎä ï
.ÎÎï ñ
teSVCRSÎÎñ ù
,ÎÎù û
estadoÎÎü •
,ÎÎ• ¶
ModeloDocumentoÎÎß ∂
.ÎÎ∂ ∑
NFCeÎÎ∑ ª
,ÎÎª º
$strÎÎΩ ã
)ÎÎã å
)ÎÎå ç
;ÎÎç é
foreach
ÏÏ 
(
ÏÏ 
var
ÏÏ 
modelo
ÏÏ #
in
ÏÏ$ &
todosOsModelos
ÏÏ' 5
)
ÏÏ5 6
{
ÌÌ 

endServico
ÓÓ 
.
ÓÓ 
Add
ÓÓ "
(
ÓÓ" #
new
ÓÓ# &
EnderecoServico
ÓÓ' 6
(
ÓÓ6 7

ServicoNFe
ÓÓ7 A
.
ÓÓA B
NfeInutilizacao
ÓÓB Q
,
ÓÓQ R
VersaoServico
ÓÓS `
.
ÓÓ` a
ve310
ÓÓa f
,
ÓÓf g
TipoAmbiente
ÓÓh t
.
ÓÓt u
taHomologacaoÓÓu Ç
,ÓÓÇ É
TipoEmissaoÓÓÑ è
.ÓÓè ê
teSVCRSÓÓê ó
,ÓÓó ò
estadoÓÓô ü
,ÓÓü †
modeloÓÓ° ß
,ÓÓß ®
$strÓÓ© ˙
)ÓÓ˙ ˚
)ÓÓ˚ ¸
;ÓÓ¸ ˝

endServico
ÔÔ 
.
ÔÔ 
Add
ÔÔ "
(
ÔÔ" #
new
ÔÔ# &
EnderecoServico
ÔÔ' 6
(
ÔÔ6 7

ServicoNFe
ÔÔ7 A
.
ÔÔA B"
NfeConsultaProtocolo
ÔÔB V
,
ÔÔV W
VersaoServico
ÔÔX e
.
ÔÔe f
ve310
ÔÔf k
,
ÔÔk l
TipoAmbiente
ÔÔm y
.
ÔÔy z
taHomologacaoÔÔz á
,ÔÔá à
TipoEmissaoÔÔâ î
.ÔÔî ï
teSVCRSÔÔï ú
,ÔÔú ù
estadoÔÔû §
,ÔÔ§ •
modeloÔÔ¶ ¨
,ÔÔ¨ ≠
$strÔÔÆ ˜
)ÔÔ˜ ¯
)ÔÔ¯ ˘
;ÔÔ˘ ˙

endServico
 
.
 
Add
 "
(
" #
new
# &
EnderecoServico
' 6
(
6 7

ServicoNFe
7 A
.
A B
NfeStatusServico
B R
,
R S
VersaoServico
T a
.
a b
ve310
b g
,
g h
TipoAmbiente
i u
.
u v
taHomologacaov É
,É Ñ
TipoEmissaoÖ ê
.ê ë
teSVCRSë ò
,ò ô
estadoö †
,† °
modelo¢ ®
,® ©
$str™ ˝
)˝ ˛
)˛ ˇ
;ˇ Ä

endServico
ÒÒ 
.
ÒÒ 
Add
ÒÒ "
(
ÒÒ" #
new
ÒÒ# &
EnderecoServico
ÒÒ' 6
(
ÒÒ6 7

ServicoNFe
ÒÒ7 A
.
ÒÒA B
NFeAutorizacao
ÒÒB P
,
ÒÒP Q
VersaoServico
ÒÒR _
.
ÒÒ_ `
ve310
ÒÒ` e
,
ÒÒe f
TipoAmbiente
ÒÒg s
.
ÒÒs t
taHomologacaoÒÒt Å
,ÒÒÅ Ç
TipoEmissaoÒÒÉ é
.ÒÒé è
teSVCRSÒÒè ñ
,ÒÒñ ó
estadoÒÒò û
,ÒÒû ü
modeloÒÒ† ¶
,ÒÒ¶ ß
$strÒÒ® ˆ
)ÒÒˆ ˜
)ÒÒ˜ ¯
;ÒÒ¯ ˘

endServico
ÚÚ 
.
ÚÚ 
Add
ÚÚ "
(
ÚÚ" #
new
ÚÚ# &
EnderecoServico
ÚÚ' 6
(
ÚÚ6 7

ServicoNFe
ÚÚ7 A
.
ÚÚA B
NFeRetAutorizacao
ÚÚB S
,
ÚÚS T
VersaoServico
ÚÚU b
.
ÚÚb c
ve310
ÚÚc h
,
ÚÚh i
TipoAmbiente
ÚÚj v
.
ÚÚv w
taHomologacaoÚÚw Ñ
,ÚÚÑ Ö
TipoEmissaoÚÚÜ ë
.ÚÚë í
teSVCRSÚÚí ô
,ÚÚô ö
estadoÚÚõ °
,ÚÚ° ¢
modeloÚÚ£ ©
,ÚÚ© ™
$strÚÚ´ ˇ
)ÚÚˇ Ä
)ÚÚÄ Å
;ÚÚÅ Ç
}
ÛÛ 
}
ÙÙ 
foreach
˙˙ 
(
˙˙ 
var
˙˙ 
estado
˙˙ 
in
˙˙  "
svcRsEstados
˙˙# /
)
˙˙/ 0
{
˚˚ 

endServico
¸¸ 
.
¸¸ 
AddRange
¸¸ #
(
¸¸# $
eventoCceCanc
¸¸$ 1
.
¸¸1 2
Select
¸¸2 8
(
¸¸8 9

servicoNFe
¸¸9 C
=>
¸¸D F
new
¸¸G J
EnderecoServico
¸¸K Z
(
¸¸Z [

servicoNFe
¸¸[ e
,
¸¸e f
VersaoServico
¸¸g t
.
¸¸t u
ve100
¸¸u z
,
¸¸z {
TipoAmbiente¸¸| à
.¸¸à â

taProducao¸¸â ì
,¸¸ì î
TipoEmissao¸¸ï †
.¸¸† °
teSVCRS¸¸° ®
,¸¸® ©
estado¸¸™ ∞
,¸¸∞ ±
ModeloDocumento¸¸≤ ¡
.¸¸¡ ¬
NFe¸¸¬ ≈
,¸¸≈ ∆
$str¸¸« â
)¸¸â ä
)¸¸ä ã
)¸¸ã å
;¸¸å ç

endServico
˝˝ 
.
˝˝ 
Add
˝˝ 
(
˝˝ 
new
˝˝ "
EnderecoServico
˝˝# 2
(
˝˝2 3

ServicoNFe
˝˝3 =
.
˝˝= >'
RecepcaoEventoCancelmento
˝˝> W
,
˝˝W X
VersaoServico
˝˝Y f
.
˝˝f g
ve100
˝˝g l
,
˝˝l m
TipoAmbiente
˝˝n z
.
˝˝z {

taProducao˝˝{ Ö
,˝˝Ö Ü
TipoEmissao˝˝á í
.˝˝í ì
teSVCRS˝˝ì ö
,˝˝ö õ
estado˝˝ú ¢
,˝˝¢ £
ModeloDocumento˝˝§ ≥
.˝˝≥ ¥
NFCe˝˝¥ ∏
,˝˝∏ π
$str˝˝∫ ¸
)˝˝¸ ˝
)˝˝˝ ˛
;˝˝˛ ˇ
foreach
˛˛ 
(
˛˛ 
var
˛˛ 
modelo
˛˛ #
in
˛˛$ &
todosOsModelos
˛˛' 5
)
˛˛5 6
{
ˇˇ 

endServico
Ä	Ä	 
.
Ä	Ä	 
Add
Ä	Ä	 "
(
Ä	Ä	" #
new
Ä	Ä	# &
EnderecoServico
Ä	Ä	' 6
(
Ä	Ä	6 7

ServicoNFe
Ä	Ä	7 A
.
Ä	Ä	A B
NfeInutilizacao
Ä	Ä	B Q
,
Ä	Ä	Q R
VersaoServico
Ä	Ä	S `
.
Ä	Ä	` a
ve310
Ä	Ä	a f
,
Ä	Ä	f g
TipoAmbiente
Ä	Ä	h t
.
Ä	Ä	t u

taProducao
Ä	Ä	u 
,Ä	Ä	 Ä
TipoEmissaoÄ	Ä	Å å
.Ä	Ä	å ç
teSVCRSÄ	Ä	ç î
,Ä	Ä	î ï
estadoÄ	Ä	ñ ú
,Ä	Ä	ú ù
modeloÄ	Ä	û §
,Ä	Ä	§ •
$strÄ	Ä	¶ Î
)Ä	Ä	Î Ï
)Ä	Ä	Ï Ì
;Ä	Ä	Ì Ó

endServico
Å	Å	 
.
Å	Å	 
Add
Å	Å	 "
(
Å	Å	" #
new
Å	Å	# &
EnderecoServico
Å	Å	' 6
(
Å	Å	6 7

ServicoNFe
Å	Å	7 A
.
Å	Å	A B"
NfeConsultaProtocolo
Å	Å	B V
,
Å	Å	V W
VersaoServico
Å	Å	X e
.
Å	Å	e f
ve310
Å	Å	f k
,
Å	Å	k l
TipoAmbiente
Å	Å	m y
.
Å	Å	y z

taProducaoÅ	Å	z Ñ
,Å	Å	Ñ Ö
TipoEmissaoÅ	Å	Ü ë
.Å	Å	ë í
teSVCRSÅ	Å	í ô
,Å	Å	ô ö
estadoÅ	Å	õ °
,Å	Å	° ¢
modeloÅ	Å	£ ©
,Å	Å	© ™
$strÅ	Å	´ Ë
)Å	Å	Ë È
)Å	Å	È Í
;Å	Å	Í Î

endServico
Ç	Ç	 
.
Ç	Ç	 
Add
Ç	Ç	 "
(
Ç	Ç	" #
new
Ç	Ç	# &
EnderecoServico
Ç	Ç	' 6
(
Ç	Ç	6 7

ServicoNFe
Ç	Ç	7 A
.
Ç	Ç	A B
NfeStatusServico
Ç	Ç	B R
,
Ç	Ç	R S
VersaoServico
Ç	Ç	T a
.
Ç	Ç	a b
ve310
Ç	Ç	b g
,
Ç	Ç	g h
TipoAmbiente
Ç	Ç	i u
.
Ç	Ç	u v

taProducaoÇ	Ç	v Ä
,Ç	Ç	Ä Å
TipoEmissaoÇ	Ç	Ç ç
.Ç	Ç	ç é
teSVCRSÇ	Ç	é ï
,Ç	Ç	ï ñ
estadoÇ	Ç	ó ù
,Ç	Ç	ù û
modeloÇ	Ç	ü •
,Ç	Ç	• ¶
$strÇ	Ç	ß Ó
)Ç	Ç	Ó Ô
)Ç	Ç	Ô 
;Ç	Ç	 Ò

endServico
É	É	 
.
É	É	 
Add
É	É	 "
(
É	É	" #
new
É	É	# &
EnderecoServico
É	É	' 6
(
É	É	6 7

ServicoNFe
É	É	7 A
.
É	É	A B
NFeAutorizacao
É	É	B P
,
É	É	P Q
VersaoServico
É	É	R _
.
É	É	_ `
ve310
É	É	` e
,
É	É	e f
TipoAmbiente
É	É	g s
.
É	É	s t

taProducao
É	É	t ~
,
É	É	~ 
TipoEmissaoÉ	É	Ä ã
.É	É	ã å
teSVCRSÉ	É	å ì
,É	É	ì î
estadoÉ	É	ï õ
,É	É	õ ú
modeloÉ	É	ù £
,É	É	£ §
$strÉ	É	• Á
)É	É	Á Ë
)É	É	Ë È
;É	É	È Í

endServico
Ñ	Ñ	 
.
Ñ	Ñ	 
Add
Ñ	Ñ	 "
(
Ñ	Ñ	" #
new
Ñ	Ñ	# &
EnderecoServico
Ñ	Ñ	' 6
(
Ñ	Ñ	6 7

ServicoNFe
Ñ	Ñ	7 A
.
Ñ	Ñ	A B
NFeRetAutorizacao
Ñ	Ñ	B S
,
Ñ	Ñ	S T
VersaoServico
Ñ	Ñ	U b
.
Ñ	Ñ	b c
ve310
Ñ	Ñ	c h
,
Ñ	Ñ	h i
TipoAmbiente
Ñ	Ñ	j v
.
Ñ	Ñ	v w

taProducaoÑ	Ñ	w Å
,Ñ	Ñ	Å Ç
TipoEmissaoÑ	Ñ	É é
.Ñ	Ñ	é è
teSVCRSÑ	Ñ	è ñ
,Ñ	Ñ	ñ ó
estadoÑ	Ñ	ò û
,Ñ	Ñ	û ü
modeloÑ	Ñ	† ¶
,Ñ	Ñ	¶ ß
$strÑ	Ñ	® 
)Ñ	Ñ	 Ò
)Ñ	Ñ	Ò Ú
;Ñ	Ñ	Ú Û
}
Ö	Ö	 
}
Ü	Ü	 
foreach
í	í	 
(
í	í	 
var
í	í	 
estado
í	í	 
in
í	í	  "
todosOsEstados
í	í	# 1
)
í	í	1 2
{
ì	ì	 
foreach
î	î	 
(
î	î	 
var
î	î	 
modelo
î	î	 #
in
î	î	$ &
todosOsModelos
î	î	' 5
)
î	î	5 6
{
ï	ï	 
if
ó	ó	 
(
ó	ó	 
!
ó	ó	 
(
ó	ó	 
estado
ó	ó	  
==
ó	ó	! #
	EstadoNfe
ó	ó	$ -
.
ó	ó	- .
SP
ó	ó	. 0
&
ó	ó	1 2
modelo
ó	ó	3 9
==
ó	ó	: <
ModeloDocumento
ó	ó	= L
.
ó	ó	L M
NFCe
ó	ó	M Q
)
ó	ó	Q R
)
ó	ó	R S

endServico
ò	ò	 "
.
ò	ò	" #
Add
ò	ò	# &
(
ò	ò	& '
new
ò	ò	' *
EnderecoServico
ò	ò	+ :
(
ò	ò	: ;

ServicoNFe
ò	ò	; E
.
ò	ò	E F 
RecepcaoEventoEpec
ò	ò	F X
,
ò	ò	X Y
VersaoServico
ò	ò	Z g
.
ò	ò	g h
ve100
ò	ò	h m
,
ò	ò	m n
TipoAmbiente
ò	ò	o {
.
ò	ò	{ |
taHomologacaoò	ò	| â
,ò	ò	â ä
TipoEmissaoò	ò	ã ñ
.ò	ò	ñ ó
teEPECò	ò	ó ù
,ò	ò	ù û
estadoò	ò	ü •
,ò	ò	• ¶
modeloò	ò	ß ≠
,ò	ò	≠ Æ
$strò	ò	Ø Ú
)ò	ò	Ú Û
)ò	ò	Û Ù
;ò	ò	Ù ı
if
ö	ö	 
(
ö	ö	 
modelo
ö	ö	 
!=
ö	ö	 !
ModeloDocumento
ö	ö	" 1
.
ö	ö	1 2
NFCe
ö	ö	2 6
)
ö	ö	6 7

endServico
õ	õ	 "
.
õ	õ	" #
Add
õ	õ	# &
(
õ	õ	& '
new
õ	õ	' *
EnderecoServico
õ	õ	+ :
(
õ	õ	: ;

ServicoNFe
õ	õ	; E
.
õ	õ	E F4
&RecepcaoEventoManifestacaoDestinatario
õ	õ	F l
,
õ	õ	l m
VersaoServico
õ	õ	n {
.
õ	õ	{ |
ve100õ	õ	| Å
,õ	õ	Å Ç
TipoAmbienteõ	õ	É è
.õ	õ	è ê
taHomologacaoõ	õ	ê ù
,õ	õ	ù û
TipoEmissaoõ	õ	ü ™
.õ	õ	™ ´
teNormalõ	õ	´ ≥
,õ	õ	≥ ¥
estadoõ	õ	µ ª
,õ	õ	ª º
modeloõ	õ	Ω √
,õ	õ	√ ƒ
$strõ	õ	≈ à
)õ	õ	à â
)õ	õ	â ä
;õ	õ	ä ã
if
û	û	 
(
û	û	 
estado
û	û	 
!=
û	û	 !
	EstadoNfe
û	û	" +
.
û	û	+ ,
CE
û	û	, .
&
û	û	/ 0
!
û	û	1 2
svanEstados
û	û	2 =
.
û	û	= >
Contains
û	û	> F
(
û	û	F G
estado
û	û	G M
)
û	û	M N
)
û	û	N O

endServico
ü	ü	 "
.
ü	ü	" #
AddRange
ü	ü	# +
(
ü	ü	+ ,
versaoDoisETres
†	†	 +
.
†	†	+ ,
Select
†	†	, 2
(
†	†	2 3
versao
†	†	3 9
=>
†	†	: <
new
†	†	= @
EnderecoServico
†	†	A P
(
†	†	P Q

ServicoNFe
†	†	Q [
.
†	†	[ \
NfeDownloadNF
†	†	\ i
,
†	†	i j
versao
†	†	k q
,
†	†	q r
TipoAmbiente
†	†	s 
.†	†	 Ä
taHomologacao†	†	Ä ç
,†	†	ç é
TipoEmissao†	†	è ö
.†	†	ö õ
teNormal†	†	õ £
,†	†	£ §
estado†	†	• ´
,†	†	´ ¨
modelo†	†	≠ ≥
,†	†	≥ ¥
$str†	†	µ ˆ
)†	†	ˆ ˜
)†	†	˜ ¯
)†	†	¯ ˘
;†	†	˘ ˙
if
°	°	 
(
°	°	 
modelo
°	°	 
!=
°	°	 !
ModeloDocumento
°	°	" 1
.
°	°	1 2
NFCe
°	°	2 6
)
°	°	6 7

endServico
¢	¢	 "
.
¢	¢	" #
Add
¢	¢	# &
(
¢	¢	& '
new
¢	¢	' *
EnderecoServico
¢	¢	+ :
(
¢	¢	: ;

ServicoNFe
¢	¢	; E
.
¢	¢	E F 
NFeDistribuicaoDFe
¢	¢	F X
,
¢	¢	X Y
VersaoServico
¢	¢	Z g
.
¢	¢	g h
ve100
¢	¢	h m
,
¢	¢	m n
TipoAmbiente
¢	¢	o {
.
¢	¢	{ |
taHomologacao¢	¢	| â
,¢	¢	â ä
TipoEmissao¢	¢	ã ñ
.¢	¢	ñ ó
teNormal¢	¢	ó ü
,¢	¢	ü †
estado¢	¢	° ß
,¢	¢	ß ®
modelo¢	¢	© Ø
,¢	¢	Ø ∞
$str¢	¢	± ¸
)¢	¢	¸ ˝
)¢	¢	˝ ˛
;¢	¢	˛ ˇ
}
£	£	 
}
§	§	 
foreach
™	™	 
(
™	™	 
var
™	™	 
estado
™	™	 
in
™	™	  "
todosOsEstados
™	™	# 1
)
™	™	1 2
{
´	´	 
foreach
¨	¨	 
(
¨	¨	 
var
¨	¨	 
modelo
¨	¨	 #
in
¨	¨	$ &
todosOsModelos
¨	¨	' 5
)
¨	¨	5 6
{
≠	≠	 
if
Ø	Ø	 
(
Ø	Ø	 
!
Ø	Ø	 
(
Ø	Ø	 
estado
Ø	Ø	  
==
Ø	Ø	! #
	EstadoNfe
Ø	Ø	$ -
.
Ø	Ø	- .
SP
Ø	Ø	. 0
&
Ø	Ø	1 2
modelo
Ø	Ø	3 9
==
Ø	Ø	: <
ModeloDocumento
Ø	Ø	= L
.
Ø	Ø	L M
NFCe
Ø	Ø	M Q
)
Ø	Ø	Q R
)
Ø	Ø	R S

endServico
∞	∞	 "
.
∞	∞	" #
Add
∞	∞	# &
(
∞	∞	& '
new
∞	∞	' *
EnderecoServico
∞	∞	+ :
(
∞	∞	: ;

ServicoNFe
∞	∞	; E
.
∞	∞	E F 
RecepcaoEventoEpec
∞	∞	F X
,
∞	∞	X Y
VersaoServico
∞	∞	Z g
.
∞	∞	g h
ve100
∞	∞	h m
,
∞	∞	m n
TipoAmbiente
∞	∞	o {
.
∞	∞	{ |

taProducao∞	∞	| Ü
,∞	∞	Ü á
TipoEmissao∞	∞	à ì
.∞	∞	ì î
teEPEC∞	∞	î ö
,∞	∞	ö õ
estado∞	∞	ú ¢
,∞	∞	¢ £
modelo∞	∞	§ ™
,∞	∞	™ ´
$str∞	∞	¨ Ô
)∞	∞	Ô 
)∞	∞	 Ò
;∞	∞	Ò Ú
if
≤	≤	 
(
≤	≤	 
modelo
≤	≤	 
!=
≤	≤	 !
ModeloDocumento
≤	≤	" 1
.
≤	≤	1 2
NFCe
≤	≤	2 6
)
≤	≤	6 7

endServico
≥	≥	 "
.
≥	≥	" #
Add
≥	≥	# &
(
≥	≥	& '
new
≥	≥	' *
EnderecoServico
≥	≥	+ :
(
≥	≥	: ;

ServicoNFe
≥	≥	; E
.
≥	≥	E F4
&RecepcaoEventoManifestacaoDestinatario
≥	≥	F l
,
≥	≥	l m
VersaoServico
≥	≥	n {
.
≥	≥	{ |
ve100≥	≥	| Å
,≥	≥	Å Ç
TipoAmbiente≥	≥	É è
.≥	≥	è ê

taProducao≥	≥	ê ö
,≥	≥	ö õ
TipoEmissao≥	≥	ú ß
.≥	≥	ß ®
teNormal≥	≥	® ∞
,≥	≥	∞ ±
estado≥	≥	≤ ∏
,≥	≥	∏ π
modelo≥	≥	∫ ¿
,≥	≥	¿ ¡
$str≥	≥	¬ Ö
)≥	≥	Ö Ü
)≥	≥	Ü á
;≥	≥	á à
if
∂	∂	 
(
∂	∂	 
estado
∂	∂	 
!=
∂	∂	 !
	EstadoNfe
∂	∂	" +
.
∂	∂	+ ,
CE
∂	∂	, .
&
∂	∂	/ 0
!
∂	∂	1 2
svanEstados
∂	∂	2 =
.
∂	∂	= >
Contains
∂	∂	> F
(
∂	∂	F G
estado
∂	∂	G M
)
∂	∂	M N
)
∂	∂	N O

endServico
∑	∑	 "
.
∑	∑	" #
AddRange
∑	∑	# +
(
∑	∑	+ ,
versaoDoisETres
∑	∑	, ;
.
∑	∑	; <
Select
∑	∑	< B
(
∑	∑	B C
versao
∑	∑	C I
=>
∑	∑	J L
new
∑	∑	M P
EnderecoServico
∑	∑	Q `
(
∑	∑	` a

ServicoNFe
∑	∑	a k
.
∑	∑	k l
NfeDownloadNF
∑	∑	l y
,
∑	∑	y z
versao∑	∑	{ Å
,∑	∑	Å Ç
TipoAmbiente∑	∑	É è
.∑	∑	è ê

taProducao∑	∑	ê ö
,∑	∑	ö õ
TipoEmissao∑	∑	ú ß
.∑	∑	ß ®
teNormal∑	∑	® ∞
,∑	∑	∞ ±
estado∑	∑	≤ ∏
,∑	∑	∏ π
modelo∑	∑	∫ ¿
,∑	∑	¿ ¡
$str∑	∑	¬ É
)∑	∑	É Ñ
)∑	∑	Ñ Ö
)∑	∑	Ö Ü
;∑	∑	Ü á
if
∏	∏	 
(
∏	∏	 
modelo
∏	∏	 
!=
∏	∏	 !
ModeloDocumento
∏	∏	" 1
.
∏	∏	1 2
NFCe
∏	∏	2 6
)
∏	∏	6 7

endServico
π	π	 "
.
π	π	" #
Add
π	π	# &
(
π	π	& '
new
π	π	' *
EnderecoServico
π	π	+ :
(
π	π	: ;

ServicoNFe
π	π	; E
.
π	π	E F 
NFeDistribuicaoDFe
π	π	F X
,
π	π	X Y
VersaoServico
π	π	Z g
.
π	π	g h
ve100
π	π	h m
,
π	π	m n
TipoAmbiente
π	π	o {
.
π	π	{ |

taProducaoπ	π	| Ü
,π	π	Ü á
TipoEmissaoπ	π	à ì
.π	π	ì î
teNormalπ	π	î ú
,π	π	ú ù
estadoπ	π	û §
,π	π	§ •
modeloπ	π	¶ ¨
,π	π	¨ ≠
$strπ	π	Æ ˙
)π	π	˙ ˚
)π	π	˚ ¸
;π	π	¸ ˝
}
∫	∫	 
}
ª	ª	 
return
¡	¡	 

endServico
¡	¡	 
;
¡	¡	 
}
¬	¬	 	
private
À	À	 
static
À	À	 
VersaoServico
À	À	 $
?
À	À	$ % 
ObterVersaoServico
À	À	& 8
(
À	À	8 9
this
À	À	9 =

ServicoNFe
À	À	> H
servico
À	À	I P
,
À	À	P Q!
ConfiguracaoServico
À	À	R e

cfgServico
À	À	f p
)
À	À	p q
{
Ã	Ã	 	
switch
Õ	Õ	 
(
Õ	Õ	 
servico
Õ	Õ	 
)
Õ	Õ	 
{
Œ	Œ	 
case
œ	œ	 

ServicoNFe
œ	œ	 
.
œ	œ	  )
RecepcaoEventoCartaCorrecao
œ	œ	  ;
:
œ	œ	; <
case
–	–	 

ServicoNFe
–	–	 
.
–	–	  '
RecepcaoEventoCancelmento
–	–	  9
:
–	–	9 :
return
—	—	 

cfgServico
—	—	 %
.
—	—	% &1
#VersaoRecepcaoEventoCceCancelamento
—	—	& I
;
—	—	I J
case
“	“	 

ServicoNFe
“	“	 
.
“	“	   
RecepcaoEventoEpec
“	“	  2
:
“	“	2 3
return
”	”	 

cfgServico
”	”	 %
.
”	”	% &&
VersaoRecepcaoEventoEpec
”	”	& >
;
”	”	> ?
case
‘	‘	 

ServicoNFe
‘	‘	 
.
‘	‘	  4
&RecepcaoEventoManifestacaoDestinatario
‘	‘	  F
:
‘	‘	F G
return
’	’	 

cfgServico
’	’	 %
.
’	’	% &:
,VersaoRecepcaoEventoManifestacaoDestinatario
’	’	& R
;
’	’	R S
case
÷	÷	 

ServicoNFe
÷	÷	 
.
÷	÷	  
NfeRecepcao
÷	÷	  +
:
÷	÷	+ ,
return
◊	◊	 

cfgServico
◊	◊	 %
.
◊	◊	% &
VersaoNfeRecepcao
◊	◊	& 7
;
◊	◊	7 8
case
ÿ	ÿ	 

ServicoNFe
ÿ	ÿ	 
.
ÿ	ÿ	  
NfeRetRecepcao
ÿ	ÿ	  .
:
ÿ	ÿ	. /
return
Ÿ	Ÿ	 

cfgServico
Ÿ	Ÿ	 %
.
Ÿ	Ÿ	% &"
VersaoNfeRetRecepcao
Ÿ	Ÿ	& :
;
Ÿ	Ÿ	: ;
case
⁄	⁄	 

ServicoNFe
⁄	⁄	 
.
⁄	⁄	  !
NfeConsultaCadastro
⁄	⁄	  3
:
⁄	⁄	3 4
return
€	€	 

cfgServico
€	€	 %
.
€	€	% &'
VersaoNfeConsultaCadastro
€	€	& ?
;
€	€	? @
case
‹	‹	 

ServicoNFe
‹	‹	 
.
‹	‹	  
NfeInutilizacao
‹	‹	  /
:
‹	‹	/ 0
return
›	›	 

cfgServico
›	›	 %
.
›	›	% &#
VersaoNfeInutilizacao
›	›	& ;
;
›	›	; <
case
ﬁ	ﬁ	 

ServicoNFe
ﬁ	ﬁ	 
.
ﬁ	ﬁ	  "
NfeConsultaProtocolo
ﬁ	ﬁ	  4
:
ﬁ	ﬁ	4 5
return
ﬂ	ﬂ	 

cfgServico
ﬂ	ﬂ	 %
.
ﬂ	ﬂ	% &(
VersaoNfeConsultaProtocolo
ﬂ	ﬂ	& @
;
ﬂ	ﬂ	@ A
case
‡	‡	 

ServicoNFe
‡	‡	 
.
‡	‡	  
NfeStatusServico
‡	‡	  0
:
‡	‡	0 1
return
·	·	 

cfgServico
·	·	 %
.
·	·	% &$
VersaoNfeStatusServico
·	·	& <
;
·	·	< =
case
‚	‚	 

ServicoNFe
‚	‚	 
.
‚	‚	  
NFeAutorizacao
‚	‚	  .
:
‚	‚	. /
return
„	„	 

cfgServico
„	„	 %
.
„	„	% &"
VersaoNFeAutorizacao
„	„	& :
;
„	„	: ;
case
‰	‰	 

ServicoNFe
‰	‰	 
.
‰	‰	  
NFeRetAutorizacao
‰	‰	  1
:
‰	‰	1 2
return
Â	Â	 

cfgServico
Â	Â	 %
.
Â	Â	% &%
VersaoNFeRetAutorizacao
Â	Â	& =
;
Â	Â	= >
case
Ê	Ê	 

ServicoNFe
Ê	Ê	 
.
Ê	Ê	   
NFeDistribuicaoDFe
Ê	Ê	  2
:
Ê	Ê	2 3
return
Á	Á	 

cfgServico
Á	Á	 %
.
Á	Á	% &&
VersaoNFeDistribuicaoDFe
Á	Á	& >
;
Á	Á	> ?
case
Ë	Ë	 

ServicoNFe
Ë	Ë	 
.
Ë	Ë	  
NfeConsultaDest
Ë	Ë	  /
:
Ë	Ë	/ 0
return
È	È	 

cfgServico
È	È	 %
.
È	È	% &#
VersaoNfeConsultaDest
È	È	& ;
;
È	È	; <
case
Í	Í	 

ServicoNFe
Í	Í	 
.
Í	Í	  
NfeDownloadNF
Í	Í	  -
:
Í	Í	- .
return
Î	Î	 

cfgServico
Î	Î	 %
.
Î	Î	% &!
VersaoNfeDownloadNF
Î	Î	& 9
;
Î	Î	9 :
case
Ï	Ï	 

ServicoNFe
Ï	Ï	 
.
Ï	Ï	  "
NfceAdministracaoCSC
Ï	Ï	  4
:
Ï	Ï	4 5
return
Ì	Ì	 

cfgServico
Ì	Ì	 %
.
Ì	Ì	% &'
VersaoNfceAministracaoCSC
Ì	Ì	& ?
;
Ì	Ì	? @
}
Ó	Ó	 
return
Ô	Ô	 
null
Ô	Ô	 
;
Ô	Ô	 
}
		 	
private
˘	˘	 
static
˘	˘	 
string
˘	˘	 
Erro
˘	˘	 "
(
˘	˘	" #

ServicoNFe
˘	˘	# -
servico
˘	˘	. 5
,
˘	˘	5 6!
ConfiguracaoServico
˘	˘	7 J

cfgServico
˘	˘	K U
)
˘	˘	U V
{
˙	˙	 	
return
˚	˚	 
$str
˚	˚	 
+
˚	˚	 
servico
˚	˚	  '
+
˚	˚	( )
$str
˚	˚	* 5
+
˚	˚	6 7
servico
˚	˚	8 ?
.
˚	˚	? @%
VersaoServicoParaString
˚	˚	@ W
(
˚	˚	W X
servico
˚	˚	X _
.
˚	˚	_ ` 
ObterVersaoServico
˚	˚	` r
(
˚	˚	r s

cfgServico
˚	˚	s }
)
˚	˚	} ~
)
˚	˚	~ 
+˚	˚	Ä Å
$str˚	˚	Ç ü
+˚	˚	† °

cfgServico˚	˚	¢ ¨
.˚	˚	¨ ≠
cUF˚	˚	≠ ∞
+˚	˚	± ≤
$str˚	˚	≥ ∆
+˚	˚	« »

cfgServico˚	˚	… ”
.˚	˚	” ‘
tpAmb˚	˚	‘ Ÿ
.˚	˚	Ÿ ⁄
TpAmbParaString˚	˚	⁄ È
(˚	˚	È Í
)˚	˚	Í Î
+˚	˚	Ï Ì
$str
¸	¸	 (
+
¸	¸	) *

cfgServico
¸	¸	+ 5
.
¸	¸	5 6
tpEmis
¸	¸	6 <
.
¸	¸	< =#
TipoEmissaoParaString
¸	¸	= R
(
¸	¸	R S
)
¸	¸	S T
+
¸	¸	U V
$str
¸	¸	W f
+
¸	¸	g h

cfgServico
¸	¸	i s
.
¸	¸	s t
ModeloDocumento¸	¸	t É
.¸	¸	É Ñ)
ModeloDocumentoParaString¸	¸	Ñ ù
(¸	¸	ù û
)¸	¸	û ü
+¸	¸	† °
$str¸	¸	¢ •
;¸	¸	• ¶
}
˝	˝	 	
public
Ö
Ö
 
static
Ö
Ö
 
string
Ö
Ö
 
ObterUrlServico
Ö
Ö
 ,
(
Ö
Ö
, -

ServicoNFe
Ö
Ö
- 7
servico
Ö
Ö
8 ?
,
Ö
Ö
? @!
ConfiguracaoServico
Ö
Ö
A T

cfgServico
Ö
Ö
U _
)
Ö
Ö
_ `
{
Ü
Ü
 	
var
á
á
 
	definicao
á
á
 
=
á
á
 
from
á
á
  
d
á
á
! "
in
á
á
# %
ListaEnderecos
á
á
& 4
where
à
à
 !
d
à
à
" #
.
à
à
# $
Estado
à
à
$ *
==
à
à
+ -

cfgServico
à
à
. 8
.
à
à
8 9
cUF
à
à
9 <
&&
à
à
= ?
d
à
à
@ A
.
à
à
A B

ServicoNFe
à
à
B L
==
à
à
M O
servico
à
à
P W
&&
à
à
X Z
d
à
à
[ \
.
à
à
\ ]
TipoAmbiente
à
à
] i
==
à
à
j l

cfgServico
à
à
m w
.
à
à
w x
tpAmb
à
à
x }
&&à
à
~ Ä
dà
à
Å Ç
.à
à
Ç É
TipoEmissaoà
à
É é
==à
à
è ë

cfgServicoà
à
í ú
.à
à
ú ù
tpEmisà
à
ù £
&&à
à
§ ¶
dà
à
ß ®
.à
à
® ©
VersaoServicoà
à
© ∂
==à
à
∑ π"
ObterVersaoServicoà
à
∫ Ã
(à
à
Ã Õ
servicoà
à
Õ ‘
,à
à
‘ ’

cfgServicoà
à
÷ ‡
)à
à
‡ ·
&&à
à
‚ ‰
dà
à
Â Ê
.à
à
Ê Á
ModeloDocumentoà
à
Á ˆ
==à
à
˜ ˘

cfgServicoà
à
˙ Ñ
.à
à
Ñ Ö
ModeloDocumentoà
à
Ö î
select
â
â
 "
d
â
â
# $
.
â
â
$ %
Url
â
â
% (
;
â
â
( )
var
ä
ä
 
listaRetorno
ä
ä
 
=
ä
ä
 
	definicao
ä
ä
 (
as
ä
ä
) +
IList
ä
ä
, 1
<
ä
ä
1 2
string
ä
ä
2 8
>
ä
ä
8 9
??
ä
ä
: <
	definicao
ä
ä
= F
.
ä
ä
F G
ToList
ä
ä
G M
(
ä
ä
M N
)
ä
ä
N O
;
ä
ä
O P
var
ã
ã
 
qtdeRetorno
ã
ã
 
=
ã
ã
 
listaRetorno
ã
ã
 *
.
ã
ã
* +
Count
ã
ã
+ 0
(
ã
ã
0 1
)
ã
ã
1 2
;
ã
ã
2 3
if
ç
ç
 
(
ç
ç
 
qtdeRetorno
ç
ç
 
==
ç
ç
 
$num
ç
ç
  
)
ç
ç
  !
throw
é
é
 
new
é
é
 
	Exception
é
é
 #
(
é
é
# $
Erro
é
é
$ (
(
é
é
( )
servico
é
é
) 0
,
é
é
0 1

cfgServico
é
é
2 <
)
é
é
< =
)
é
é
= >
;
é
é
> ?
if
è
è
 
(
è
è
 
qtdeRetorno
è
è
 
>
è
è
 
$num
è
è
 
)
è
è
  
throw
ê
ê
 
new
ê
ê
 
	Exception
ê
ê
 #
(
ê
ê
# $
$str
ê
ê
$ [
)
ê
ê
[ \
;
ê
ê
\ ]
return
ë
ë
 
listaRetorno
ë
ë
 
.
ë
ë
  
FirstOrDefault
ë
ë
  .
(
ë
ë
. /
)
ë
ë
/ 0
;
ë
ë
0 1
}
í
í
 	
}
ì
ì
 
}î
î
 Å
VC:\Users\SWDEV\Source\Repos\SW10.SWMANAGER\NFe\NFe.Servicos\Properties\AssemblyInfo.cs
[(( 
assembly(( 	
:((	 

AssemblyTitle(( 
((( 
$str(( '
)((' (
]((( )
[)) 
assembly)) 	
:))	 

AssemblyDescription)) 
()) 
$str)) !
)))! "
]))" #
[** 
assembly** 	
:**	 
!
AssemblyConfiguration**  
(**  !
$str**! #
)**# $
]**$ %
[++ 
assembly++ 	
:++	 

AssemblyCompany++ 
(++ 
$str++ 
)++ 
]++ 
[,, 
assembly,, 	
:,,	 

AssemblyProduct,, 
(,, 
$str,, )
),,) *
],,* +
[-- 
assembly-- 	
:--	 

AssemblyCopyright-- 
(-- 
$str-- 0
)--0 1
]--1 2
[.. 
assembly.. 	
:..	 

AssemblyTrademark.. 
(.. 
$str.. 
)..  
]..  !
[// 
assembly// 	
://	 

AssemblyCulture// 
(// 
$str// 
)// 
]// 
[55 
assembly55 	
:55	 


ComVisible55 
(55 
false55 
)55 
]55 
[99 
assembly99 	
:99	 

Guid99 
(99 
$str99 6
)996 7
]997 8
[FF 
assemblyFF 	
:FF	 

AssemblyVersionFF 
(FF 
$strFF &
)FF& '
]FF' (
[GG 
assemblyGG 	
:GG	 

AssemblyFileVersionGG 
(GG 
$strGG *
)GG* +
]GG+ ,ë	
XC:\Users\SWDEV\Source\Repos\SW10.SWMANAGER\NFe\NFe.Servicos\Retorno\RetornoAdmCscNFCe.cs
	namespace$$ 	
NFe$$
 
.$$ 
Servicos$$ 
.$$ 
Retorno$$ 
{%% 
public&& 

class&& 
RetornoAdmCscNFCe&& "
:&&# $
RetornoBasico&&% 2
{'' 
public(( 
RetornoAdmCscNFCe((  
(((  !
string((! '
envioStr((( 0
,((0 1
string((2 8

retornoStr((9 C
,((C D
string((E K
retornoCompletaStr((L ^
,((^ _
retAdmCscNFCe((` m
retorno((n u
)((u v
:)) 
base)) 
()) 
envioStr)) 
,)) 

retornoStr)) '
,))' (
retornoCompletaStr))) ;
,)); <
retorno))= D
)))D E
{** 	
Retorno++ 
=++ 
retorno++ 
;++ 
},, 	
public.. 
new.. 
retAdmCscNFCe..  
Retorno..! (
{..) *
get..+ .
;... /
set..0 3
;..3 4
}..5 6
}// 
}00  
TC:\Users\SWDEV\Source\Repos\SW10.SWMANAGER\NFe\NFe.Servicos\Retorno\RetornoBasico.cs
	namespace## 	
NFe##
 
.## 
Servicos## 
.## 
Retorno## 
{$$ 
public%% 

abstract%% 
class%% 
RetornoBasico%% '
{&& 
	protected'' 
RetornoBasico'' 
(''  
string''  &
envioStr''' /
,''/ 0
string''1 7

retornoStr''8 B
,''B C
string''D J
retornoCompletaStr''K ]
,''] ^
IRetornoServico''_ n
retorno''o v
)''v w
{(( 	
EnvioStr)) 
=)) 
envioStr)) 
;))  

RetornoStr** 
=** 

retornoStr** #
;**# $
RetornoCompletoStr++ 
=++  
retornoCompletaStr++! 3
;++3 4
Retorno,, 
=,, 
retorno,, 
;,, 
}-- 	
public// 
IRetornoServico// 
Retorno// &
{//' (
get//) ,
;//, -
	protected//. 7
set//8 ;
;//; <
}//= >
public00 
string00 
EnvioStr00 
{00  
get00! $
;00$ %
	protected00& /
set000 3
;003 4
}005 6
public11 
string11 

RetornoStr11  
{11! "
get11# &
;11& '
	protected11( 1
set112 5
;115 6
}117 8
public22 
string22 
RetornoCompletoStr22 (
{22) *
get22+ .
;22. /
	protected220 9
set22: =
;22= >
}22? @
}33 
}44 ö	
[C:\Users\SWDEV\Source\Repos\SW10.SWMANAGER\NFe\NFe.Servicos\Retorno\RetornoNfeDistDFeInt.cs
	namespace## 	
NFe##
 
.## 
Servicos## 
.## 
Retorno## 
{$$ 
public%% 

class%%  
RetornoNfeDistDFeInt%% %
:%%& '
RetornoBasico%%( 5
{&& 
public''  
RetornoNfeDistDFeInt'' #
(''# $
string''$ *
envioStr''+ 3
,''3 4
string''5 ;

retornoStr''< F
,''F G
string''H N
retornoCompletaStr''O a
,''a b
retDistDFeInt''c p
retorno''q x
)''x y
:(( 
base(( 
((( 
envioStr(( 
,(( 

retornoStr(( '
,((' (
retornoCompletaStr(() ;
,((; <
retorno((= D
)((D E
{)) 	
Retorno** 
=** 
retorno** 
;** 
}++ 	
public-- 
new-- 
retDistDFeInt--  
Retorno--! (
{--) *
get--+ .
;--. /
set--0 3
;--3 4
}--5 6
}.. 
}// ñ	
YC:\Users\SWDEV\Source\Repos\SW10.SWMANAGER\NFe\NFe.Servicos\Retorno\RetornoNfeDownload.cs
	namespace## 	
NFe##
 
.## 
Servicos## 
.## 
Retorno## 
{$$ 
public%% 

class%% 
RetornoNfeDownload%% #
:%%$ %
RetornoBasico%%& 3
{&& 
public'' 
RetornoNfeDownload'' !
(''! "
string''" (
envioStr'') 1
,''1 2
string''3 9

retornoStr'': D
,''D E
string''F L
retornoCompletaStr''M _
,''_ `
retDownloadNFe''a o
retorno''p w
)''w x
:(( 
base(( 
((( 
envioStr(( 
,(( 

retornoStr(( '
,((' (
retornoCompletaStr(() ;
,((; <
retorno((= D
)((D E
{)) 	
Retorno** 
=** 
retorno** 
;** 
}++ 	
public-- 
new-- 
retDownloadNFe-- !
Retorno--" )
{--* +
get--, /
;--/ 0
set--1 4
;--4 5
}--6 7
}.. 
}// §	
VC:\Users\SWDEV\Source\Repos\SW10.SWMANAGER\NFe\NFe.Servicos\Retorno\RetornoConsulta.cs
	namespace## 	
NFe##
 
.## 
Servicos## 
.## 
Retorno## 
{$$ 
public%% 

class%% '
RetornoNfeConsultaProtocolo%% ,
:%%- .
RetornoBasico%%/ <
{&& 
public'' '
RetornoNfeConsultaProtocolo'' *
(''* +
string''+ 1
envioStr''2 :
,'': ;
string''< B

retornoStr''C M
,''M N
string''O U
retornoCompletaStr''V h
,''h i
retConsSitNFe''j w
retorno''x 
)	'' Ä
:(( 
base(( 
((( 
envioStr(( 
,(( 

retornoStr(( '
,((' (
retornoCompletaStr(() ;
,((; <
retorno((= D
)((D E
{)) 	
Retorno** 
=** 
retorno** 
;** 
}++ 	
public-- 
new-- 
retConsSitNFe--  
Retorno--! (
{--) *
get--+ .
;--. /
set--0 3
;--3 4
}--5 6
}.. 
}// ó	
\C:\Users\SWDEV\Source\Repos\SW10.SWMANAGER\NFe\NFe.Servicos\Retorno\RetornoNFeAutorizacao.cs
	namespace## 	
NFe##
 
.## 
Servicos## 
.## 
Retorno## 
{$$ 
public%% 

class%% !
RetornoNFeAutorizacao%% &
:%%' (
RetornoBasico%%) 6
{&& 
public'' !
RetornoNFeAutorizacao'' $
(''$ %
string''% +
envioStr'', 4
,''4 5
string''6 <

retornoStr''= G
,''G H
string''I O
retornoCompletaStr''P b
,''b c

retEnviNFe''d n
retorno''o v
)''v w
:(( 
base(( 
((( 
envioStr(( 
,(( 

retornoStr(( '
,((' (
retornoCompletaStr(() ;
,((; <
retorno((= D
)((D E
{)) 	
Retorno** 
=** 
retorno** 
;** 
}++ 	
public-- 
new-- 

retEnviNFe-- 
Retorno-- %
{--& '
get--( +
;--+ ,
set--- 0
;--0 1
}--2 3
}.. 
}// ¶	
aC:\Users\SWDEV\Source\Repos\SW10.SWMANAGER\NFe\NFe.Servicos\Retorno\RetornoNfeConsultaCadastro.cs
	namespace## 	
NFe##
 
.## 
Servicos## 
.## 
Retorno## 
{$$ 
public%% 

class%% &
RetornoNfeConsultaCadastro%% +
:%%, -
RetornoBasico%%. ;
{&& 
public'' &
RetornoNfeConsultaCadastro'' )
('') *
string''* 0
envioStr''1 9
,''9 :
string''; A

retornoStr''B L
,''L M
string''N T
retornoCompletaStr''U g
,''g h

retConsCad''i s
retorno''t {
)''{ |
:(( 
base(( 
((( 
envioStr(( 
,(( 

retornoStr(( '
,((' (
retornoCompletaStr(() ;
,((; <
retorno((= D
)((D E
{)) 	
Retorno** 
=** 
retorno** 
;** 
}++ 	
public-- 
new-- 

retConsCad-- 
Retorno-- %
{--& '
get--( +
;--+ ,
set--- 0
;--0 1
}--2 3
}.. 
}// «
\C:\Users\SWDEV\Source\Repos\SW10.SWMANAGER\NFe\NFe.Servicos\Retorno\RetornoRecepcaoEvento.cs
	namespace&& 	
NFe&&
 
.&& 
Servicos&& 
.&& 
Retorno&& 
{'' 
public(( 

class(( !
RetornoRecepcaoEvento(( &
:((' (
RetornoBasico(() 6
{)) 
public** !
RetornoRecepcaoEvento** $
(**$ %
string**% +
envioStr**, 4
,**4 5
string**6 <

retornoStr**= G
,**G H
string**I O
retornoCompletaStr**P b
,**b c
retEnvEvento**d p
retorno**q x
,**x y
List**z ~
<**~ 
procEventoNFe	** å
>
**å ç
procEventosNFe
**é ú
)
**ú ù
:++ 
base++ 
(++ 
envioStr++ 
,++ 

retornoStr++ '
,++' (
retornoCompletaStr++) ;
,++; <
retorno++= D
)++D E
{,, 	
Retorno-- 
=-- 
retorno-- 
;-- 
ProcEventosNFe.. 
=.. 
procEventosNFe.. +
;..+ ,
}// 	
public11 
new11 
retEnvEvento11 
Retorno11  '
{11( )
get11* -
;11- .
set11/ 2
;112 3
}114 5
public33 
List33 
<33 
procEventoNFe33 !
>33! "
ProcEventosNFe33# 1
{332 3
get334 7
;337 8
set339 <
;33< =
}33> ?
}44 
}55 ö	
]C:\Users\SWDEV\Source\Repos\SW10.SWMANAGER\NFe\NFe.Servicos\Retorno\RetornoNfeInutilizacao.cs
	namespace## 	
NFe##
 
.## 
Servicos## 
.## 
Retorno## 
{$$ 
public%% 

class%% "
RetornoNfeInutilizacao%% '
:%%( )
RetornoBasico%%* 7
{&& 
public'' "
RetornoNfeInutilizacao'' %
(''% &
string''& ,
envioStr''- 5
,''5 6
string''7 =

retornoStr''> H
,''H I
string''J P
retornoCompletaStr''Q c
,''c d

retInutNFe''e o
retorno''p w
)''w x
:(( 
base(( 
((( 
envioStr(( 
,(( 

retornoStr(( '
,((' (
retornoCompletaStr(() ;
,((; <
retorno((= D
)((D E
{)) 	
Retorno** 
=** 
retorno** 
;** 
}++ 	
public-- 
new-- 

retInutNFe-- 
Retorno-- %
{--& '
get--( +
;--+ ,
set--- 0
;--0 1
}--2 3
}.. 
}// é	
YC:\Users\SWDEV\Source\Repos\SW10.SWMANAGER\NFe\NFe.Servicos\Retorno\RetornoNfeRecepcao.cs
	namespace## 	
NFe##
 
.## 
Servicos## 
.## 
Retorno## 
{$$ 
public%% 

class%% 
RetornoNfeRecepcao%% #
:%%$ %
RetornoBasico%%& 3
{&& 
public'' 
RetornoNfeRecepcao'' !
(''! "
string''" (
envioStr'') 1
,''1 2
string''3 9

retornoStr'': D
,''D E
string''F L
retornoCompletaStr''M _
,''_ `

retEnviNFe''a k
retorno''l s
)''s t
:(( 
base(( 
((( 
envioStr(( 
,(( 

retornoStr(( '
,((' (
retornoCompletaStr(() ;
,((; <
retorno((= D
)((D E
{)) 	
Retorno** 
=** 
retorno** 
;** 
}++ 	
public-- 
new-- 

retEnviNFe-- 
Retorno-- %
{--& '
get--( +
;--+ ,
set--- 0
;--0 1
}--2 3
}.. 
}// ®	
_C:\Users\SWDEV\Source\Repos\SW10.SWMANAGER\NFe\NFe.Servicos\Retorno\RetornoNFeRetAutorizacao.cs
	namespace## 	
NFe##
 
.## 
Servicos## 
.## 
Retorno## 
{$$ 
public%% 

class%% $
RetornoNFeRetAutorizacao%% )
:%%* +
RetornoBasico%%, 9
{&& 
public'' $
RetornoNFeRetAutorizacao'' '
(''' (
string''( .
envioStr''/ 7
,''7 8
string''9 ?

retornoStr''@ J
,''J K
string''L R
retornoCompletaStr''S e
,''e f
retConsReciNFe''g u
retorno''v }
)''} ~
:(( 
base(( 
((( 
envioStr(( 
,(( 

retornoStr(( '
,((' (
retornoCompletaStr(() ;
,((; <
retorno((= D
)((D E
{)) 	
Retorno** 
=** 
retorno** 
;** 
}++ 	
public-- 
new-- 
retConsReciNFe-- !
Retorno--" )
{--* +
get--, /
;--/ 0
set--1 4
;--4 5
}--6 7
}.. 
}// ü	
\C:\Users\SWDEV\Source\Repos\SW10.SWMANAGER\NFe\NFe.Servicos\Retorno\RetornoNfeRetRecepcao.cs
	namespace## 	
NFe##
 
.## 
Servicos## 
.## 
Retorno## 
{$$ 
public%% 

class%% !
RetornoNfeRetRecepcao%% &
:%%' (
RetornoBasico%%) 6
{&& 
public'' !
RetornoNfeRetRecepcao'' $
(''$ %
string''% +
envioStr'', 4
,''4 5
string''6 <

retornoStr''= G
,''G H
string''I O
retornoCompletaStr''P b
,''b c
retConsReciNFe''d r
retorno''s z
)''z {
:(( 
base(( 
((( 
envioStr(( 
,(( 

retornoStr(( '
,((' (
retornoCompletaStr(() ;
,((; <
retorno((= D
)((D E
{)) 	
Retorno** 
=** 
retorno** 
;** 
}++ 	
public-- 
new-- 
retConsReciNFe-- !
Retorno--" )
{--* +
get--, /
;--/ 0
set--1 4
;--4 5
}--6 7
}.. 
}// ß	
^C:\Users\SWDEV\Source\Repos\SW10.SWMANAGER\NFe\NFe.Servicos\Retorno\RetornoNfeStatusServico.cs
	namespace## 	
NFe##
 
.## 
Servicos## 
.## 
Retorno## 
{$$ 
public%% 

class%% #
RetornoNfeStatusServico%% (
:%%) *
RetornoBasico%%+ 8
{&& 
public'' #
RetornoNfeStatusServico'' &
(''& '
string''' -
envioStr''. 6
,''6 7
string''8 >

retornoStr''? I
,''I J
string''K Q
retornoCompletaStr''R d
,''d e
retConsStatServ''f u
retorno''v }
)''} ~
:(( 
base(( 
((( 
envioStr(( 
,(( 

retornoStr(( '
,((' (
retornoCompletaStr(() ;
,((; <
retorno((= D
)((D E
{)) 	
Retorno** 
=** 
retorno** 
;** 
}++ 	
public-- 
new-- 
retConsStatServ-- "
Retorno--# *
{--+ ,
get--- 0
;--0 1
set--2 5
;--5 6
}--7 8
}.. 
}// Ω≈
JC:\Users\SWDEV\Source\Repos\SW10.SWMANAGER\NFe\NFe.Servicos\ServicosNFe.cs
	namespaceVV 	
NFeVV
 
.VV 
ServicosVV 
{WW 
publicXX 

sealedXX 
classXX 
ServicosNFeXX #
:XX$ %
IDisposableXX& 1
{YY 
privateZZ 
readonlyZZ 
X509Certificate2ZZ )
_certificadoZZ* 6
;ZZ6 7
private[[ 
readonly[[ 
ConfiguracaoServico[[ ,
_cFgServico[[- 8
;[[8 9
private\\ 
readonly\\ 
string\\ 
_path\\  %
;\\% &
publicbb 
ServicosNFebb 
(bb 
ConfiguracaoServicobb .

cFgServicobb/ 9
)bb9 :
{cc 	
_cFgServicodd 
=dd 

cFgServicodd $
;dd$ %
_certificadoee 
=ee 
CertificadoDigitalee -
.ee- .
ObterCertificadoee. >
(ee> ?
ConfiguracaoServicoee? R
.eeR S
	InstanciaeeS \
.ee\ ]
Certificadoee] h
)eeh i
;eei j
_pathff 
=ff 
Pathff 
.ff 
GetDirectoryNameff )
(ff) *
Assemblyff* 2
.ff2 3 
GetExecutingAssemblyff3 G
(ffG H
)ffH I
.ffI J
LocationffJ R
)ffR S
;ffS T
ServicePointManagerii 
.ii  
SecurityProtocolii  0
=ii1 2

cFgServicoii3 =
.ii= > 
ProtocoloDeSegurancaii> R
;iiR S
}jj 	
privatell 
voidll 
SalvarArquivoXmlll %
(ll% &
stringll& ,
nomeArquivoll- 8
,ll8 9
stringll: @
	xmlStringllA J
)llJ K
{mm 	
ifnn 
(nn 
!nn 
_cFgServiconn 
.nn 
SalvarXmlServicosnn .
)nn. /
returnnn0 6
;nn6 7
varoo 
diroo 
=oo 
stringoo 
.oo 
IsNullOrEmptyoo *
(oo* +
_cFgServicooo+ 6
.oo6 7
DiretorioSalvarXmloo7 I
)ooI J
?ooK L
_pathooM R
:ooS T
_cFgServicoooU `
.oo` a
DiretorioSalvarXmlooa s
;oos t
varpp 
stwpp 
=pp 
newpp 
StreamWriterpp &
(pp& '
dirpp' *
+pp+ ,
$strpp- 1
+pp2 3
nomeArquivopp4 ?
)pp? @
;pp@ A
stwqq 
.qq 
	WriteLineqq 
(qq 
	xmlStringqq #
)qq# $
;qq$ %
stwrr 
.rr 
Closerr 
(rr 
)rr 
;rr 
}ss 	
privateuu "
INfeServicoAutorizacaouu &#
CriarServicoAutorizacaouu' >
(uu> ?

ServicoNFeuu? I
servicouuJ Q
)uuQ R
{vv 	
varww 
urlww 
=ww 
Enderecadorww !
.ww! "
ObterUrlServicoww" 1
(ww1 2
servicoww2 9
,ww9 :
_cFgServicoww; F
)wwF G
;wwG H
ifxx 
(xx 
servicoxx 
!=xx 

ServicoNFexx %
.xx% &
NFeAutorizacaoxx& 4
)xx4 5
throwyy 
newyy 
	Exceptionyy #
(yy# $
stringzz 
.zz 
Formatzz !
(zz! "
$strzz" T
,zzT U
servicozzV ]
,zz] ^

MethodBase{{ "
.{{" #
GetCurrentMethod{{# 3
({{3 4
){{4 5
.{{5 6
Name{{6 :
){{: ;
){{; <
;{{< =
if|| 
(|| 
_cFgServico|| 
.|| 
cUF|| 
==||  "
	EstadoNfe||# ,
.||, -
PR||- /
&||0 1
_cFgServico||2 =
.||= > 
VersaoNFeAutorizacao||> R
==||S U
VersaoServico||V c
.||c d
ve310||d i
)||i j
return}} 
new}} 
NfeAutorizacao3}} *
(}}* +
url}}+ .
,}}. /
_certificado}}0 <
,}}< =
_cFgServico}}> I
.}}I J
TimeOut}}J Q
)}}Q R
;}}R S
return~~ 
new~~ 
NfeAutorizacao~~ %
(~~% &
url~~& )
,~~) *
_certificado~~+ 7
,~~7 8
_cFgServico~~9 D
.~~D E
TimeOut~~E L
)~~L M
;~~M N
} 	
private
ÅÅ 
INfeServico
ÅÅ 
CriarServico
ÅÅ (
(
ÅÅ( )

ServicoNFe
ÅÅ) 3
servico
ÅÅ4 ;
)
ÅÅ; <
{
ÇÇ 	
var
ÉÉ 
url
ÉÉ 
=
ÉÉ 
Enderecador
ÉÉ !
.
ÉÉ! "
ObterUrlServico
ÉÉ" 1
(
ÉÉ1 2
servico
ÉÉ2 9
,
ÉÉ9 :
_cFgServico
ÉÉ; F
)
ÉÉF G
;
ÉÉG H
switch
ÑÑ 
(
ÑÑ 
servico
ÑÑ 
)
ÑÑ 
{
ÖÖ 
case
ÜÜ 

ServicoNFe
ÜÜ 
.
ÜÜ  
NfeStatusServico
ÜÜ  0
:
ÜÜ0 1
if
áá 
(
áá 
_cFgServico
áá #
.
áá# $
cUF
áá$ '
==
áá( *
	EstadoNfe
áá+ 4
.
áá4 5
PR
áá5 7
&
áá8 9
_cFgServico
áá: E
.
ááE F$
VersaoNfeStatusServico
ááF \
==
áá] _
VersaoServico
áá` m
.
áám n
ve310
áán s
)
áás t
{
àà 
return
ââ 
new
ââ "
NfeStatusServico3
ââ# 4
(
ââ4 5
url
ââ5 8
,
ââ8 9
_certificado
ââ: F
,
ââF G
_cFgServico
ââH S
.
ââS T
TimeOut
ââT [
)
ââ[ \
;
ââ\ ]
}
ää 
if
ãã 
(
ãã 
_cFgServico
ãã #
.
ãã# $
cUF
ãã$ '
==
ãã( *
	EstadoNfe
ãã+ 4
.
ãã4 5
BA
ãã5 7
&
ãã8 9
_cFgServico
ãã: E
.
ããE F$
VersaoNfeStatusServico
ããF \
==
ãã] _
VersaoServico
ãã` m
.
ããm n
ve310
ããn s
&
ããt u
_cFgServico
åå #
.
åå# $
ModeloDocumento
åå$ 3
==
åå4 6
ModeloDocumento
åå7 F
.
ååF G
NFe
ååG J
)
ååJ K
{
çç 
return
éé 
new
éé "
NfeStatusServico
éé# 3
(
éé3 4
url
éé4 7
,
éé7 8
_certificado
éé9 E
,
ééE F
_cFgServico
ééG R
.
ééR S
TimeOut
ééS Z
)
ééZ [
;
éé[ \
}
èè 
return
êê 
new
êê 
NfeStatusServico2
êê 0
(
êê0 1
url
êê1 4
,
êê4 5
_certificado
êê6 B
,
êêB C
_cFgServico
êêD O
.
êêO P
TimeOut
êêP W
)
êêW X
;
êêX Y
case
íí 

ServicoNFe
íí 
.
íí  "
NfeConsultaProtocolo
íí  4
:
íí4 5
if
ìì 
(
ìì 
_cFgServico
ìì #
.
ìì# $
cUF
ìì$ '
==
ìì( *
	EstadoNfe
ìì+ 4
.
ìì4 5
PR
ìì5 7
&
ìì8 9
_cFgServico
ìì: E
.
ììE F(
VersaoNfeConsultaProtocolo
ììF `
==
ììa c
VersaoServico
ììd q
.
ììq r
ve310
ììr w
)
ììw x
{
îî 
return
ïï 
new
ïï "
NfeConsulta3
ïï# /
(
ïï/ 0
url
ïï0 3
,
ïï3 4
_certificado
ïï5 A
,
ïïA B
_cFgServico
ïïC N
.
ïïN O
TimeOut
ïïO V
)
ïïV W
;
ïïW X
}
ññ 
if
óó 
(
óó 
_cFgServico
óó #
.
óó# $
cUF
óó$ '
==
óó( *
	EstadoNfe
óó+ 4
.
óó4 5
BA
óó5 7
&
óó8 9
_cFgServico
óó: E
.
óóE F(
VersaoNfeConsultaProtocolo
óóF `
==
óóa c
VersaoServico
óód q
.
óóq r
ve310
óór w
&
óóx y
_cFgServico
òò #
.
òò# $
ModeloDocumento
òò$ 3
==
òò4 6
ModeloDocumento
òò7 F
.
òòF G
NFe
òòG J
)
òòJ K
{
ôô 
return
öö 
new
öö "
NfeConsulta
öö# .
(
öö. /
url
öö/ 2
,
öö2 3
_certificado
öö4 @
,
öö@ A
_cFgServico
ööB M
.
ööM N
TimeOut
ööN U
)
ööU V
;
ööV W
}
õõ 
return
úú 
new
úú 
NfeConsulta2
úú +
(
úú+ ,
url
úú, /
,
úú/ 0
_certificado
úú1 =
,
úú= >
_cFgServico
úú? J
.
úúJ K
TimeOut
úúK R
)
úúR S
;
úúS T
case
ûû 

ServicoNFe
ûû 
.
ûû  
NfeRecepcao
ûû  +
:
ûû+ ,
return
üü 
new
üü 
NfeRecepcao2
üü +
(
üü+ ,
url
üü, /
,
üü/ 0
_certificado
üü1 =
,
üü= >
_cFgServico
üü? J
.
üüJ K
TimeOut
üüK R
)
üüR S
;
üüS T
case
°° 

ServicoNFe
°° 
.
°°  
NfeRetRecepcao
°°  .
:
°°. /
return
¢¢ 
new
¢¢ 
NfeRetRecepcao2
¢¢ .
(
¢¢. /
url
¢¢/ 2
,
¢¢2 3
_certificado
¢¢4 @
,
¢¢@ A
_cFgServico
¢¢B M
.
¢¢M N
TimeOut
¢¢N U
)
¢¢U V
;
¢¢V W
case
§§ 

ServicoNFe
§§ 
.
§§  
NFeAutorizacao
§§  .
:
§§. /
throw
•• 
new
•• 
	Exception
•• '
(
••' (
string
••( .
.
••. /
Format
••/ 5
(
••5 6
$str
••6 h
,
••h i
servico
••j q
,
••q r

MethodBase
¶¶ "
.
¶¶" #
GetCurrentMethod
¶¶# 3
(
¶¶3 4
)
¶¶4 5
.
¶¶5 6
Name
¶¶6 :
)
¶¶: ;
)
¶¶; <
;
¶¶< =
case
®® 

ServicoNFe
®® 
.
®®  
NFeRetAutorizacao
®®  1
:
®®1 2
if
©© 
(
©© 
_cFgServico
©© #
.
©©# $
cUF
©©$ '
==
©©( *
	EstadoNfe
©©+ 4
.
©©4 5
PR
©©5 7
&
©©8 9
_cFgServico
©©: E
.
©©E F"
VersaoNFeAutorizacao
©©F Z
==
©©[ ]
VersaoServico
©©^ k
.
©©k l
ve310
©©l q
)
©©q r
return
™™ 
new
™™ " 
NfeRetAutorizacao3
™™# 5
(
™™5 6
url
™™6 9
,
™™9 :
_certificado
™™; G
,
™™G H
_cFgServico
™™I T
.
™™T U
TimeOut
™™U \
)
™™\ ]
;
™™] ^
return
´´ 
new
´´ 
NfeRetAutorizacao
´´ 0
(
´´0 1
url
´´1 4
,
´´4 5
_certificado
´´6 B
,
´´B C
_cFgServico
´´D O
.
´´O P
TimeOut
´´P W
)
´´W X
;
´´X Y
case
≠≠ 

ServicoNFe
≠≠ 
.
≠≠  
NfeInutilizacao
≠≠  /
:
≠≠/ 0
if
ÆÆ 
(
ÆÆ 
_cFgServico
ÆÆ #
.
ÆÆ# $
cUF
ÆÆ$ '
==
ÆÆ( *
	EstadoNfe
ÆÆ+ 4
.
ÆÆ4 5
PR
ÆÆ5 7
&
ÆÆ8 9
_cFgServico
ÆÆ: E
.
ÆÆE F$
VersaoNfeStatusServico
ÆÆF \
==
ÆÆ] _
VersaoServico
ÆÆ` m
.
ÆÆm n
ve310
ÆÆn s
)
ÆÆs t
{
ØØ 
return
∞∞ 
new
∞∞ "
NfeInutilizacao3
∞∞# 3
(
∞∞3 4
url
∞∞4 7
,
∞∞7 8
_certificado
∞∞9 E
,
∞∞E F
_cFgServico
∞∞G R
.
∞∞R S
TimeOut
∞∞S Z
)
∞∞Z [
;
∞∞[ \
}
±± 
if
≤≤ 
(
≤≤ 
_cFgServico
≤≤ #
.
≤≤# $
cUF
≤≤$ '
==
≤≤( *
	EstadoNfe
≤≤+ 4
.
≤≤4 5
BA
≤≤5 7
&
≤≤8 9
_cFgServico
≤≤: E
.
≤≤E F$
VersaoNfeStatusServico
≤≤F \
==
≤≤] _
VersaoServico
≤≤` m
.
≤≤m n
ve310
≤≤n s
&
≤≤t u
_cFgServico
≥≥ #
.
≥≥# $
ModeloDocumento
≥≥$ 3
==
≥≥4 6
ModeloDocumento
≥≥7 F
.
≥≥F G
NFe
≥≥G J
)
≥≥J K
{
¥¥ 
return
µµ 
new
µµ "
NfeInutilizacao
µµ# 2
(
µµ2 3
url
µµ3 6
,
µµ6 7
_certificado
µµ8 D
,
µµD E
_cFgServico
µµF Q
.
µµQ R
TimeOut
µµR Y
)
µµY Z
;
µµZ [
}
∂∂ 
return
∑∑ 
new
∑∑ 
NfeInutilizacao2
∑∑ /
(
∑∑/ 0
url
∑∑0 3
,
∑∑3 4
_certificado
∑∑5 A
,
∑∑A B
_cFgServico
∑∑C N
.
∑∑N O
TimeOut
∑∑O V
)
∑∑V W
;
∑∑W X
case
ππ 

ServicoNFe
ππ 
.
ππ  '
RecepcaoEventoCancelmento
ππ  9
:
ππ9 :
case
∫∫ 

ServicoNFe
∫∫ 
.
∫∫  )
RecepcaoEventoCartaCorrecao
∫∫  ;
:
∫∫; <
case
ªª 

ServicoNFe
ªª 
.
ªª  4
&RecepcaoEventoManifestacaoDestinatario
ªª  F
:
ªªF G
return
ºº 
new
ºº 
RecepcaoEvento
ºº -
(
ºº- .
url
ºº. 1
,
ºº1 2
_certificado
ºº3 ?
,
ºº? @
_cFgServico
ººA L
.
ººL M
TimeOut
ººM T
)
ººT U
;
ººU V
case
ΩΩ 

ServicoNFe
ΩΩ 
.
ΩΩ   
RecepcaoEventoEpec
ΩΩ  2
:
ΩΩ2 3
return
ææ 
new
ææ 
RecepcaoEPEC
ææ +
(
ææ+ ,
url
ææ, /
,
ææ/ 0
_certificado
ææ1 =
,
ææ= >
_cFgServico
ææ? J
.
ææJ K
TimeOut
ææK R
)
ææR S
;
ææS T
case
¿¿ 

ServicoNFe
¿¿ 
.
¿¿  !
NfeConsultaCadastro
¿¿  3
:
¿¿3 4
switch
¡¡ 
(
¡¡ 
_cFgServico
¡¡ '
.
¡¡' (
cUF
¡¡( +
)
¡¡+ ,
{
¬¬ 
case
√√ 
	EstadoNfe
√√ &
.
√√& '
CE
√√' )
:
√√) *
return
ƒƒ "
new
ƒƒ# &
Wsdl
ƒƒ' +
.
ƒƒ+ ,
ConsultaCadastro
ƒƒ, <
.
ƒƒ< =
CE
ƒƒ= ?
.
ƒƒ? @"
CadConsultaCadastro2
ƒƒ@ T
(
ƒƒT U
url
ƒƒU X
,
ƒƒX Y
_certificado
ƒƒZ f
,
ƒƒf g
_cFgServico
≈≈  +
.
≈≈+ ,
TimeOut
≈≈, 3
)
≈≈3 4
;
≈≈4 5
}
∆∆ 
return
«« 
new
«« 
Wsdl
«« #
.
««# $
ConsultaCadastro
««$ 4
.
««4 5

DEMAIS_UFs
««5 ?
.
««? @"
CadConsultaCadastro2
««@ T
(
««T U
url
««U X
,
««X Y
_certificado
««Z f
,
««f g
_cFgServico
»» #
.
»»# $
TimeOut
»»$ +
)
»»+ ,
;
»», -
case
   

ServicoNFe
   
.
    
NfeDownloadNF
    -
:
  - .
return
ÀÀ 
new
ÀÀ 
NfeDownloadNF
ÀÀ ,
(
ÀÀ, -
url
ÀÀ- 0
,
ÀÀ0 1
_certificado
ÀÀ2 >
,
ÀÀ> ?
_cFgServico
ÀÀ@ K
.
ÀÀK L
TimeOut
ÀÀL S
)
ÀÀS T
;
ÀÀT U
case
ÕÕ 

ServicoNFe
ÕÕ 
.
ÕÕ  "
NfceAdministracaoCSC
ÕÕ  4
:
ÕÕ4 5
return
ŒŒ 
new
ŒŒ 
NfceCsc
ŒŒ &
(
ŒŒ& '
url
ŒŒ' *
,
ŒŒ* +
_certificado
ŒŒ, 8
,
ŒŒ8 9
_cFgServico
ŒŒ: E
.
ŒŒE F
TimeOut
ŒŒF M
)
ŒŒM N
;
ŒŒN O
case
–– 

ServicoNFe
–– 
.
––   
NFeDistribuicaoDFe
––  2
:
––2 3
return
—— 
new
—— !
NfeDistDFeInteresse
—— 2
(
——2 3
url
——3 6
,
——6 7
_certificado
——8 D
,
——D E
_cFgServico
——F Q
.
——Q R
TimeOut
——R Y
)
——Y Z
;
——Z [
}
”” 
return
’’ 
null
’’ 
;
’’ 
}
÷÷ 	
public
‹‹ %
RetornoNfeStatusServico
‹‹ &
NfeStatusServico
‹‹' 7
(
‹‹7 8
)
‹‹8 9
{
›› 	
var
ﬁﬁ 
versaoServico
ﬁﬁ 
=
ﬁﬁ 

ServicoNFe
ﬁﬁ  *
.
ﬁﬁ* +
NfeStatusServico
ﬁﬁ+ ;
.
ﬁﬁ; <%
VersaoServicoParaString
ﬁﬁ< S
(
ﬁﬁS T
_cFgServico
ﬁﬁT _
.
ﬁﬁ_ `$
VersaoNfeStatusServico
ﬁﬁ` v
)
ﬁﬁv w
;
ﬁﬁw x
var
‚‚ 
ws
‚‚ 
=
‚‚ 
CriarServico
‚‚ !
(
‚‚! "

ServicoNFe
‚‚" ,
.
‚‚, -
NfeStatusServico
‚‚- =
)
‚‚= >
;
‚‚> ?
ws
‰‰ 
.
‰‰ 
nfeCabecMsg
‰‰ 
=
‰‰ 
new
‰‰  
nfeCabecMsg
‰‰! ,
{
ÂÂ 
cUF
ÊÊ 
=
ÊÊ 
_cFgServico
ÊÊ !
.
ÊÊ! "
cUF
ÊÊ" %
,
ÊÊ% &
versaoDados
ÁÁ 
=
ÁÁ 
versaoServico
ÁÁ +
}
ËË 
;
ËË 
var
ÓÓ 
	pedStatus
ÓÓ 
=
ÓÓ 
new
ÓÓ 
consStatServ
ÓÓ  ,
{
ÔÔ 
cUF
 
=
 
_cFgServico
 !
.
! "
cUF
" %
,
% &
tpAmb
ÒÒ 
=
ÒÒ 
_cFgServico
ÒÒ #
.
ÒÒ# $
tpAmb
ÒÒ$ )
,
ÒÒ) *
versao
ÚÚ 
=
ÚÚ 
versaoServico
ÚÚ &
}
ÛÛ 
;
ÛÛ 
var
˘˘ 
	xmlStatus
˘˘ 
=
˘˘ 
	pedStatus
˘˘ %
.
˘˘% &
ObterXmlString
˘˘& 4
(
˘˘4 5
)
˘˘5 6
;
˘˘6 7
	Validador
˙˙ 
.
˙˙ 
Valida
˙˙ 
(
˙˙ 

ServicoNFe
˙˙ '
.
˙˙' (
NfeStatusServico
˙˙( 8
,
˙˙8 9
_cFgServico
˙˙: E
.
˙˙E F$
VersaoNfeStatusServico
˙˙F \
,
˙˙\ ]
	xmlStatus
˙˙^ g
)
˙˙g h
;
˙˙h i
var
˚˚ 
dadosStatus
˚˚ 
=
˚˚ 
new
˚˚ !
XmlDocument
˚˚" -
(
˚˚- .
)
˚˚. /
;
˚˚/ 0
dadosStatus
¸¸ 
.
¸¸ 
LoadXml
¸¸ 
(
¸¸  
	xmlStatus
¸¸  )
)
¸¸) *
;
¸¸* +
XmlNode
ÄÄ 
retorno
ÄÄ 
;
ÄÄ 
try
ÅÅ 
{
ÇÇ 
retorno
ÉÉ 
=
ÉÉ 
ws
ÉÉ 
.
ÉÉ 
Execute
ÉÉ $
(
ÉÉ$ %
dadosStatus
ÉÉ% 0
)
ÉÉ0 1
;
ÉÉ1 2
}
ÑÑ 
catch
ÖÖ 
(
ÖÖ 
WebException
ÖÖ 
ex
ÖÖ  "
)
ÖÖ" #
{
ÜÜ 
throw
áá )
FabricaComunicacaoException
áá 1
.
áá1 2
ObterException
áá2 @
(
áá@ A

ServicoNFe
ááA K
.
ááK L
NfeStatusServico
ááL \
,
áá\ ]
ex
áá^ `
)
áá` a
;
ááa b
}
àà 
var
ää 
retornoXmlString
ää  
=
ää! "
retorno
ää# *
.
ää* +
OuterXml
ää+ 3
;
ää3 4
var
ãã 
retConsStatServ
ãã 
=
ãã  !
new
ãã" %
retConsStatServ
ãã& 5
(
ãã5 6
)
ãã6 7
.
ãã7 8!
CarregarDeXmlString
ãã8 K
(
ããK L
retornoXmlString
ããL \
)
ãã\ ]
;
ãã] ^
return
èè 
new
èè %
RetornoNfeStatusServico
èè .
(
èè. /
	pedStatus
èè/ 8
.
èè8 9
ObterXmlString
èè9 G
(
èèG H
)
èèH I
,
èèI J
retConsStatServ
èèK Z
.
èèZ [
ObterXmlString
èè[ i
(
èèi j
)
èèj k
,
èèk l
retornoXmlString
êê  
,
êê  !
retConsStatServ
êê" 1
)
êê1 2
;
êê2 3
}
ìì 	
public
ôô )
RetornoNfeConsultaProtocolo
ôô *"
NfeConsultaProtocolo
ôô+ ?
(
ôô? @
string
ôô@ F
chave
ôôG L
)
ôôL M
{
öö 	
var
õõ 
versaoServico
õõ 
=
õõ 

ServicoNFe
úú 
.
úú "
NfeConsultaProtocolo
úú /
.
úú/ 0%
VersaoServicoParaString
úú0 G
(
úúG H
_cFgServico
úúH S
.
úúS T(
VersaoNfeConsultaProtocolo
úúT n
)
úún o
;
úúo p
var
†† 
ws
†† 
=
†† 
CriarServico
†† !
(
††! "

ServicoNFe
††" ,
.
††, -"
NfeConsultaProtocolo
††- A
)
††A B
;
††B C
ws
¢¢ 
.
¢¢ 
nfeCabecMsg
¢¢ 
=
¢¢ 
new
¢¢  
nfeCabecMsg
¢¢! ,
{
££ 
cUF
§§ 
=
§§ 
_cFgServico
§§ !
.
§§! "
cUF
§§" %
,
§§% &
versaoDados
•• 
=
•• 
versaoServico
•• +
}
¶¶ 
;
¶¶ 
var
¨¨ 
pedConsulta
¨¨ 
=
¨¨ 
new
¨¨ !

consSitNFe
¨¨" ,
{
≠≠ 
versao
ÆÆ 
=
ÆÆ 
versaoServico
ÆÆ &
,
ÆÆ& '
tpAmb
ØØ 
=
ØØ 
_cFgServico
ØØ #
.
ØØ# $
tpAmb
ØØ$ )
,
ØØ) *
chNFe
∞∞ 
=
∞∞ 
chave
∞∞ 
}
±± 
;
±± 
var
∑∑ 
xmlConsulta
∑∑ 
=
∑∑ 
pedConsulta
∑∑ )
.
∑∑) *
ObterXmlString
∑∑* 8
(
∑∑8 9
)
∑∑9 :
;
∑∑: ;
	Validador
∏∏ 
.
∏∏ 
Valida
∏∏ 
(
∏∏ 

ServicoNFe
∏∏ '
.
∏∏' ("
NfeConsultaProtocolo
∏∏( <
,
∏∏< =
_cFgServico
∏∏> I
.
∏∏I J(
VersaoNfeConsultaProtocolo
∏∏J d
,
∏∏d e
xmlConsulta
∏∏f q
)
∏∏q r
;
∏∏r s
var
ππ 
dadosConsulta
ππ 
=
ππ 
new
ππ  #
XmlDocument
ππ$ /
(
ππ/ 0
)
ππ0 1
;
ππ1 2
dadosConsulta
∫∫ 
.
∫∫ 
LoadXml
∫∫ !
(
∫∫! "
xmlConsulta
∫∫" -
)
∫∫- .
;
∫∫. /
XmlNode
ææ 
retorno
ææ 
;
ææ 
try
øø 
{
¿¿ 
retorno
¡¡ 
=
¡¡ 
ws
¡¡ 
.
¡¡ 
Execute
¡¡ $
(
¡¡$ %
dadosConsulta
¡¡% 2
)
¡¡2 3
;
¡¡3 4
}
¬¬ 
catch
√√ 
(
√√ 
WebException
√√ 
ex
√√  "
)
√√" #
{
ƒƒ 
throw
≈≈ )
FabricaComunicacaoException
≈≈ 1
.
≈≈1 2
ObterException
≈≈2 @
(
≈≈@ A

ServicoNFe
≈≈A K
.
≈≈K L"
NfeConsultaProtocolo
≈≈L `
,
≈≈` a
ex
≈≈b d
)
≈≈d e
;
≈≈e f
}
∆∆ 
var
»» 
retornoXmlString
»»  
=
»»! "
retorno
»»# *
.
»»* +
OuterXml
»»+ 3
;
»»3 4
var
…… 
retConsulta
…… 
=
…… 
new
…… !
retConsSitNFe
……" /
(
……/ 0
)
……0 1
.
……1 2!
CarregarDeXmlString
……2 E
(
……E F
retornoXmlString
……F V
)
……V W
;
……W X
return
ÕÕ 
new
ÕÕ )
RetornoNfeConsultaProtocolo
ÕÕ 2
(
ÕÕ2 3
pedConsulta
ÕÕ3 >
.
ÕÕ> ?
ObterXmlString
ÕÕ? M
(
ÕÕM N
)
ÕÕN O
,
ÕÕO P
retConsulta
ÕÕQ \
.
ÕÕ\ ]
ObterXmlString
ÕÕ] k
(
ÕÕk l
)
ÕÕl m
,
ÕÕm n
retornoXmlString
ŒŒ  
,
ŒŒ  !
retConsulta
ŒŒ" -
)
ŒŒ- .
;
ŒŒ. /
}
—— 	
public
ﬁﬁ $
RetornoNfeInutilizacao
ﬁﬁ %
NfeInutilizacao
ﬁﬁ& 5
(
ﬁﬁ5 6
string
ﬁﬁ6 <
cnpj
ﬁﬁ= A
,
ﬁﬁA B
int
ﬁﬁC F
ano
ﬁﬁG J
,
ﬁﬁJ K
ModeloDocumento
ﬁﬁL [
modelo
ﬁﬁ\ b
,
ﬁﬁb c
int
ﬁﬁd g
serie
ﬁﬁh m
,
ﬁﬁm n
int
ﬂﬂ 
numeroInicial
ﬂﬂ 
,
ﬂﬂ 
int
ﬂﬂ "
numeroFinal
ﬂﬂ# .
,
ﬂﬂ. /
string
ﬂﬂ0 6
justificativa
ﬂﬂ7 D
)
ﬂﬂD E
{
‡‡ 	
var
·· 
versaoServico
·· 
=
·· 

ServicoNFe
··  *
.
··* +
NfeInutilizacao
··+ :
.
··: ;%
VersaoServicoParaString
··; R
(
··R S
_cFgServico
··S ^
.
··^ _#
VersaoNfeInutilizacao
··_ t
)
··t u
;
··u v
var
ÂÂ 
ws
ÂÂ 
=
ÂÂ 
CriarServico
ÂÂ !
(
ÂÂ! "

ServicoNFe
ÂÂ" ,
.
ÂÂ, -
NfeInutilizacao
ÂÂ- <
)
ÂÂ< =
;
ÂÂ= >
ws
ÁÁ 
.
ÁÁ 
nfeCabecMsg
ÁÁ 
=
ÁÁ 
new
ÁÁ  
nfeCabecMsg
ÁÁ! ,
{
ËË 
cUF
ÈÈ 
=
ÈÈ 
_cFgServico
ÈÈ !
.
ÈÈ! "
cUF
ÈÈ" %
,
ÈÈ% &
versaoDados
ÍÍ 
=
ÍÍ 
versaoServico
ÍÍ +
}
ÎÎ 
;
ÎÎ 
var
ÒÒ 
pedInutilizacao
ÒÒ 
=
ÒÒ  !
new
ÒÒ" %
inutNFe
ÒÒ& -
{
ÚÚ 
versao
ÛÛ 
=
ÛÛ 
versaoServico
ÛÛ &
,
ÛÛ& '
infInut
ÙÙ 
=
ÙÙ 
new
ÙÙ 

infInutEnv
ÙÙ (
{
ıı 
tpAmb
ˆˆ 
=
ˆˆ 
_cFgServico
ˆˆ '
.
ˆˆ' (
tpAmb
ˆˆ( -
,
ˆˆ- .
cUF
˜˜ 
=
˜˜ 
_cFgServico
˜˜ %
.
˜˜% &
cUF
˜˜& )
,
˜˜) *
ano
¯¯ 
=
¯¯ 
ano
¯¯ 
,
¯¯ 
CNPJ
˘˘ 
=
˘˘ 
cnpj
˘˘ 
,
˘˘  
mod
˙˙ 
=
˙˙ 
modelo
˙˙  
,
˙˙  !
serie
˚˚ 
=
˚˚ 
serie
˚˚ !
,
˚˚! "
nNFIni
¸¸ 
=
¸¸ 
numeroInicial
¸¸ *
,
¸¸* +
nNFFin
˝˝ 
=
˝˝ 
numeroFinal
˝˝ (
,
˝˝( )
xJust
˛˛ 
=
˛˛ 
justificativa
˛˛ )
}
ˇˇ 
}
ÄÄ 
;
ÄÄ 
var
ÇÇ 
numId
ÇÇ 
=
ÇÇ 
string
ÇÇ 
.
ÇÇ 
Concat
ÇÇ %
(
ÇÇ% &
(
ÇÇ& '
int
ÇÇ' *
)
ÇÇ* +
pedInutilizacao
ÇÇ+ :
.
ÇÇ: ;
infInut
ÇÇ; B
.
ÇÇB C
cUF
ÇÇC F
,
ÇÇF G
pedInutilizacao
ÇÇH W
.
ÇÇW X
infInut
ÇÇX _
.
ÇÇ_ `
ano
ÇÇ` c
,
ÇÇc d
pedInutilizacao
ÉÉ 
.
ÉÉ  
infInut
ÉÉ  '
.
ÉÉ' (
CNPJ
ÉÉ( ,
,
ÉÉ, -
(
ÉÉ. /
int
ÉÉ/ 2
)
ÉÉ2 3
pedInutilizacao
ÉÉ3 B
.
ÉÉB C
infInut
ÉÉC J
.
ÉÉJ K
mod
ÉÉK N
,
ÉÉN O
pedInutilizacao
ÑÑ 
.
ÑÑ  
infInut
ÑÑ  '
.
ÑÑ' (
serie
ÑÑ( -
.
ÑÑ- .
ToString
ÑÑ. 6
(
ÑÑ6 7
)
ÑÑ7 8
.
ÑÑ8 9
PadLeft
ÑÑ9 @
(
ÑÑ@ A
$num
ÑÑA B
,
ÑÑB C
$char
ÑÑD G
)
ÑÑG H
,
ÑÑH I
pedInutilizacao
ÖÖ 
.
ÖÖ  
infInut
ÖÖ  '
.
ÖÖ' (
nNFIni
ÖÖ( .
.
ÖÖ. /
ToString
ÖÖ/ 7
(
ÖÖ7 8
)
ÖÖ8 9
.
ÖÖ9 :
PadLeft
ÖÖ: A
(
ÖÖA B
$num
ÖÖB C
,
ÖÖC D
$char
ÖÖE H
)
ÖÖH I
,
ÖÖI J
pedInutilizacao
ÜÜ 
.
ÜÜ  
infInut
ÜÜ  '
.
ÜÜ' (
nNFFin
ÜÜ( .
.
ÜÜ. /
ToString
ÜÜ/ 7
(
ÜÜ7 8
)
ÜÜ8 9
.
ÜÜ9 :
PadLeft
ÜÜ: A
(
ÜÜA B
$num
ÜÜB C
,
ÜÜC D
$char
ÜÜE H
)
ÜÜH I
)
ÜÜI J
;
ÜÜJ K
pedInutilizacao
áá 
.
áá 
infInut
áá #
.
áá# $
Id
áá$ &
=
áá' (
$str
áá) -
+
áá. /
numId
áá0 5
;
áá5 6
pedInutilizacao
ââ 
.
ââ 
Assina
ââ "
(
ââ" #
_certificado
ââ# /
)
ââ/ 0
;
ââ0 1
var
èè 
xmlInutilizacao
èè 
=
èè  !
pedInutilizacao
èè" 1
.
èè1 2
ObterXmlString
èè2 @
(
èè@ A
)
èèA B
;
èèB C
	Validador
êê 
.
êê 
Valida
êê 
(
êê 

ServicoNFe
êê '
.
êê' (
NfeInutilizacao
êê( 7
,
êê7 8
_cFgServico
êê9 D
.
êêD E#
VersaoNfeInutilizacao
êêE Z
,
êêZ [
xmlInutilizacao
êê\ k
)
êêk l
;
êêl m
var
ëë 
dadosInutilizacao
ëë !
=
ëë" #
new
ëë$ '
XmlDocument
ëë( 3
(
ëë3 4
)
ëë4 5
;
ëë5 6
dadosInutilizacao
íí 
.
íí 
LoadXml
íí %
(
íí% &
xmlInutilizacao
íí& 5
)
íí5 6
;
íí6 7
XmlNode
ññ 
retorno
ññ 
;
ññ 
try
óó 
{
òò 
retorno
ôô 
=
ôô 
ws
ôô 
.
ôô 
Execute
ôô $
(
ôô$ %
dadosInutilizacao
ôô% 6
)
ôô6 7
;
ôô7 8
}
öö 
catch
õõ 
(
õõ 
WebException
õõ 
ex
õõ  "
)
õõ" #
{
úú 
throw
ùù )
FabricaComunicacaoException
ùù 1
.
ùù1 2
ObterException
ùù2 @
(
ùù@ A

ServicoNFe
ùùA K
.
ùùK L
NfeInutilizacao
ùùL [
,
ùù[ \
ex
ùù] _
)
ùù_ `
;
ùù` a
}
ûû 
var
†† 
retornoXmlString
††  
=
††! "
retorno
††# *
.
††* +
OuterXml
††+ 3
;
††3 4
var
°° 

retInutNFe
°° 
=
°° 
new
°°  

retInutNFe
°°! +
(
°°+ ,
)
°°, -
.
°°- .!
CarregarDeXmlString
°°. A
(
°°A B
retornoXmlString
°°B R
)
°°R S
;
°°S T
return
•• 
new
•• $
RetornoNfeInutilizacao
•• -
(
••- .
pedInutilizacao
••. =
.
••= >
ObterXmlString
••> L
(
••L M
)
••M N
,
••N O

retInutNFe
••P Z
.
••Z [
ObterXmlString
••[ i
(
••i j
)
••j k
,
••k l
retornoXmlString
¶¶  
,
¶¶  !

retInutNFe
¶¶" ,
)
¶¶, -
;
¶¶- .
}
©© 	
private
≤≤ #
RetornoRecepcaoEvento
≤≤ %
RecepcaoEvento
≤≤& 4
(
≤≤4 5
int
≤≤5 8
idlote
≤≤9 ?
,
≤≤? @
List
≤≤A E
<
≤≤E F
evento
≤≤F L
>
≤≤L M
eventos
≤≤N U
,
≤≤U V

ServicoNFe
≤≤W a
servicoEvento
≤≤b o
)
≤≤o p
{
≥≥ 	
var
¥¥ 
listaEventos
¥¥ 
=
¥¥ 
new
¥¥ "
List
¥¥# '
<
¥¥' (

ServicoNFe
¥¥( 2
>
¥¥2 3
{
µµ 

ServicoNFe
∂∂ 
.
∂∂ )
RecepcaoEventoCartaCorrecao
∂∂ 6
,
∂∂6 7

ServicoNFe
∑∑ 
.
∑∑ '
RecepcaoEventoCancelmento
∑∑ 4
,
∑∑4 5

ServicoNFe
∏∏ 
.
∏∏  
RecepcaoEventoEpec
∏∏ -
,
∏∏- .

ServicoNFe
ππ 
.
ππ 4
&RecepcaoEventoManifestacaoDestinatario
ππ A
}
∫∫ 
;
∫∫ 
if
ªª 
(
ªª 
!
ºº 
listaEventos
ºº 
.
ºº 
Contains
ºº &
(
ºº& '
servicoEvento
ºº' 4
)
ºº4 5
)
ºº5 6
throw
ΩΩ 
new
ΩΩ 
	Exception
ΩΩ #
(
ΩΩ# $
string
ææ 
.
ææ 
Format
ææ !
(
ææ! "
$str
ææ" i
,
ææi j
servicoEvento
ææk x
,
ææx y

MethodBase
øø "
.
øø" #
GetCurrentMethod
øø# 3
(
øø3 4
)
øø4 5
.
øø5 6
Name
øø6 :
,
øø: ;
string
øø< B
.
øøB C
Join
øøC G
(
øøG H
$str
øøH O
,
øøO P
listaEventos
øøQ ]
.
øø] ^
ToArray
øø^ e
(
øøe f
)
øøf g
)
øøg h
)
øøh i
)
øøi j
;
øøj k
var
¡¡ 
versaoServico
¡¡ 
=
¡¡ 
servicoEvento
¡¡  -
.
¡¡- .%
VersaoServicoParaString
¡¡. E
(
¡¡E F
_cFgServico
¡¡F Q
.
¡¡Q R1
#VersaoRecepcaoEventoCceCancelamento
¡¡R u
)
¡¡u v
;
¡¡v w
var
≈≈ 
ws
≈≈ 
=
≈≈ 
CriarServico
≈≈ !
(
≈≈! "
servicoEvento
≈≈" /
)
≈≈/ 0
;
≈≈0 1
ws
«« 
.
«« 
nfeCabecMsg
«« 
=
«« 
new
««  
nfeCabecMsg
««! ,
{
»» 
cUF
…… 
=
…… 
_cFgServico
…… !
.
……! "
cUF
……" %
,
……% &
versaoDados
   
=
   
versaoServico
   +
}
ÀÀ 
;
ÀÀ 
var
—— 
	pedEvento
—— 
=
—— 
new
—— 
	envEvento
——  )
{
““ 
versao
”” 
=
”” 
versaoServico
”” &
,
””& '
idLote
‘‘ 
=
‘‘ 
idlote
‘‘ 
,
‘‘  
evento
’’ 
=
’’ 
eventos
’’  
}
÷÷ 
;
÷÷ 
foreach
ÿÿ 
(
ÿÿ 
var
ÿÿ 
evento
ÿÿ 
in
ÿÿ  "
eventos
ÿÿ# *
)
ÿÿ* +
{
ŸŸ 
evento
⁄⁄ 
.
⁄⁄ 
	infEvento
⁄⁄  
.
⁄⁄  !
Id
⁄⁄! #
=
⁄⁄$ %
$str
⁄⁄& *
+
⁄⁄+ ,
evento
⁄⁄- 3
.
⁄⁄3 4
	infEvento
⁄⁄4 =
.
⁄⁄= >
tpEvento
⁄⁄> F
+
⁄⁄G H
evento
⁄⁄I O
.
⁄⁄O P
	infEvento
⁄⁄P Y
.
⁄⁄Y Z
chNFe
⁄⁄Z _
+
⁄⁄` a
evento
€€& ,
.
€€, -
	infEvento
€€- 6
.
€€6 7

nSeqEvento
€€7 A
.
€€A B
ToString
€€B J
(
€€J K
)
€€K L
.
€€L M
PadLeft
€€M T
(
€€T U
$num
€€U V
,
€€V W
$char
€€X [
)
€€[ \
;
€€\ ]
evento
‹‹ 
.
‹‹ 
Assina
‹‹ 
(
‹‹ 
_certificado
‹‹ *
)
‹‹* +
;
‹‹+ ,
}
›› 
var
„„ 
	xmlEvento
„„ 
=
„„ 
	pedEvento
„„ %
.
„„% &
ObterXmlString
„„& 4
(
„„4 5
)
„„5 6
;
„„6 7
	Validador
‰‰ 
.
‰‰ 
Valida
‰‰ 
(
‰‰ 
servicoEvento
‰‰ *
,
‰‰* +
_cFgServico
‰‰, 7
.
‰‰7 81
#VersaoRecepcaoEventoCceCancelamento
‰‰8 [
,
‰‰[ \
	xmlEvento
‰‰] f
)
‰‰f g
;
‰‰g h
var
ÂÂ 
dadosEvento
ÂÂ 
=
ÂÂ 
new
ÂÂ !
XmlDocument
ÂÂ" -
(
ÂÂ- .
)
ÂÂ. /
;
ÂÂ/ 0
dadosEvento
ÊÊ 
.
ÊÊ 
LoadXml
ÊÊ 
(
ÊÊ  
	xmlEvento
ÊÊ  )
)
ÊÊ) *
;
ÊÊ* +
XmlNode
ÍÍ 
retorno
ÍÍ 
;
ÍÍ 
try
ÎÎ 
{
ÏÏ 
retorno
ÌÌ 
=
ÌÌ 
ws
ÌÌ 
.
ÌÌ 
Execute
ÌÌ $
(
ÌÌ$ %
dadosEvento
ÌÌ% 0
)
ÌÌ0 1
;
ÌÌ1 2
}
ÓÓ 
catch
ÔÔ 
(
ÔÔ 
WebException
ÔÔ 
ex
ÔÔ  "
)
ÔÔ" #
{
 
throw
ÒÒ )
FabricaComunicacaoException
ÒÒ 1
.
ÒÒ1 2
ObterException
ÒÒ2 @
(
ÒÒ@ A
servicoEvento
ÒÒA N
,
ÒÒN O
ex
ÒÒP R
)
ÒÒR S
;
ÒÒS T
}
ÚÚ 
var
ÙÙ 
retornoXmlString
ÙÙ  
=
ÙÙ! "
retorno
ÙÙ# *
.
ÙÙ* +
OuterXml
ÙÙ+ 3
;
ÙÙ3 4
var
ıı 
retEnvEvento
ıı 
=
ıı 
new
ıı "
retEnvEvento
ıı# /
(
ıı/ 0
)
ıı0 1
.
ıı1 2!
CarregarDeXmlString
ıı2 E
(
ııE F
retornoXmlString
ııF V
)
ııV W
;
ııW X
var
˚˚ 
listprocEventoNFe
˚˚ !
=
˚˚" #
new
˚˚$ '
List
˚˚( ,
<
˚˚, -
procEventoNFe
˚˚- :
>
˚˚: ;
(
˚˚; <
)
˚˚< =
;
˚˚= >
foreach
˝˝ 
(
˝˝ 
var
˝˝ 
evento
˝˝ 
in
˝˝  "
eventos
˝˝# *
)
˝˝* +
{
˛˛ 
var
ˇˇ 
eve
ˇˇ 
=
ˇˇ 
evento
ˇˇ  
;
ˇˇ  !
var
ÄÄ 
	retEvento
ÄÄ 
=
ÄÄ 
(
ÄÄ  !
from
ÄÄ! %
	retevento
ÄÄ& /
in
ÄÄ0 2
retEnvEvento
ÄÄ3 ?
.
ÄÄ? @
	retEvento
ÄÄ@ I
where
ÅÅ! &
	retevento
ÇÇ! *
.
ÇÇ* +
	infEvento
ÇÇ+ 4
.
ÇÇ4 5
chNFe
ÇÇ5 :
==
ÇÇ; =
eve
ÇÇ> A
.
ÇÇA B
	infEvento
ÇÇB K
.
ÇÇK L
chNFe
ÇÇL Q
&&
ÇÇR T
	retevento
ÉÉ! *
.
ÉÉ* +
	infEvento
ÉÉ+ 4
.
ÉÉ4 5
tpEvento
ÉÉ5 =
==
ÉÉ> @
eve
ÉÉA D
.
ÉÉD E
	infEvento
ÉÉE N
.
ÉÉN O
tpEvento
ÉÉO W
select
ÑÑ! '
	retevento
ÑÑ( 1
)
ÑÑ1 2
.
ÑÑ2 3
SingleOrDefault
ÑÑ3 B
(
ÑÑB C
)
ÑÑC D
;
ÑÑD E
var
ÜÜ 

procevento
ÜÜ 
=
ÜÜ  
new
ÜÜ! $
procEventoNFe
ÜÜ% 2
{
ÜÜ3 4
evento
ÜÜ5 ;
=
ÜÜ< =
eve
ÜÜ> A
,
ÜÜA B
versao
ÜÜC I
=
ÜÜJ K
eve
ÜÜL O
.
ÜÜO P
versao
ÜÜP V
,
ÜÜV W
	retEvento
ÜÜX a
=
ÜÜb c
	retEvento
ÜÜd m
}
ÜÜn o
;
ÜÜo p
listprocEventoNFe
áá !
.
áá! "
Add
áá" %
(
áá% &

procevento
áá& 0
)
áá0 1
;
áá1 2
if
àà 
(
àà 
!
àà 
_cFgServico
àà  
.
àà  !
SalvarXmlServicos
àà! 2
)
àà2 3
continue
àà4 <
;
àà< =
var
ââ !
proceventoXmlString
ââ '
=
ââ( )

procevento
ââ* 4
.
ââ4 5
ObterXmlString
ââ5 C
(
ââC D
)
ââD E
;
ââE F
}
ãã 
return
èè 
new
èè #
RetornoRecepcaoEvento
èè ,
(
èè, -
	pedEvento
èè- 6
.
èè6 7
ObterXmlString
èè7 E
(
èèE F
)
èèF G
,
èèG H
retEnvEvento
èèI U
.
èèU V
ObterXmlString
èèV d
(
èèd e
)
èèe f
,
èèf g
retornoXmlString
èèh x
,
èèx y
retEnvEvento
êê 
,
êê 
listprocEventoNFe
êê /
)
êê/ 0
;
êê0 1
}
ìì 	
public
üü #
RetornoRecepcaoEvento
üü $(
RecepcaoEventoCancelamento
üü% ?
(
üü? @
int
üü@ C
idlote
üüD J
,
üüJ K
int
üüL O
sequenciaEvento
üüP _
,
üü_ `
string
†† "
protocoloAutorizacao
†† '
,
††' (
string
††) /
chaveNFe
††0 8
,
††8 9
string
††: @
justificativa
††A N
,
††N O
string
††P V
cpfcnpj
††W ^
)
††^ _
{
°° 	
var
¢¢ 
versaoServico
¢¢ 
=
¢¢ 

ServicoNFe
££ 
.
££ '
RecepcaoEventoCancelmento
££ 4
.
££4 5%
VersaoServicoParaString
££5 L
(
££L M
_cFgServico
§§ 
.
§§  1
#VersaoRecepcaoEventoCceCancelamento
§§  C
)
§§C D
;
§§D E
var
•• 
	detEvento
•• 
=
•• 
new
•• 
	detEvento
••  )
{
••* +
nProt
••, 1
=
••2 3"
protocoloAutorizacao
••4 H
,
••H I
versao
••J P
=
••Q R
versaoServico
••S `
,
••` a
xJust
••b g
=
••h i
justificativa
••j w
}
••x y
;
••y z
var
¶¶ 
	infEvento
¶¶ 
=
¶¶ 
new
¶¶ 
infEventoEnv
¶¶  ,
{
ßß 
cOrgao
®® 
=
®® 
_cFgServico
®® $
.
®®$ %
cUF
®®% (
,
®®( )
tpAmb
©© 
=
©© 
_cFgServico
©© #
.
©©# $
tpAmb
©©$ )
,
©©) *
chNFe
™™ 
=
™™ 
chaveNFe
™™  
,
™™  !
dhEvento
´´ 
=
´´ 
DateTime
´´ #
.
´´# $
Now
´´$ '
,
´´' (
tpEvento
¨¨ 
=
¨¨ 
$num
¨¨ !
,
¨¨! "

nSeqEvento
≠≠ 
=
≠≠ 
sequenciaEvento
≠≠ ,
,
≠≠, -
	verEvento
ÆÆ 
=
ÆÆ 
versaoServico
ÆÆ )
,
ÆÆ) *
	detEvento
ØØ 
=
ØØ 
	detEvento
ØØ %
}
∞∞ 
;
∞∞ 
if
±± 
(
±± 
cpfcnpj
±± 
.
±± 
Length
±± 
==
±± !
$num
±±" $
)
±±$ %
	infEvento
≤≤ 
.
≤≤ 
CPF
≤≤ 
=
≤≤ 
cpfcnpj
≤≤  '
;
≤≤' (
else
≥≥ 
	infEvento
¥¥ 
.
¥¥ 
CNPJ
¥¥ 
=
¥¥  
cpfcnpj
¥¥! (
;
¥¥( )
var
∂∂ 
evento
∂∂ 
=
∂∂ 
new
∂∂ 
evento
∂∂ #
{
∂∂$ %
versao
∂∂& ,
=
∂∂- .
versaoServico
∂∂/ <
,
∂∂< =
	infEvento
∂∂> G
=
∂∂H I
	infEvento
∂∂J S
}
∂∂T U
;
∂∂U V
var
∏∏ 
retorno
∏∏ 
=
∏∏ 
RecepcaoEvento
∏∏ (
(
∏∏( )
idlote
∏∏) /
,
∏∏/ 0
new
∏∏1 4
List
∏∏5 9
<
∏∏9 :
evento
∏∏: @
>
∏∏@ A
{
∏∏B C
evento
∏∏D J
}
∏∏K L
,
∏∏L M

ServicoNFe
∏∏N X
.
∏∏X Y'
RecepcaoEventoCancelmento
∏∏Y r
)
∏∏r s
;
∏∏s t
return
ππ 
retorno
ππ 
;
ππ 
}
∫∫ 	
public
≈≈ #
RetornoRecepcaoEvento
≈≈ $)
RecepcaoEventoCartaCorrecao
≈≈% @
(
≈≈@ A
int
≈≈A D
idlote
≈≈E K
,
≈≈K L
int
≈≈M P
sequenciaEvento
≈≈Q `
,
≈≈` a
string
≈≈b h
chaveNFe
≈≈i q
,
≈≈q r
string
∆∆ 
correcao
∆∆ 
,
∆∆ 
string
∆∆ #
cpfcnpj
∆∆$ +
)
∆∆+ ,
{
«« 	
var
»» 
versaoServico
»» 
=
»» 

ServicoNFe
…… 
.
…… )
RecepcaoEventoCartaCorrecao
…… 6
.
……6 7%
VersaoServicoParaString
……7 N
(
……N O
_cFgServico
   
.
    1
#VersaoRecepcaoEventoCceCancelamento
    C
)
  C D
;
  D E
var
ÀÀ 
	detEvento
ÀÀ 
=
ÀÀ 
new
ÀÀ 
	detEvento
ÀÀ  )
{
ÀÀ* +
versao
ÀÀ, 2
=
ÀÀ3 4
versaoServico
ÀÀ5 B
,
ÀÀB C
	xCorrecao
ÀÀD M
=
ÀÀN O
correcao
ÀÀP X
,
ÀÀX Y
xJust
ÀÀZ _
=
ÀÀ` a
null
ÀÀb f
}
ÀÀg h
;
ÀÀh i
var
ÃÃ 
	infEvento
ÃÃ 
=
ÃÃ 
new
ÃÃ 
infEventoEnv
ÃÃ  ,
{
ÕÕ 
cOrgao
ŒŒ 
=
ŒŒ 
_cFgServico
ŒŒ $
.
ŒŒ$ %
cUF
ŒŒ% (
,
ŒŒ( )
tpAmb
œœ 
=
œœ 
_cFgServico
œœ #
.
œœ# $
tpAmb
œœ$ )
,
œœ) *
chNFe
–– 
=
–– 
chaveNFe
––  
,
––  !
dhEvento
—— 
=
—— 
DateTime
—— #
.
——# $
Now
——$ '
,
——' (
tpEvento
““ 
=
““ 
$num
““ !
,
““! "

nSeqEvento
”” 
=
”” 
sequenciaEvento
”” ,
,
””, -
	verEvento
‘‘ 
=
‘‘ 
versaoServico
‘‘ )
,
‘‘) *
	detEvento
’’ 
=
’’ 
	detEvento
’’ %
}
÷÷ 
;
÷÷ 
if
◊◊ 
(
◊◊ 
cpfcnpj
◊◊ 
.
◊◊ 
Length
◊◊ 
==
◊◊ !
$num
◊◊" $
)
◊◊$ %
	infEvento
ÿÿ 
.
ÿÿ 
CPF
ÿÿ 
=
ÿÿ 
cpfcnpj
ÿÿ  '
;
ÿÿ' (
else
ŸŸ 
	infEvento
⁄⁄ 
.
⁄⁄ 
CNPJ
⁄⁄ 
=
⁄⁄  
cpfcnpj
⁄⁄! (
;
⁄⁄( )
var
‹‹ 
evento
‹‹ 
=
‹‹ 
new
‹‹ 
evento
‹‹ #
{
‹‹$ %
versao
‹‹& ,
=
‹‹- .
versaoServico
‹‹/ <
,
‹‹< =
	infEvento
‹‹> G
=
‹‹H I
	infEvento
‹‹J S
}
‹‹T U
;
‹‹U V
var
ﬁﬁ 
retorno
ﬁﬁ 
=
ﬁﬁ 
RecepcaoEvento
ﬁﬁ (
(
ﬁﬁ( )
idlote
ﬁﬁ) /
,
ﬁﬁ/ 0
new
ﬁﬁ1 4
List
ﬁﬁ5 9
<
ﬁﬁ9 :
evento
ﬁﬁ: @
>
ﬁﬁ@ A
{
ﬁﬁB C
evento
ﬁﬁD J
}
ﬁﬁK L
,
ﬁﬁL M

ServicoNFe
ﬁﬁN X
.
ﬁﬁX Y)
RecepcaoEventoCartaCorrecao
ﬁﬁY t
)
ﬁﬁt u
;
ﬁﬁu v
return
ﬂﬂ 
retorno
ﬂﬂ 
;
ﬂﬂ 
}
‡‡ 	
public
‚‚ #
RetornoRecepcaoEvento
‚‚ $4
&RecepcaoEventoManifestacaoDestinatario
‚‚% K
(
‚‚K L
int
‚‚L O
idlote
‚‚P V
,
‚‚V W
int
‚‚X [
sequenciaEvento
‚‚\ k
,
‚‚k l
string
„„ 
chaveNFe
„„ 
,
„„ 0
"TipoEventoManifestacaoDestinatario
„„ ?0
"tipoEventoManifestacaoDestinatario
„„@ b
,
„„b c
string
„„d j
cpfcnpj
„„k r
,
„„r s
string
‰‰ 
justificativa
‰‰  
=
‰‰! "
null
‰‰# '
)
‰‰' (
{
ÂÂ 	
var
ÊÊ 
versaoServico
ÊÊ 
=
ÊÊ 

ServicoNFe
ÁÁ 
.
ÁÁ 4
&RecepcaoEventoManifestacaoDestinatario
ÁÁ A
.
ÁÁA B%
VersaoServicoParaString
ÁÁB Y
(
ÁÁY Z
_cFgServico
ËË 
.
ËË  1
#VersaoRecepcaoEventoCceCancelamento
ËË  C
)
ËËC D
;
ËËD E
var
ÈÈ 
	detEvento
ÈÈ 
=
ÈÈ 
new
ÈÈ 
	detEvento
ÈÈ  )
{
ÍÍ 
versao
ÎÎ 
=
ÎÎ 
versaoServico
ÎÎ &
,
ÎÎ& '

descEvento
ÏÏ 
=
ÏÏ 0
"tipoEventoManifestacaoDestinatario
ÏÏ ?
.
ÏÏ? @
	Descricao
ÏÏ@ I
(
ÏÏI J
)
ÏÏJ K
,
ÏÏK L
xJust
ÌÌ 
=
ÌÌ 
justificativa
ÌÌ %
}
ÓÓ 
;
ÓÓ 
	detEvento
ÔÔ 
.
ÔÔ 

descEvento
ÔÔ  
=
ÔÔ! "0
"tipoEventoManifestacaoDestinatario
ÔÔ# E
.
ÔÔE F
Equals
ÔÔF L
(
ÔÔL M0
"TipoEventoManifestacaoDestinatario
ÔÔM o
.
ÔÔo p(
TeMdConfirmacaoDaOperacaoÔÔp â
)ÔÔâ ä
?
 
$str
 +
:
ÒÒ 0
"tipoEventoManifestacaoDestinatario
ÒÒ 4
.
ÒÒ4 5
Equals
ÒÒ5 ;
(
ÒÒ; <0
"TipoEventoManifestacaoDestinatario
ÒÒ< ^
.
ÒÒ^ _"
TeMdCienciaDaEmissao
ÒÒ_ s
)
ÒÒs t
?
ÚÚ 
$str
ÚÚ '
:
ÛÛ 0
"tipoEventoManifestacaoDestinatario
ÛÛ 4
.
ÛÛ4 5
Equals
ÛÛ5 ;
(
ÛÛ; <0
"TipoEventoManifestacaoDestinatario
ÛÛ< ^
.
ÛÛ^ _+
TeMdDesconhecimentoDaOperacao
ÛÛ_ |
)
ÛÛ| }
?
ÙÙ 
$str
ÙÙ /
:
ıı 0
"tipoEventoManifestacaoDestinatario
ıı 4
.
ıı4 5
Equals
ıı5 ;
(
ıı; <0
"TipoEventoManifestacaoDestinatario
ıı< ^
.
ıı^ _&
TeMdOperacaoNaoRealizada
ıı_ w
)
ııw x
?
ˆˆ 
$str
ˆˆ *
:
˜˜ 
	detEvento
˜˜ 
.
˜˜ 

descEvento
˜˜ &
;
˜˜& '
var
¯¯ 
	infEvento
¯¯ 
=
¯¯ 
new
¯¯ 
infEventoEnv
¯¯  ,
{
˘˘ 
cOrgao
˙˙ 
=
˙˙ 
_cFgServico
˙˙ $
.
˙˙$ %
cUF
˙˙% (
==
˙˙) +
	EstadoNfe
˙˙, 5
.
˙˙5 6
RS
˙˙6 8
?
˙˙9 :
_cFgServico
˙˙; F
.
˙˙F G
cUF
˙˙G J
:
˙˙K L
	EstadoNfe
˙˙M V
.
˙˙V W
AN
˙˙W Y
,
˙˙Y Z
tpAmb
¸¸ 
=
¸¸ 
_cFgServico
¸¸ #
.
¸¸# $
tpAmb
¸¸$ )
,
¸¸) *
chNFe
˝˝ 
=
˝˝ 
chaveNFe
˝˝  
,
˝˝  !
dhEvento
˛˛ 
=
˛˛ 
DateTime
˛˛ #
.
˛˛# $
Now
˛˛$ '
,
˛˛' (
tpEvento
ˇˇ 
=
ˇˇ 
(
ˇˇ 
int
ˇˇ 
)
ˇˇ  0
"tipoEventoManifestacaoDestinatario
ˇˇ  B
,
ˇˇB C

nSeqEvento
ÄÄ 
=
ÄÄ 
sequenciaEvento
ÄÄ ,
,
ÄÄ, -
	verEvento
ÅÅ 
=
ÅÅ 
versaoServico
ÅÅ )
,
ÅÅ) *
	detEvento
ÇÇ 
=
ÇÇ 
	detEvento
ÇÇ %
}
ÉÉ 
;
ÉÉ 
if
ÑÑ 
(
ÑÑ 
cpfcnpj
ÑÑ 
.
ÑÑ 
Length
ÑÑ 
==
ÑÑ !
$num
ÑÑ" $
)
ÑÑ$ %
	infEvento
ÖÖ 
.
ÖÖ 
CPF
ÖÖ 
=
ÖÖ 
cpfcnpj
ÖÖ  '
;
ÖÖ' (
else
ÜÜ 
	infEvento
áá 
.
áá 
CNPJ
áá 
=
áá  
cpfcnpj
áá! (
;
áá( )
var
ââ 
evento
ââ 
=
ââ 
new
ââ 
evento
ââ #
{
ââ$ %
versao
ââ& ,
=
ââ- .
versaoServico
ââ/ <
,
ââ< =
	infEvento
ââ> G
=
ââH I
	infEvento
ââJ S
}
ââT U
;
ââU V
var
ãã 
retorno
ãã 
=
ãã 
RecepcaoEvento
ãã (
(
ãã( )
idlote
ãã) /
,
ãã/ 0
new
ãã1 4
List
ãã5 9
<
ãã9 :
evento
ãã: @
>
ãã@ A
{
ããB C
evento
ããD J
}
ããK L
,
ããL M

ServicoNFe
åå 
.
åå 4
&RecepcaoEventoManifestacaoDestinatario
åå A
)
ååA B
;
ååB C
return
çç 
retorno
çç 
;
çç 
}
éé 	
public
òò #
RetornoRecepcaoEvento
òò $ 
RecepcaoEventoEpec
òò% 7
(
òò7 8
int
òò8 ;
idlote
òò< B
,
òòB C
int
òòD G
sequenciaEvento
òòH W
,
òòW X
Classes
òòY `
.
òò` a
NFe
òòa d
nfe
òòe h
,
òòh i
string
ôô 
veraplic
ôô 
)
ôô 
{
öö 	
var
õõ 
versaoServico
õõ 
=
õõ 

ServicoNFe
úú 
.
úú  
RecepcaoEventoEpec
úú -
.
úú- .%
VersaoServicoParaString
úú. E
(
úúE F
_cFgServico
úúF Q
.
úúQ R1
#VersaoRecepcaoEventoCceCancelamento
úúR u
)
úúu v
;
úúv w
if
ûû 
(
ûû 
string
ûû 
.
ûû 
IsNullOrEmpty
ûû $
(
ûû$ %
nfe
ûû% (
.
ûû( )
infNFe
ûû) /
.
ûû/ 0
Id
ûû0 2
)
ûû2 3
)
ûû3 4
nfe
üü 
.
üü 
Assina
üü 
(
üü 
)
üü 
.
üü 
Valida
üü #
(
üü# $
)
üü$ %
;
üü% &
var
°° 
	detevento
°° 
=
°° 
new
°° 
	detEvento
°°  )
{
¢¢ 
versao
££ 
=
££ 
versaoServico
££ &
,
££& '
cOrgaoAutor
§§ 
=
§§ 
nfe
§§ !
.
§§! "
infNFe
§§" (
.
§§( )
ide
§§) ,
.
§§, -
cUF
§§- 0
,
§§0 1
tpAutor
•• 
=
•• 
	TipoAutor
•• #
.
••# $
taEmpresaEmitente
••$ 5
,
••5 6
verAplic
¶¶ 
=
¶¶ 
veraplic
¶¶ #
,
¶¶# $
dhEmi
ßß 
=
ßß 
nfe
ßß 
.
ßß 
infNFe
ßß "
.
ßß" #
ide
ßß# &
.
ßß& '
dhEmi
ßß' ,
,
ßß, -
tpNF
®® 
=
®® 
nfe
®® 
.
®® 
infNFe
®® !
.
®®! "
ide
®®" %
.
®®% &
tpNF
®®& *
,
®®* +
IE
©© 
=
©© 
nfe
©© 
.
©© 
infNFe
©© 
.
©©  
emit
©©  $
.
©©$ %
IE
©©% '
,
©©' (
dest
™™ 
=
™™ 
new
™™ 
dest
™™ 
{
´´ 
UF
¨¨ 
=
¨¨ 
nfe
¨¨ 
.
¨¨ 
infNFe
¨¨ #
.
¨¨# $
dest
¨¨$ (
.
¨¨( )
	enderDest
¨¨) 2
.
¨¨2 3
UF
¨¨3 5
,
¨¨5 6
CNPJ
≠≠ 
=
≠≠ 
nfe
≠≠ 
.
≠≠ 
infNFe
≠≠ %
.
≠≠% &
dest
≠≠& *
.
≠≠* +
CNPJ
≠≠+ /
,
≠≠/ 0
CPF
ÆÆ 
=
ÆÆ 
nfe
ÆÆ 
.
ÆÆ 
infNFe
ÆÆ $
.
ÆÆ$ %
dest
ÆÆ% )
.
ÆÆ) *
CPF
ÆÆ* -
,
ÆÆ- .
IE
ØØ 
=
ØØ 
nfe
ØØ 
.
ØØ 
infNFe
ØØ #
.
ØØ# $
dest
ØØ$ (
.
ØØ( )
IE
ØØ) +
,
ØØ+ ,
vNF
∞∞ 
=
∞∞ 
nfe
∞∞ 
.
∞∞ 
infNFe
∞∞ $
.
∞∞$ %
total
∞∞% *
.
∞∞* +
ICMSTot
∞∞+ 2
.
∞∞2 3
vNF
∞∞3 6
,
∞∞6 7
vICMS
±± 
=
±± 
nfe
±± 
.
±±  
infNFe
±±  &
.
±±& '
total
±±' ,
.
±±, -
ICMSTot
±±- 4
.
±±4 5
vICMS
±±5 :
,
±±: ;
vST
≤≤ 
=
≤≤ 
nfe
≤≤ 
.
≤≤ 
infNFe
≤≤ $
.
≤≤$ %
total
≤≤% *
.
≤≤* +
ICMSTot
≤≤+ 2
.
≤≤2 3
vST
≤≤3 6
}
≥≥ 
}
¥¥ 
;
¥¥ 
var
∂∂ 
	infEvento
∂∂ 
=
∂∂ 
new
∂∂ 
infEventoEnv
∂∂  ,
{
∑∑ 
cOrgao
∏∏ 
=
∏∏ 
	EstadoNfe
∏∏ "
.
∏∏" #
AN
∏∏# %
,
∏∏% &
tpAmb
ππ 
=
ππ 
nfe
ππ 
.
ππ 
infNFe
ππ "
.
ππ" #
ide
ππ# &
.
ππ& '
tpAmb
ππ' ,
,
ππ, -
CNPJ
∫∫ 
=
∫∫ 
nfe
∫∫ 
.
∫∫ 
infNFe
∫∫ !
.
∫∫! "
emit
∫∫" &
.
∫∫& '
CNPJ
∫∫' +
,
∫∫+ ,
CPF
ªª 
=
ªª 
nfe
ªª 
.
ªª 
infNFe
ªª  
.
ªª  !
emit
ªª! %
.
ªª% &
CPF
ªª& )
,
ªª) *
chNFe
ºº 
=
ºº 
nfe
ºº 
.
ºº 
infNFe
ºº "
.
ºº" #
Id
ºº# %
.
ºº% &
	Substring
ºº& /
(
ºº/ 0
$num
ºº0 1
)
ºº1 2
,
ºº2 3
dhEvento
ΩΩ 
=
ΩΩ 
DateTime
ΩΩ #
.
ΩΩ# $
Now
ΩΩ$ '
,
ΩΩ' (
tpEvento
ææ 
=
ææ 
$num
ææ !
,
ææ! "

nSeqEvento
øø 
=
øø 
sequenciaEvento
øø ,
,
øø, -
	verEvento
¿¿ 
=
¿¿ 
versaoServico
¿¿ )
,
¿¿) *
	detEvento
¡¡ 
=
¡¡ 
	detevento
¡¡ %
}
¬¬ 
;
¬¬ 
var
ƒƒ 
evento
ƒƒ 
=
ƒƒ 
new
ƒƒ 
evento
ƒƒ #
{
ƒƒ$ %
versao
ƒƒ& ,
=
ƒƒ- .
versaoServico
ƒƒ/ <
,
ƒƒ< =
	infEvento
ƒƒ> G
=
ƒƒH I
	infEvento
ƒƒJ S
}
ƒƒT U
;
ƒƒU V
var
∆∆ 
retorno
∆∆ 
=
∆∆ 
RecepcaoEvento
∆∆ (
(
∆∆( )
idlote
∆∆) /
,
∆∆/ 0
new
∆∆1 4
List
∆∆5 9
<
∆∆9 :
evento
∆∆: @
>
∆∆@ A
{
∆∆B C
evento
∆∆D J
}
∆∆K L
,
∆∆L M

ServicoNFe
∆∆N X
.
∆∆X Y 
RecepcaoEventoEpec
∆∆Y k
)
∆∆k l
;
∆∆l m
return
«« 
retorno
«« 
;
«« 
}
»» 	
public
““ (
RetornoNfeConsultaCadastro
““ )!
NfeConsultaCadastro
““* =
(
““= >
string
““> D
uf
““E G
,
““G H+
ConsultaCadastroTipoDocumento
““I f
tipoDocumento
““g t
,
““t u
string
”” 
	documento
”” 
)
”” 
{
‘‘ 	
var
’’ 
versaoServico
’’ 
=
’’ 

ServicoNFe
÷÷ 
.
÷÷ !
NfeConsultaCadastro
÷÷ .
.
÷÷. /%
VersaoServicoParaString
÷÷/ F
(
÷÷F G
_cFgServico
÷÷G R
.
÷÷R S'
VersaoNfeConsultaCadastro
÷÷S l
)
÷÷l m
;
÷÷m n
var
⁄⁄ 
ws
⁄⁄ 
=
⁄⁄ 
CriarServico
⁄⁄ !
(
⁄⁄! "

ServicoNFe
⁄⁄" ,
.
⁄⁄, -!
NfeConsultaCadastro
⁄⁄- @
)
⁄⁄@ A
;
⁄⁄A B
ws
‹‹ 
.
‹‹ 
nfeCabecMsg
‹‹ 
=
‹‹ 
new
‹‹  
nfeCabecMsg
‹‹! ,
{
›› 
cUF
ﬁﬁ 
=
ﬁﬁ 
_cFgServico
ﬁﬁ !
.
ﬁﬁ! "
cUF
ﬁﬁ" %
,
ﬁﬁ% &
versaoDados
ﬂﬂ 
=
ﬂﬂ 
versaoServico
ﬂﬂ +
}
‡‡ 
;
‡‡ 
var
ÊÊ 
pedConsulta
ÊÊ 
=
ÊÊ 
new
ÊÊ !
ConsCad
ÊÊ" )
{
ÁÁ 
versao
ËË 
=
ËË 
versaoServico
ËË &
,
ËË& '
infCons
ÈÈ 
=
ÈÈ 
new
ÈÈ 

infConsEnv
ÈÈ (
{
ÈÈ) *
UF
ÈÈ+ -
=
ÈÈ. /
uf
ÈÈ0 2
}
ÈÈ3 4
}
ÍÍ 
;
ÍÍ 
switch
ÏÏ 
(
ÏÏ 
tipoDocumento
ÏÏ !
)
ÏÏ! "
{
ÌÌ 
case
ÓÓ +
ConsultaCadastroTipoDocumento
ÓÓ 2
.
ÓÓ2 3
Ie
ÓÓ3 5
:
ÓÓ5 6
pedConsulta
ÔÔ 
.
ÔÔ  
infCons
ÔÔ  '
.
ÔÔ' (
IE
ÔÔ( *
=
ÔÔ+ ,
	documento
ÔÔ- 6
;
ÔÔ6 7
break
 
;
 
case
ÒÒ +
ConsultaCadastroTipoDocumento
ÒÒ 2
.
ÒÒ2 3
Cnpj
ÒÒ3 7
:
ÒÒ7 8
pedConsulta
ÚÚ 
.
ÚÚ  
infCons
ÚÚ  '
.
ÚÚ' (
CNPJ
ÚÚ( ,
=
ÚÚ- .
	documento
ÚÚ/ 8
;
ÚÚ8 9
break
ÛÛ 
;
ÛÛ 
case
ÙÙ +
ConsultaCadastroTipoDocumento
ÙÙ 2
.
ÙÙ2 3
Cpf
ÙÙ3 6
:
ÙÙ6 7
pedConsulta
ıı 
.
ıı  
infCons
ıı  '
.
ıı' (
CPF
ıı( +
=
ıı, -
	documento
ıı. 7
;
ıı7 8
break
ˆˆ 
;
ˆˆ 
default
˜˜ 
:
˜˜ 
throw
¯¯ 
new
¯¯ )
ArgumentOutOfRangeException
¯¯ 9
(
¯¯9 :
$str
¯¯: I
,
¯¯I J
tipoDocumento
¯¯K X
,
¯¯X Y
null
¯¯Z ^
)
¯¯^ _
;
¯¯_ `
}
˘˘ 
var
ˇˇ 
xmlConsulta
ˇˇ 
=
ˇˇ 
pedConsulta
ˇˇ )
.
ˇˇ) *
ObterXmlString
ˇˇ* 8
(
ˇˇ8 9
)
ˇˇ9 :
;
ˇˇ: ;
	Validador
ÄÄ 
.
ÄÄ 
Valida
ÄÄ 
(
ÄÄ 

ServicoNFe
ÄÄ '
.
ÄÄ' (!
NfeConsultaCadastro
ÄÄ( ;
,
ÄÄ; <
_cFgServico
ÄÄ= H
.
ÄÄH I'
VersaoNfeConsultaCadastro
ÄÄI b
,
ÄÄb c
xmlConsulta
ÄÄd o
)
ÄÄo p
;
ÄÄp q
var
ÅÅ 
dadosConsulta
ÅÅ 
=
ÅÅ 
new
ÅÅ  #
XmlDocument
ÅÅ$ /
(
ÅÅ/ 0
)
ÅÅ0 1
;
ÅÅ1 2
dadosConsulta
ÇÇ 
.
ÇÇ 
LoadXml
ÇÇ !
(
ÇÇ! "
xmlConsulta
ÇÇ" -
)
ÇÇ- .
;
ÇÇ. /
XmlNode
ÜÜ 
retorno
ÜÜ 
;
ÜÜ 
try
áá 
{
àà 
retorno
ââ 
=
ââ 
ws
ââ 
.
ââ 
Execute
ââ $
(
ââ$ %
dadosConsulta
ââ% 2
)
ââ2 3
;
ââ3 4
}
ää 
catch
ãã 
(
ãã 
WebException
ãã 
ex
ãã  "
)
ãã" #
{
åå 
throw
çç )
FabricaComunicacaoException
çç 1
.
çç1 2
ObterException
çç2 @
(
çç@ A

ServicoNFe
ççA K
.
ççK L!
NfeConsultaCadastro
ççL _
,
çç_ `
ex
çça c
)
ççc d
;
ççd e
}
éé 
var
êê 
retornoXmlString
êê  
=
êê! "
retorno
êê# *
.
êê* +
OuterXml
êê+ 3
;
êê3 4
var
ëë 
retConsulta
ëë 
=
ëë 
new
ëë !

retConsCad
ëë" ,
(
ëë, -
)
ëë- .
.
ëë. /!
CarregarDeXmlString
ëë/ B
(
ëëB C
retornoXmlString
ëëC S
)
ëëS T
;
ëëT U
return
ïï 
new
ïï (
RetornoNfeConsultaCadastro
ïï 1
(
ïï1 2
pedConsulta
ïï2 =
.
ïï= >
ObterXmlString
ïï> L
(
ïïL M
)
ïïM N
,
ïïN O
retConsulta
ïïP [
.
ïï[ \
ObterXmlString
ïï\ j
(
ïïj k
)
ïïk l
,
ïïl m
retornoXmlString
ññ  
,
ññ  !
retConsulta
ññ" -
)
ññ- .
;
ññ. /
}
ôô 	
public
££ "
RetornoNfeDistDFeInt
££ #!
NfeDistDFeInteresse
££$ 7
(
££7 8
string
££8 >
ufAutor
££? F
,
££F G
string
££H N
	documento
££O X
,
££X Y
string
££Z `
ultNSU
££a g
,
££g h
string
§§ 
nSU
§§ 
=
§§ 
$str
§§ 
)
§§ 
{
•• 	
var
¶¶ 
versaoServico
¶¶ 
=
¶¶ 

ServicoNFe
ßß 
.
ßß  
NFeDistribuicaoDFe
ßß -
.
ßß- .%
VersaoServicoParaString
ßß. E
(
ßßE F
_cFgServico
ßßF Q
.
ßßQ R&
VersaoNFeDistribuicaoDFe
ßßR j
)
ßßj k
;
ßßk l
var
´´ 
ws
´´ 
=
´´ 
CriarServico
´´ !
(
´´! "

ServicoNFe
´´" ,
.
´´, - 
NFeDistribuicaoDFe
´´- ?
)
´´? @
;
´´@ A
ws
≠≠ 
.
≠≠ 
nfeCabecMsg
≠≠ 
=
≠≠ 
new
≠≠  
nfeCabecMsg
≠≠! ,
{
ÆÆ 
cUF
ØØ 
=
ØØ 
_cFgServico
ØØ !
.
ØØ! "
cUF
ØØ" %
,
ØØ% &
versaoDados
∞∞ 
=
∞∞ 
versaoServico
∞∞ +
}
±± 
;
±± 
var
∑∑ 
pedDistDFeInt
∑∑ 
=
∑∑ 
new
∑∑  #

distDFeInt
∑∑$ .
{
∏∏ 
versao
ππ 
=
ππ 
versaoServico
ππ &
,
ππ& '
tpAmb
∫∫ 
=
∫∫ 
_cFgServico
∫∫ #
.
∫∫# $
tpAmb
∫∫$ )
,
∫∫) *
cUFAutor
ªª 
=
ªª 
_cFgServico
ªª &
.
ªª& '
cUF
ªª' *
,
ªª* +
distNSU
ºº 
=
ºº 
new
ºº 
distNSU
ºº %
{
ºº& '
ultNSU
ºº( .
=
ºº/ 0
ultNSU
ºº1 7
.
ºº7 8
PadLeft
ºº8 ?
(
ºº? @
$num
ºº@ B
,
ººB C
$char
ººD G
)
ººG H
}
ººI J
}
ææ 
;
ææ 
if
¿¿ 
(
¿¿ 
	documento
¿¿ 
.
¿¿ 
Length
¿¿  
==
¿¿! #
$num
¿¿$ &
)
¿¿& '
pedDistDFeInt
¡¡ 
.
¡¡ 
CPF
¡¡ !
=
¡¡" #
	documento
¡¡$ -
;
¡¡- .
if
¬¬ 
(
¬¬ 
	documento
¬¬ 
.
¬¬ 
Length
¬¬  
>
¬¬! "
$num
¬¬# %
)
¬¬% &
pedDistDFeInt
√√ 
.
√√ 
CNPJ
√√ "
=
√√# $
	documento
√√% .
;
√√. /
if
ƒƒ 
(
ƒƒ 
!
ƒƒ 
nSU
ƒƒ 
.
ƒƒ 
Equals
ƒƒ 
(
ƒƒ 
$str
ƒƒ 
)
ƒƒ  
)
ƒƒ  !
pedDistDFeInt
≈≈ 
.
≈≈ 
consNSU
≈≈ %
=
≈≈& '
new
≈≈( +
consNSU
≈≈, 3
{
≈≈4 5
NSU
≈≈6 9
=
≈≈: ;
nSU
≈≈< ?
.
≈≈? @
PadLeft
≈≈@ G
(
≈≈G H
$num
≈≈H J
,
≈≈J K
$char
≈≈L O
)
≈≈O P
}
≈≈Q R
;
≈≈R S
var
ÀÀ 
xmlConsulta
ÀÀ 
=
ÀÀ 
pedDistDFeInt
ÀÀ +
.
ÀÀ+ ,
ObterXmlString
ÀÀ, :
(
ÀÀ: ;
)
ÀÀ; <
;
ÀÀ< =
	Validador
ÃÃ 
.
ÃÃ 
Valida
ÃÃ 
(
ÃÃ 

ServicoNFe
ÃÃ '
.
ÃÃ' ( 
NFeDistribuicaoDFe
ÃÃ( :
,
ÃÃ: ;
_cFgServico
ÃÃ< G
.
ÃÃG H&
VersaoNFeDistribuicaoDFe
ÃÃH `
,
ÃÃ` a
xmlConsulta
ÃÃb m
)
ÃÃm n
;
ÃÃn o
var
ÕÕ 
dadosConsulta
ÕÕ 
=
ÕÕ 
new
ÕÕ  #
XmlDocument
ÕÕ$ /
(
ÕÕ/ 0
)
ÕÕ0 1
;
ÕÕ1 2
dadosConsulta
ŒŒ 
.
ŒŒ 
LoadXml
ŒŒ !
(
ŒŒ! "
xmlConsulta
ŒŒ" -
)
ŒŒ- .
;
ŒŒ. /
XmlNode
““ 
retorno
““ 
;
““ 
try
”” 
{
‘‘ 
retorno
’’ 
=
’’ 
ws
’’ 
.
’’ 
Execute
’’ $
(
’’$ %
dadosConsulta
’’% 2
)
’’2 3
;
’’3 4
}
÷÷ 
catch
◊◊ 
(
◊◊ 
WebException
◊◊ 
ex
◊◊  "
)
◊◊" #
{
ÿÿ 
throw
ŸŸ )
FabricaComunicacaoException
ŸŸ 1
.
ŸŸ1 2
ObterException
ŸŸ2 @
(
ŸŸ@ A

ServicoNFe
ŸŸA K
.
ŸŸK L 
NFeDistribuicaoDFe
ŸŸL ^
,
ŸŸ^ _
ex
ŸŸ` b
)
ŸŸb c
;
ŸŸc d
}
⁄⁄ 
var
‹‹ 
retornoXmlString
‹‹  
=
‹‹! "
retorno
‹‹# *
.
‹‹* +
OuterXml
‹‹+ 3
;
‹‹3 4
var
›› 
retConsulta
›› 
=
›› 
new
›› !
retDistDFeInt
››" /
(
››/ 0
)
››0 1
.
››1 2!
CarregarDeXmlString
››2 E
(
››E F
retornoXmlString
››F V
)
››V W
;
››W X
if
„„ 
(
„„ 
retConsulta
„„ 
.
„„ 
loteDistDFeInt
„„ *
!=
„„+ -
null
„„. 2
)
„„2 3
{
‰‰ 
for
ÂÂ 
(
ÂÂ 
int
ÂÂ 
i
ÂÂ 
=
ÂÂ 
$num
ÂÂ 
;
ÂÂ 
i
ÂÂ  !
<
ÂÂ" #
retConsulta
ÂÂ$ /
.
ÂÂ/ 0
loteDistDFeInt
ÂÂ0 >
.
ÂÂ> ?
Length
ÂÂ? E
;
ÂÂE F
i
ÂÂG H
++
ÂÂH J
)
ÂÂJ K
{
ÊÊ 
string
ËË 
conteudo
ËË #
=
ËË$ %

Compressao
ËË& 0
.
ËË0 1
Unzip
ËË1 6
(
ËË6 7
retConsulta
ËË7 B
.
ËËB C
loteDistDFeInt
ËËC Q
[
ËËQ R
i
ËËR S
]
ËËS T
.
ËËT U
XmlNfe
ËËU [
)
ËË[ \
;
ËË\ ]
string
ÈÈ 
chNFe
ÈÈ  
=
ÈÈ! "
string
ÈÈ# )
.
ÈÈ) *
Empty
ÈÈ* /
;
ÈÈ/ 0
if
ÎÎ 
(
ÎÎ 
conteudo
ÎÎ  
.
ÎÎ  !

StartsWith
ÎÎ! +
(
ÎÎ+ ,
$str
ÎÎ, 5
)
ÎÎ5 6
)
ÎÎ6 7
{
ÏÏ 
var
ÌÌ 
retConteudo
ÌÌ '
=
ÌÌ( )

FuncoesXml
ÓÓ &
.
ÓÓ& '!
XmlStringParaClasse
ÓÓ' :
<
ÓÓ: ;
Classes
ÓÓ; B
.
ÓÓB C
Servicos
ÓÓC K
.
ÓÓK L
DistribuicaoDFe
ÓÓL [
.
ÓÓ[ \
Schemas
ÓÓ\ c
.
ÓÓc d
resNFe
ÓÓd j
>
ÓÓj k
(
ÓÓk l
conteudo
ÓÓl t
)
ÓÓt u
;
ÓÓu v
chNFe
ÔÔ 
=
ÔÔ 
retConteudo
ÔÔ  +
.
ÔÔ+ ,
chNFe
ÔÔ, 1
;
ÔÔ1 2
}
 
else
ÒÒ 
if
ÒÒ 
(
ÒÒ 
conteudo
ÒÒ %
.
ÒÒ% &

StartsWith
ÒÒ& 0
(
ÒÒ0 1
$str
ÒÒ1 A
)
ÒÒA B
)
ÒÒB C
{
ÚÚ 
var
ÛÛ #
procEventoNFeConteudo
ÛÛ 1
=
ÛÛ2 3

FuncoesXml
ÙÙ &
.
ÙÙ& '!
XmlStringParaClasse
ÙÙ' :
<
ÙÙ: ;
Classes
ÙÙ; B
.
ÙÙB C
Servicos
ÙÙC K
.
ÙÙK L
DistribuicaoDFe
ÙÙL [
.
ÙÙ[ \
Schemas
ÙÙ\ c
.
ÙÙc d
procEventoNFe
ÙÙd q
>
ÙÙq r
(
ÙÙr s
conteudo
ıı  (
)
ıı( )
;
ıı) *
chNFe
ˆˆ 
=
ˆˆ #
procEventoNFeConteudo
ˆˆ  5
.
ˆˆ5 6
	retEvento
ˆˆ6 ?
.
ˆˆ? @
	infEvento
ˆˆ@ I
.
ˆˆI J
chNFe
ˆˆJ O
;
ˆˆO P
}
˜˜ 
string
˘˘ 
[
˘˘ 
]
˘˘ 
schema
˘˘ #
=
˘˘$ %
retConsulta
˘˘& 1
.
˘˘1 2
loteDistDFeInt
˘˘2 @
[
˘˘@ A
i
˘˘A B
]
˘˘B C
.
˘˘C D
schema
˘˘D J
.
˘˘J K
Split
˘˘K P
(
˘˘P Q
$char
˘˘Q T
)
˘˘T U
;
˘˘U V
}
¸¸ 
}
˝˝ 
return
ÅÅ 
new
ÅÅ "
RetornoNfeDistDFeInt
ÅÅ +
(
ÅÅ+ ,
pedDistDFeInt
ÅÅ, 9
.
ÅÅ9 :
ObterXmlString
ÅÅ: H
(
ÅÅH I
)
ÅÅI J
,
ÅÅJ K
retConsulta
ÅÅL W
.
ÅÅW X
ObterXmlString
ÅÅX f
(
ÅÅf g
)
ÅÅg h
,
ÅÅh i
retornoXmlString
ÇÇ  
,
ÇÇ  !
retConsulta
ÇÇ" -
)
ÇÇ- .
;
ÇÇ. /
}
ÖÖ 	
public
áá "
RetornoNfeDistDFeInt
áá #)
NfeDistDFeInteresseComChave
áá$ ?
(
áá? @
string
áá@ F
ufAutor
ááG N
,
ááN O
string
ááP V
	documento
ááW `
,
áá` a
string
ááb h
chNFe
áái n
)
áán o
{
àà 	
var
ââ 
versaoServico
ââ 
=
ââ 
$str
ââ  &
;
ââ& '
var
çç 
ws
çç 
=
çç 
CriarServico
çç !
(
çç! "

ServicoNFe
çç" ,
.
çç, - 
NFeDistribuicaoDFe
çç- ?
)
çç? @
;
çç@ A
ws
èè 
.
èè 
nfeCabecMsg
èè 
=
èè 
new
èè  
nfeCabecMsg
èè! ,
{
êê 
cUF
ëë 
=
ëë 
_cFgServico
ëë !
.
ëë! "
cUF
ëë" %
,
ëë% &
versaoDados
íí 
=
íí 
versaoServico
íí +
}
ìì 
;
ìì 
var
ôô 
pedDistDFeInt
ôô 
=
ôô 
new
ôô  #
distDFeInt2
ôô$ /
{
öö 
versao
õõ 
=
õõ 
versaoServico
õõ &
,
õõ& '
tpAmb
úú 
=
úú 
_cFgServico
úú #
.
úú# $
tpAmb
úú$ )
,
úú) *
cUFAutor
ùù 
=
ùù 
_cFgServico
ùù &
.
ùù& '
cUF
ùù' *
,
ùù* +
	consChNFe
ûû 
=
ûû 
new
ûû 
	consChNFe
ûû  )
{
ûû* +
chNFe
ûû, 1
=
ûû2 3
chNFe
ûû4 9
}
ûû: ;
}
†† 
;
†† 
if
¢¢ 
(
¢¢ 
	documento
¢¢ 
.
¢¢ 
Length
¢¢  
==
¢¢! #
$num
¢¢$ &
)
¢¢& '
pedDistDFeInt
££ 
.
££ 
CPF
££ !
=
££" #
	documento
££$ -
;
££- .
if
§§ 
(
§§ 
	documento
§§ 
.
§§ 
Length
§§  
>
§§! "
$num
§§# %
)
§§% &
pedDistDFeInt
•• 
.
•• 
CNPJ
•• "
=
••# $
	documento
••% .
;
••. /
var
´´ 
xmlConsulta
´´ 
=
´´ 
pedDistDFeInt
´´ +
.
´´+ ,
ObterXmlString
´´, :
(
´´: ;
)
´´; <
;
´´< =
var
≠≠ 
dadosConsulta
≠≠ 
=
≠≠ 
new
≠≠  #
XmlDocument
≠≠$ /
(
≠≠/ 0
)
≠≠0 1
;
≠≠1 2
dadosConsulta
ÆÆ 
.
ÆÆ 
LoadXml
ÆÆ !
(
ÆÆ! "
xmlConsulta
ÆÆ" -
)
ÆÆ- .
;
ÆÆ. /
XmlNode
≤≤ 
retorno
≤≤ 
;
≤≤ 
try
≥≥ 
{
¥¥ 
retorno
µµ 
=
µµ 
ws
µµ 
.
µµ 
Execute
µµ $
(
µµ$ %
dadosConsulta
µµ% 2
)
µµ2 3
;
µµ3 4
}
∂∂ 
catch
∑∑ 
(
∑∑ 
WebException
∑∑ 
ex
∑∑  "
)
∑∑" #
{
∏∏ 
throw
ππ )
FabricaComunicacaoException
ππ 1
.
ππ1 2
ObterException
ππ2 @
(
ππ@ A

ServicoNFe
ππA K
.
ππK L 
NFeDistribuicaoDFe
ππL ^
,
ππ^ _
ex
ππ` b
)
ππb c
;
ππc d
}
∫∫ 
var
ºº 
retornoXmlString
ºº  
=
ºº! "
retorno
ºº# *
.
ºº* +
OuterXml
ºº+ 3
;
ºº3 4
var
ææ 
retConsulta
ææ 
=
ææ 
new
ææ !
retDistDFeInt
ææ" /
(
ææ/ 0
)
ææ0 1
.
ææ1 2!
CarregarDeXmlString
ææ2 E
(
ææE F
retornoXmlString
ææF V
)
ææV W
;
ææW X
if
ƒƒ 
(
ƒƒ 
retConsulta
ƒƒ 
.
ƒƒ 
loteDistDFeInt
ƒƒ *
!=
ƒƒ+ -
null
ƒƒ. 2
)
ƒƒ2 3
{
≈≈ 
for
∆∆ 
(
∆∆ 
int
∆∆ 
i
∆∆ 
=
∆∆ 
$num
∆∆ 
;
∆∆ 
i
∆∆  !
<
∆∆" #
retConsulta
∆∆$ /
.
∆∆/ 0
loteDistDFeInt
∆∆0 >
.
∆∆> ?
Length
∆∆? E
;
∆∆E F
i
∆∆G H
++
∆∆H J
)
∆∆J K
{
«« 
string
…… 
conteudo
…… #
=
……$ %

Compressao
……& 0
.
……0 1
Unzip
……1 6
(
……6 7
retConsulta
……7 B
.
……B C
loteDistDFeInt
……C Q
[
……Q R
i
……R S
]
……S T
.
……T U
XmlNfe
……U [
)
……[ \
;
……\ ]
chNFe
   
=
   
string
   "
.
  " #
Empty
  # (
;
  ( )
if
ÃÃ 
(
ÃÃ 
conteudo
ÃÃ  
.
ÃÃ  !

StartsWith
ÃÃ! +
(
ÃÃ+ ,
$str
ÃÃ, 5
)
ÃÃ5 6
)
ÃÃ6 7
{
ÕÕ 
var
ŒŒ 
retConteudo
ŒŒ '
=
ŒŒ( )

FuncoesXml
œœ &
.
œœ& '!
XmlStringParaClasse
œœ' :
<
œœ: ;
Classes
œœ; B
.
œœB C
Servicos
œœC K
.
œœK L
DistribuicaoDFe
œœL [
.
œœ[ \
Schemas
œœ\ c
.
œœc d
resNFe
œœd j
>
œœj k
(
œœk l
conteudo
œœl t
)
œœt u
;
œœu v
chNFe
–– 
=
–– 
retConteudo
––  +
.
––+ ,
chNFe
––, 1
;
––1 2
}
—— 
else
““ 
if
““ 
(
““ 
conteudo
““ %
.
““% &

StartsWith
““& 0
(
““0 1
$str
““1 A
)
““A B
)
““B C
{
”” 
var
‘‘ #
procEventoNFeConteudo
‘‘ 1
=
‘‘2 3

FuncoesXml
’’ &
.
’’& '!
XmlStringParaClasse
’’' :
<
’’: ;
Classes
’’; B
.
’’B C
Servicos
’’C K
.
’’K L
DistribuicaoDFe
’’L [
.
’’[ \
Schemas
’’\ c
.
’’c d
procEventoNFe
’’d q
>
’’q r
(
’’r s
conteudo
÷÷  (
)
÷÷( )
;
÷÷) *
chNFe
◊◊ 
=
◊◊ #
procEventoNFeConteudo
◊◊  5
.
◊◊5 6
	retEvento
◊◊6 ?
.
◊◊? @
	infEvento
◊◊@ I
.
◊◊I J
chNFe
◊◊J O
;
◊◊O P
}
ÿÿ 
string
‹‹ 
[
‹‹ 
]
‹‹ 
schema
‹‹ #
=
‹‹$ %
retConsulta
‹‹& 1
.
‹‹1 2
loteDistDFeInt
‹‹2 @
[
‹‹@ A
i
‹‹A B
]
‹‹B C
.
‹‹C D
schema
‹‹D J
.
‹‹J K
Split
‹‹K P
(
‹‹P Q
$char
‹‹Q T
)
‹‹T U
;
‹‹U V
}
ﬂﬂ 
}
‡‡ 
return
‰‰ 
new
‰‰ "
RetornoNfeDistDFeInt
‰‰ +
(
‰‰+ ,
pedDistDFeInt
‰‰, 9
.
‰‰9 :
ObterXmlString
‰‰: H
(
‰‰H I
)
‰‰I J
,
‰‰J K
retConsulta
‰‰L W
.
‰‰W X
ObterXmlString
‰‰X f
(
‰‰f g
)
‰‰g h
,
‰‰h i
retornoXmlString
ÂÂ  
,
ÂÂ  !
retConsulta
ÂÂ" -
)
ÂÂ- .
;
ÂÂ. /
}
ËË 	
public
ÚÚ  
RetornoNfeRecepcao
ÚÚ !
NfeRecepcao
ÚÚ" -
(
ÚÚ- .
int
ÚÚ. 1
idLote
ÚÚ2 8
,
ÚÚ8 9
List
ÚÚ: >
<
ÚÚ> ?
Classes
ÚÚ? F
.
ÚÚF G
NFe
ÚÚG J
>
ÚÚJ K
nFes
ÚÚL P
)
ÚÚP Q
{
ÛÛ 	
var
ÙÙ 
versaoServico
ÙÙ 
=
ÙÙ 

ServicoNFe
ÙÙ  *
.
ÙÙ* +
NfeRecepcao
ÙÙ+ 6
.
ÙÙ6 7%
VersaoServicoParaString
ÙÙ7 N
(
ÙÙN O
_cFgServico
ÙÙO Z
.
ÙÙZ [
VersaoNfeRecepcao
ÙÙ[ l
)
ÙÙl m
;
ÙÙm n
var
¯¯ 
ws
¯¯ 
=
¯¯ 
CriarServico
¯¯ !
(
¯¯! "

ServicoNFe
¯¯" ,
.
¯¯, -
NfeRecepcao
¯¯- 8
)
¯¯8 9
;
¯¯9 :
ws
˙˙ 
.
˙˙ 
nfeCabecMsg
˙˙ 
=
˙˙ 
new
˙˙  
nfeCabecMsg
˙˙! ,
{
˚˚ 
cUF
¸¸ 
=
¸¸ 
_cFgServico
¸¸ !
.
¸¸! "
cUF
¸¸" %
,
¸¸% &
versaoDados
˝˝ 
=
˝˝ 
versaoServico
˝˝ +
}
˛˛ 
;
˛˛ 
var
ÑÑ 
pedEnvio
ÑÑ 
=
ÑÑ 
new
ÑÑ 
enviNFe2
ÑÑ '
(
ÑÑ' (
versaoServico
ÑÑ( 5
,
ÑÑ5 6
idLote
ÑÑ7 =
,
ÑÑ= >
nFes
ÑÑ? C
)
ÑÑC D
;
ÑÑD E
var
ää 
xmlEnvio
ää 
=
ää 
pedEnvio
ää #
.
ää# $
ObterXmlString
ää$ 2
(
ää2 3
)
ää3 4
;
ää4 5
if
åå 
(
åå 
_cFgServico
åå 
.
åå 
cUF
åå 
==
åå  "
	EstadoNfe
åå# ,
.
åå, -
PR
åå- /
)
åå/ 0
xmlEnvio
éé 
=
éé 
xmlEnvio
éé #
.
éé# $
Replace
éé$ +
(
éé+ ,
$str
éé, 3
,
éé3 4
$str
éé5 i
)
ééi j
;
ééj k
	Validador
êê 
.
êê 
Valida
êê 
(
êê 

ServicoNFe
êê '
.
êê' (
NfeRecepcao
êê( 3
,
êê3 4
_cFgServico
êê5 @
.
êê@ A
VersaoNfeRecepcao
êêA R
,
êêR S
xmlEnvio
êêT \
)
êê\ ]
;
êê] ^
var
ëë 

dadosEnvio
ëë 
=
ëë 
new
ëë  
XmlDocument
ëë! ,
(
ëë, -
)
ëë- .
;
ëë. /

dadosEnvio
íí 
.
íí 
LoadXml
íí 
(
íí 
xmlEnvio
íí '
)
íí' (
;
íí( )
XmlNode
ññ 
retorno
ññ 
;
ññ 
try
óó 
{
òò 
retorno
ôô 
=
ôô 
ws
ôô 
.
ôô 
Execute
ôô $
(
ôô$ %

dadosEnvio
ôô% /
)
ôô/ 0
;
ôô0 1
}
öö 
catch
õõ 
(
õõ 
WebException
õõ 
ex
õõ  "
)
õõ" #
{
úú 
throw
ùù )
FabricaComunicacaoException
ùù 1
.
ùù1 2
ObterException
ùù2 @
(
ùù@ A

ServicoNFe
ùùA K
.
ùùK L
NfeRecepcao
ùùL W
,
ùùW X
ex
ùùY [
)
ùù[ \
;
ùù\ ]
}
ûû 
var
†† 
retornoXmlString
††  
=
††! "
retorno
††# *
.
††* +
OuterXml
††+ 3
;
††3 4
var
°° 
retEnvio
°° 
=
°° 
new
°° 

retEnviNFe
°° )
(
°°) *
)
°°* +
.
°°+ ,!
CarregarDeXmlString
°°, ?
(
°°? @
retornoXmlString
°°@ P
)
°°P Q
;
°°Q R
return
•• 
new
••  
RetornoNfeRecepcao
•• )
(
••) *
pedEnvio
••* 2
.
••2 3
ObterXmlString
••3 A
(
••A B
)
••B C
,
••C D
retEnvio
••E M
.
••M N
ObterXmlString
••N \
(
••\ ]
)
••] ^
,
••^ _
retornoXmlString
••` p
,
••p q
retEnvio
¶¶ 
)
¶¶ 
;
¶¶ 
}
©© 	
public
∞∞ #
RetornoNfeRetRecepcao
∞∞ $
NfeRetRecepcao
∞∞% 3
(
∞∞3 4
string
∞∞4 :
recibo
∞∞; A
)
∞∞A B
{
±± 	
var
≤≤ 
versaoServico
≤≤ 
=
≤≤ 

ServicoNFe
≤≤  *
.
≤≤* +
NfeRetRecepcao
≤≤+ 9
.
≤≤9 :%
VersaoServicoParaString
≤≤: Q
(
≤≤Q R
_cFgServico
≤≤R ]
.
≤≤] ^"
VersaoNfeRetRecepcao
≤≤^ r
)
≤≤r s
;
≤≤s t
var
∂∂ 
ws
∂∂ 
=
∂∂ 
CriarServico
∂∂ !
(
∂∂! "

ServicoNFe
∂∂" ,
.
∂∂, -
NfeRetRecepcao
∂∂- ;
)
∂∂; <
;
∂∂< =
ws
∏∏ 
.
∏∏ 
nfeCabecMsg
∏∏ 
=
∏∏ 
new
∏∏  
nfeCabecMsg
∏∏! ,
{
ππ 
cUF
∫∫ 
=
∫∫ 
_cFgServico
∫∫ !
.
∫∫! "
cUF
∫∫" %
,
∫∫% &
versaoDados
ªª 
=
ªª 
versaoServico
ªª +
}
ºº 
;
ºº 
var
¬¬ 
	pedRecibo
¬¬ 
=
¬¬ 
new
¬¬ 
consReciNFe
¬¬  +
{
√√ 
versao
ƒƒ 
=
ƒƒ 
versaoServico
ƒƒ &
,
ƒƒ& '
tpAmb
≈≈ 
=
≈≈ 
_cFgServico
≈≈ #
.
≈≈# $
tpAmb
≈≈$ )
,
≈≈) *
nRec
∆∆ 
=
∆∆ 
recibo
∆∆ 
}
«« 
;
«« 
var
ÕÕ 
	xmlRecibo
ÕÕ 
=
ÕÕ 
	pedRecibo
ÕÕ %
.
ÕÕ% &
ObterXmlString
ÕÕ& 4
(
ÕÕ4 5
)
ÕÕ5 6
;
ÕÕ6 7
var
ŒŒ 
dadosRecibo
ŒŒ 
=
ŒŒ 
new
ŒŒ !
XmlDocument
ŒŒ" -
(
ŒŒ- .
)
ŒŒ. /
;
ŒŒ/ 0
dadosRecibo
œœ 
.
œœ 
LoadXml
œœ 
(
œœ  
	xmlRecibo
œœ  )
)
œœ) *
;
œœ* +
XmlNode
”” 
retorno
”” 
;
”” 
try
‘‘ 
{
’’ 
retorno
÷÷ 
=
÷÷ 
ws
÷÷ 
.
÷÷ 
Execute
÷÷ $
(
÷÷$ %
dadosRecibo
÷÷% 0
)
÷÷0 1
;
÷÷1 2
}
◊◊ 
catch
ÿÿ 
(
ÿÿ 
WebException
ÿÿ 
ex
ÿÿ  "
)
ÿÿ" #
{
ŸŸ 
throw
⁄⁄ )
FabricaComunicacaoException
⁄⁄ 1
.
⁄⁄1 2
ObterException
⁄⁄2 @
(
⁄⁄@ A

ServicoNFe
⁄⁄A K
.
⁄⁄K L
NfeRetRecepcao
⁄⁄L Z
,
⁄⁄Z [
ex
⁄⁄\ ^
)
⁄⁄^ _
;
⁄⁄_ `
}
€€ 
var
›› 
retornoXmlString
››  
=
››! "
retorno
››# *
.
››* +
OuterXml
››+ 3
;
››3 4
var
ﬁﬁ 
	retRecibo
ﬁﬁ 
=
ﬁﬁ 
new
ﬁﬁ 
retConsReciNFe
ﬁﬁ  .
(
ﬁﬁ. /
)
ﬁﬁ/ 0
.
ﬁﬁ0 1!
CarregarDeXmlString
ﬁﬁ1 D
(
ﬁﬁD E
retornoXmlString
ﬁﬁE U
)
ﬁﬁU V
;
ﬁﬁV W
return
‚‚ 
new
‚‚ #
RetornoNfeRetRecepcao
‚‚ ,
(
‚‚, -
	pedRecibo
‚‚- 6
.
‚‚6 7
ObterXmlString
‚‚7 E
(
‚‚E F
)
‚‚F G
,
‚‚G H
	retRecibo
‚‚I R
.
‚‚R S
ObterXmlString
‚‚S a
(
‚‚a b
)
‚‚b c
,
‚‚c d
retornoXmlString
‚‚e u
,
‚‚u v
	retRecibo
„„ 
)
„„ 
;
„„ 
}
ÊÊ 	
public
ÙÙ #
RetornoNFeAutorizacao
ÙÙ $
NFeAutorizacao
ÙÙ% 3
(
ÙÙ3 4
int
ÙÙ4 7
idLote
ÙÙ8 >
,
ÙÙ> ?$
IndicadorSincronizacao
ÙÙ@ V
indSinc
ÙÙW ^
,
ÙÙ^ _
List
ÙÙ` d
<
ÙÙd e
Classes
ÙÙe l
.
ÙÙl m
NFe
ÙÙm p
>
ÙÙp q
nFes
ÙÙr v
,
ÙÙv w
bool
ıı 
compactarMensagem
ıı "
=
ıı# $
false
ıı% *
)
ıı* +
{
ˆˆ 	
var
˜˜ 
versaoServico
˜˜ 
=
˜˜ 

ServicoNFe
˜˜  *
.
˜˜* +
NFeAutorizacao
˜˜+ 9
.
˜˜9 :%
VersaoServicoParaString
˜˜: Q
(
˜˜Q R
_cFgServico
˜˜R ]
.
˜˜] ^"
VersaoNFeAutorizacao
˜˜^ r
)
˜˜r s
;
˜˜s t
var
˚˚ 
ws
˚˚ 
=
˚˚ %
CriarServicoAutorizacao
˚˚ ,
(
˚˚, -

ServicoNFe
˚˚- 7
.
˚˚7 8
NFeAutorizacao
˚˚8 F
)
˚˚F G
;
˚˚G H
ws
˝˝ 
.
˝˝ 
nfeCabecMsg
˝˝ 
=
˝˝ 
new
˝˝  
nfeCabecMsg
˝˝! ,
{
˛˛ 
cUF
ˇˇ 
=
ˇˇ 
_cFgServico
ˇˇ !
.
ˇˇ! "
cUF
ˇˇ" %
,
ˇˇ% &
versaoDados
Ä	Ä	 
=
Ä	Ä	 
versaoServico
Ä	Ä	 +
}
Å	Å	 
;
Å	Å	 
var
á	á	 
pedEnvio
á	á	 
=
á	á	 
new
á	á	 
enviNFe3
á	á	 '
(
á	á	' (
versaoServico
á	á	( 5
,
á	á	5 6
idLote
á	á	7 =
,
á	á	= >
indSinc
á	á	? F
,
á	á	F G
nFes
á	á	H L
)
á	á	L M
;
á	á	M N
var
ç	ç	 
xmlEnvio
ç	ç	 
=
ç	ç	 
pedEnvio
ç	ç	 #
.
ç	ç	# $
ObterXmlString
ç	ç	$ 2
(
ç	ç	2 3
)
ç	ç	3 4
;
ç	ç	4 5
if
é	é	 
(
é	é	 
_cFgServico
é	é	 
.
é	é	 
cUF
é	é	 
==
é	é	  "
	EstadoNfe
é	é	# ,
.
é	é	, -
PR
é	é	- /
)
é	é	/ 0
xmlEnvio
ê	ê	 
=
ê	ê	 
xmlEnvio
ê	ê	 #
.
ê	ê	# $
Replace
ê	ê	$ +
(
ê	ê	+ ,
$str
ê	ê	, 3
,
ê	ê	3 4
$str
ê	ê	5 i
)
ê	ê	i j
;
ê	ê	j k
	Validador
í	í	 
.
í	í	 
Valida
í	í	 
(
í	í	 

ServicoNFe
í	í	 '
.
í	í	' (
NFeAutorizacao
í	í	( 6
,
í	í	6 7
_cFgServico
í	í	8 C
.
í	í	C D"
VersaoNFeAutorizacao
í	í	D X
,
í	í	X Y
xmlEnvio
í	í	Z b
)
í	í	b c
;
í	í	c d
var
ì	ì	 

dadosEnvio
ì	ì	 
=
ì	ì	 
new
ì	ì	  
XmlDocument
ì	ì	! ,
(
ì	ì	, -
)
ì	ì	- .
;
ì	ì	. /

dadosEnvio
î	î	 
.
î	î	 
LoadXml
î	î	 
(
î	î	 
xmlEnvio
î	î	 '
)
î	î	' (
;
î	î	( )
XmlNode
ò	ò	 
retorno
ò	ò	 
;
ò	ò	 
try
ô	ô	 
{
ö	ö	 
if
õ	õ	 
(
õ	õ	 
compactarMensagem
õ	õ	 %
)
õ	õ	% &
{
ú	ú	 
var
ù	ù	 
xmlCompactado
ù	ù	 %
=
ù	ù	& '
Convert
ù	ù	( /
.
ù	ù	/ 0
ToBase64String
ù	ù	0 >
(
ù	ù	> ?

Compressao
ù	ù	? I
.
ù	ù	I J
Zip
ù	ù	J M
(
ù	ù	M N
xmlEnvio
ù	ù	N V
)
ù	ù	V W
)
ù	ù	W X
;
ù	ù	X Y
retorno
û	û	 
=
û	û	 
ws
û	û	  
.
û	û	  !

ExecuteZip
û	û	! +
(
û	û	+ ,
xmlCompactado
û	û	, 9
)
û	û	9 :
;
û	û	: ;
}
ü	ü	 
else
†	†	 
{
°	°	 
retorno
¢	¢	 
=
¢	¢	 
ws
¢	¢	  
.
¢	¢	  !
Execute
¢	¢	! (
(
¢	¢	( )

dadosEnvio
¢	¢	) 3
)
¢	¢	3 4
;
¢	¢	4 5
}
£	£	 
}
§	§	 
catch
•	•	 
(
•	•	 
WebException
•	•	 
ex
•	•	  "
)
•	•	" #
{
¶	¶	 
throw
ß	ß	 )
FabricaComunicacaoException
ß	ß	 1
.
ß	ß	1 2
ObterException
ß	ß	2 @
(
ß	ß	@ A

ServicoNFe
ß	ß	A K
.
ß	ß	K L
NFeAutorizacao
ß	ß	L Z
,
ß	ß	Z [
ex
ß	ß	\ ^
)
ß	ß	^ _
;
ß	ß	_ `
}
®	®	 
var
™	™	 
retornoXmlString
™	™	  
=
™	™	! "
retorno
™	™	# *
.
™	™	* +
OuterXml
™	™	+ 3
;
™	™	3 4
var
´	´	 
retEnvio
´	´	 
=
´	´	 
new
´	´	 

retEnviNFe
´	´	 )
(
´	´	) *
)
´	´	* +
.
´	´	+ ,!
CarregarDeXmlString
´	´	, ?
(
´	´	? @
retornoXmlString
´	´	@ P
)
´	´	P Q
;
´	´	Q R
return
Ø	Ø	 
new
Ø	Ø	 #
RetornoNFeAutorizacao
Ø	Ø	 ,
(
Ø	Ø	, -
pedEnvio
Ø	Ø	- 5
.
Ø	Ø	5 6
ObterXmlString
Ø	Ø	6 D
(
Ø	Ø	D E
)
Ø	Ø	E F
,
Ø	Ø	F G
retEnvio
Ø	Ø	H P
.
Ø	Ø	P Q
ObterXmlString
Ø	Ø	Q _
(
Ø	Ø	_ `
)
Ø	Ø	` a
,
Ø	Ø	a b
retornoXmlString
Ø	Ø	c s
,
Ø	Ø	s t
retEnvio
Ø	Ø	u }
)
Ø	Ø	} ~
;
Ø	Ø	~ 
}
≤	≤	 	
public
π	π	 &
RetornoNFeRetAutorizacao
π	π	 '
NFeRetAutorizacao
π	π	( 9
(
π	π	9 :
string
π	π	: @
recibo
π	π	A G
)
π	π	G H
{
∫	∫	 	
var
ª	ª	 
versaoServico
ª	ª	 
=
ª	ª	 

ServicoNFe
ª	ª	  *
.
ª	ª	* +
NFeRetAutorizacao
ª	ª	+ <
.
ª	ª	< =%
VersaoServicoParaString
ª	ª	= T
(
ª	ª	T U
_cFgServico
ª	ª	U `
.
ª	ª	` a%
VersaoNFeRetAutorizacao
ª	ª	a x
)
ª	ª	x y
;
ª	ª	y z
var
ø	ø	 
ws
ø	ø	 
=
ø	ø	 
CriarServico
ø	ø	 !
(
ø	ø	! "

ServicoNFe
ø	ø	" ,
.
ø	ø	, -
NFeRetAutorizacao
ø	ø	- >
)
ø	ø	> ?
;
ø	ø	? @
ws
¡	¡	 
.
¡	¡	 
nfeCabecMsg
¡	¡	 
=
¡	¡	 
new
¡	¡	  
nfeCabecMsg
¡	¡	! ,
{
¬	¬	 
cUF
√	√	 
=
√	√	 
_cFgServico
√	√	 !
.
√	√	! "
cUF
√	√	" %
,
√	√	% &
versaoDados
ƒ	ƒ	 
=
ƒ	ƒ	 
versaoServico
ƒ	ƒ	 +
}
≈	≈	 
;
≈	≈	 
var
À	À	 
	pedRecibo
À	À	 
=
À	À	 
new
À	À	 
consReciNFe
À	À	  +
{
Ã	Ã	 
versao
Õ	Õ	 
=
Õ	Õ	 
versaoServico
Õ	Õ	 &
,
Õ	Õ	& '
tpAmb
Œ	Œ	 
=
Œ	Œ	 
_cFgServico
Œ	Œ	 #
.
Œ	Œ	# $
tpAmb
Œ	Œ	$ )
,
Œ	Œ	) *
nRec
œ	œ	 
=
œ	œ	 
recibo
œ	œ	 
}
–	–	 
;
–	–	 
var
÷	÷	 
	xmlRecibo
÷	÷	 
=
÷	÷	 
	pedRecibo
÷	÷	 %
.
÷	÷	% &
ObterXmlString
÷	÷	& 4
(
÷	÷	4 5
)
÷	÷	5 6
;
÷	÷	6 7
var
◊	◊	 
dadosRecibo
◊	◊	 
=
◊	◊	 
new
◊	◊	 !
XmlDocument
◊	◊	" -
(
◊	◊	- .
)
◊	◊	. /
;
◊	◊	/ 0
dadosRecibo
ÿ	ÿ	 
.
ÿ	ÿ	 
LoadXml
ÿ	ÿ	 
(
ÿ	ÿ	  
	xmlRecibo
ÿ	ÿ	  )
)
ÿ	ÿ	) *
;
ÿ	ÿ	* +
XmlNode
‹	‹	 
retorno
‹	‹	 
;
‹	‹	 
try
›	›	 
{
ﬁ	ﬁ	 
retorno
ﬂ	ﬂ	 
=
ﬂ	ﬂ	 
ws
ﬂ	ﬂ	 
.
ﬂ	ﬂ	 
Execute
ﬂ	ﬂ	 $
(
ﬂ	ﬂ	$ %
dadosRecibo
ﬂ	ﬂ	% 0
)
ﬂ	ﬂ	0 1
;
ﬂ	ﬂ	1 2
}
‡	‡	 
catch
·	·	 
(
·	·	 
WebException
·	·	 
ex
·	·	  "
)
·	·	" #
{
‚	‚	 
throw
„	„	 )
FabricaComunicacaoException
„	„	 1
.
„	„	1 2
ObterException
„	„	2 @
(
„	„	@ A

ServicoNFe
„	„	A K
.
„	„	K L
NFeRetAutorizacao
„	„	L ]
,
„	„	] ^
ex
„	„	_ a
)
„	„	a b
;
„	„	b c
}
‰	‰	 
var
Ê	Ê	 
retornoXmlString
Ê	Ê	  
=
Ê	Ê	! "
retorno
Ê	Ê	# *
.
Ê	Ê	* +
OuterXml
Ê	Ê	+ 3
;
Ê	Ê	3 4
var
Á	Á	 
	retRecibo
Á	Á	 
=
Á	Á	 
new
Á	Á	 
retConsReciNFe
Á	Á	  .
(
Á	Á	. /
)
Á	Á	/ 0
.
Á	Á	0 1!
CarregarDeXmlString
Á	Á	1 D
(
Á	Á	D E
retornoXmlString
Á	Á	E U
)
Á	Á	U V
;
Á	Á	V W
return
Î	Î	 
new
Î	Î	 &
RetornoNFeRetAutorizacao
Î	Î	 /
(
Î	Î	/ 0
	pedRecibo
Î	Î	0 9
.
Î	Î	9 :
ObterXmlString
Î	Î	: H
(
Î	Î	H I
)
Î	Î	I J
,
Î	Î	J K
	retRecibo
Î	Î	L U
.
Î	Î	U V
ObterXmlString
Î	Î	V d
(
Î	Î	d e
)
Î	Î	e f
,
Î	Î	f g
retornoXmlString
Î	Î	h x
,
Î	Î	x y
	retReciboÎ	Î	z É
)Î	Î	É Ñ
;Î	Î	Ñ Ö
}
Ó	Ó	 	
public
ˆ	ˆ	  
RetornoNfeDownload
ˆ	ˆ	 !
NfeDownloadNf
ˆ	ˆ	" /
(
ˆ	ˆ	/ 0
string
ˆ	ˆ	0 6
cnpj
ˆ	ˆ	7 ;
,
ˆ	ˆ	; <
List
ˆ	ˆ	= A
<
ˆ	ˆ	A B
string
ˆ	ˆ	B H
>
ˆ	ˆ	H I
chaves
ˆ	ˆ	J P
)
ˆ	ˆ	P Q
{
˜	˜	 	
var
¯	¯	 
versaoServico
¯	¯	 
=
¯	¯	 

ServicoNFe
¯	¯	  *
.
¯	¯	* +
NfeDownloadNF
¯	¯	+ 8
.
¯	¯	8 9%
VersaoServicoParaString
¯	¯	9 P
(
¯	¯	P Q
_cFgServico
¯	¯	Q \
.
¯	¯	\ ]!
VersaoNfeDownloadNF
¯	¯	] p
)
¯	¯	p q
;
¯	¯	q r
var
˝	˝	 
ws
˝	˝	 
=
˝	˝	 
CriarServico
˝	˝	 !
(
˝	˝	! "

ServicoNFe
˝	˝	" ,
.
˝	˝	, - 
NFeDistribuicaoDFe
˝	˝	- ?
)
˝	˝	? @
;
˝	˝	@ A
ws
Ä
Ä
 
.
Ä
Ä
 
nfeCabecMsg
Ä
Ä
 
=
Ä
Ä
 
new
Ä
Ä
  
nfeCabecMsg
Ä
Ä
! ,
{
Å
Å
 
cUF
Ç
Ç
 
=
Ç
Ç
 
_cFgServico
Ç
Ç
 !
.
Ç
Ç
! "
cUF
Ç
Ç
" %
,
Ç
Ç
% &
versaoDados
Ñ
Ñ
 
=
Ñ
Ñ
 
$str
Ñ
Ñ
0 6
}
Ö
Ö
 
;
Ö
Ö
 
var
ã
ã
 
pedDownload
ã
ã
 
=
ã
ã
 
new
ã
ã
 !
downloadNFe
ã
ã
" -
{
å
å
 
versao
é
é
 
=
é
é
 
$str
é
é
+ 1
,
é
é
1 2
CNPJ
è
è
 
=
è
è
 
cnpj
è
è
 
,
è
è
 
tpAmb
ê
ê
 
=
ê
ê
 
_cFgServico
ê
ê
 #
.
ê
ê
# $
tpAmb
ê
ê
$ )
,
ê
ê
) *
chNFe
ë
ë
 
=
ë
ë
 
chaves
ë
ë
 
}
í
í
 
;
í
í
 
var
ò
ò
 
xmlDownload
ò
ò
 
=
ò
ò
 
pedDownload
ò
ò
 )
.
ò
ò
) *
ObterXmlString
ò
ò
* 8
(
ò
ò
8 9
)
ò
ò
9 :
;
ò
ò
: ;
	Validador
ö
ö
 
.
ö
ö
 
Valida
ö
ö
 
(
ö
ö
 

ServicoNFe
ö
ö
 '
.
ö
ö
' ( 
NFeDistribuicaoDFe
ö
ö
( :
,
ö
ö
: ;
_cFgServico
ö
ö
< G
.
ö
ö
G H!
VersaoNfeDownloadNF
ö
ö
H [
,
ö
ö
[ \
xmlDownload
ö
ö
] h
)
ö
ö
h i
;
ö
ö
i j
var
ú
ú
 
dadosDownload
ú
ú
 
=
ú
ú
 
new
ú
ú
  #
XmlDocument
ú
ú
$ /
(
ú
ú
/ 0
)
ú
ú
0 1
;
ú
ú
1 2
dadosDownload
ù
ù
 
.
ù
ù
 
LoadXml
ù
ù
 !
(
ù
ù
! "
xmlDownload
ù
ù
" -
)
ù
ù
- .
;
ù
ù
. /
XmlNode
°
°
 
retorno
°
°
 
;
°
°
 
try
¢
¢
 
{
£
£
 
retorno
§
§
 
=
§
§
 
ws
§
§
 
.
§
§
 
Execute
§
§
 $
(
§
§
$ %
dadosDownload
§
§
% 2
)
§
§
2 3
;
§
§
3 4
}
•
•
 
catch
¶
¶
 
(
¶
¶
 
WebException
¶
¶
 
ex
¶
¶
  "
)
¶
¶
" #
{
ß
ß
 
throw
®
®
 )
FabricaComunicacaoException
®
®
 1
.
®
®
1 2
ObterException
®
®
2 @
(
®
®
@ A

ServicoNFe
®
®
A K
.
®
®
K L
NfeDownloadNF
®
®
L Y
,
®
®
Y Z
ex
®
®
[ ]
)
®
®
] ^
;
®
®
^ _
}
©
©
 
var
´
´
 
retornoXmlString
´
´
  
=
´
´
! "
retorno
´
´
# *
.
´
´
* +
OuterXml
´
´
+ 3
;
´
´
3 4
var
¨
¨
 
retDownload
¨
¨
 
=
¨
¨
 
new
¨
¨
 !
retDownloadNFe
¨
¨
" 0
(
¨
¨
0 1
)
¨
¨
1 2
.
¨
¨
2 3!
CarregarDeXmlString
¨
¨
3 F
(
¨
¨
F G
retornoXmlString
¨
¨
G W
)
¨
¨
W X
;
¨
¨
X Y
return
∞
∞
 
new
∞
∞
  
RetornoNfeDownload
∞
∞
 )
(
∞
∞
) *
pedDownload
∞
∞
* 5
.
∞
∞
5 6
ObterXmlString
∞
∞
6 D
(
∞
∞
D E
)
∞
∞
E F
,
∞
∞
F G
retDownload
∞
∞
H S
.
∞
∞
S T
ObterXmlString
∞
∞
T b
(
∞
∞
b c
)
∞
∞
c d
,
∞
∞
d e
retornoXmlString
∞
∞
f v
,
∞
∞
v w
retDownload∞
∞
x É
)∞
∞
É Ñ
;∞
∞
Ñ Ö
}
≥
≥
 	
public
∑
∑
 
RetornoAdmCscNFCe
∑
∑
  

AdmCscNFCe
∑
∑
! +
(
∑
∑
+ ,
string
∑
∑
, 2
raizCnpj
∑
∑
3 ;
,
∑
∑
; <&
IdentificadorOperacaoCsc
∑
∑
= U&
identificadorOperacaoCsc
∑
∑
V n
,
∑
∑
n o
string
∑
∑
p v 
idCscASerRevogado∑
∑
w à
=∑
∑
â ä
null∑
∑
ã è
,∑
∑
è ê
string∑
∑
ë ó%
codigoCscASerRevogado∑
∑
ò ≠
=∑
∑
Æ Ø
null∑
∑
∞ ¥
)∑
∑
¥ µ
{
∏
∏
 	
var
π
π
 
versaoServico
π
π
 
=
π
π
 

ServicoNFe
π
π
  *
.
π
π
* +"
NfceAdministracaoCSC
π
π
+ ?
.
π
π
? @%
VersaoServicoParaString
π
π
@ W
(
π
π
W X
_cFgServico
π
π
X c
.
π
π
c d'
VersaoNfceAministracaoCSC
π
π
d }
)
π
π
} ~
;
π
π
~ 
var
Ω
Ω
 
ws
Ω
Ω
 
=
Ω
Ω
 
CriarServico
Ω
Ω
 !
(
Ω
Ω
! "

ServicoNFe
Ω
Ω
" ,
.
Ω
Ω
, -"
NfceAdministracaoCSC
Ω
Ω
- A
)
Ω
Ω
A B
;
Ω
Ω
B C
ws
ø
ø
 
.
ø
ø
 
nfeCabecMsg
ø
ø
 
=
ø
ø
 
new
ø
ø
  
nfeCabecMsg
ø
ø
! ,
{
¿
¿
 
cUF
¡
¡
 
=
¡
¡
 
_cFgServico
¡
¡
 !
.
¡
¡
! "
cUF
¡
¡
" %
,
¡
¡
% &
versaoDados
¬
¬
 
=
¬
¬
 
versaoServico
¬
¬
 +
}
√
√
 
;
√
√
 
var
…
…
 

admCscNFCe
…
…
 
=
…
…
 
new
…
…
  

admCscNFCe
…
…
! +
{
 
 
 
versao
À
À
 
=
À
À
 
versaoServico
À
À
 &
,
À
À
& '
tpAmb
Ã
Ã
 
=
Ã
Ã
 
_cFgServico
Ã
Ã
 #
.
Ã
Ã
# $
tpAmb
Ã
Ã
$ )
,
Ã
Ã
) *
indOp
Õ
Õ
 
=
Õ
Õ
 &
identificadorOperacaoCsc
Õ
Õ
 0
,
Õ
Õ
0 1
raizCNPJ
Œ
Œ
 
=
Œ
Œ
 
raizCnpj
Œ
Œ
 #
}
œ
œ
 
;
œ
œ
 
if
—
—
 
(
—
—
 &
identificadorOperacaoCsc
—
—
 (
==
—
—
) +&
IdentificadorOperacaoCsc
—
—
, D
.
—
—
D E
ioRevogaCscAtivo
—
—
E U
)
—
—
U V
{
“
“
 

admCscNFCe
”
”
 
.
”
”
 
dadosCsc
”
”
 #
=
”
”
$ %
new
”
”
& )
dadosCsc
”
”
* 2
{
‘
‘
 
	codigoCsc
’
’
 
=
’
’
 #
codigoCscASerRevogado
’
’
  5
,
’
’
5 6
idCsc
÷
÷
 
=
÷
÷
 
idCscASerRevogado
÷
÷
 -
}
◊
◊
 
;
◊
◊
 
}
ÿ
ÿ
 
var
ﬁ
ﬁ
 
xmlAdmCscNfe
ﬁ
ﬁ
 
=
ﬁ
ﬁ
 

admCscNFCe
ﬁ
ﬁ
 )
.
ﬁ
ﬁ
) *
ObterXmlString
ﬁ
ﬁ
* 8
(
ﬁ
ﬁ
8 9
)
ﬁ
ﬁ
9 :
;
ﬁ
ﬁ
: ;
var
ﬂ
ﬂ
 "
dadosAdmnistracaoCsc
ﬂ
ﬂ
 $
=
ﬂ
ﬂ
% &
new
ﬂ
ﬂ
' *
XmlDocument
ﬂ
ﬂ
+ 6
(
ﬂ
ﬂ
6 7
)
ﬂ
ﬂ
7 8
;
ﬂ
ﬂ
8 9"
dadosAdmnistracaoCsc
‡
‡
  
.
‡
‡
  !
LoadXml
‡
‡
! (
(
‡
‡
( )
xmlAdmCscNfe
‡
‡
) 5
)
‡
‡
5 6
;
‡
‡
6 7
XmlNode
‰
‰
 
retorno
‰
‰
 
;
‰
‰
 
try
Â
Â
 
{
Ê
Ê
 
retorno
Á
Á
 
=
Á
Á
 
ws
Á
Á
 
.
Á
Á
 
Execute
Á
Á
 $
(
Á
Á
$ %"
dadosAdmnistracaoCsc
Á
Á
% 9
)
Á
Á
9 :
;
Á
Á
: ;
}
Ë
Ë
 
catch
È
È
 
(
È
È
 
WebException
È
È
 
ex
È
È
  "
)
È
È
" #
{
Í
Í
 
throw
Î
Î
 )
FabricaComunicacaoException
Î
Î
 1
.
Î
Î
1 2
ObterException
Î
Î
2 @
(
Î
Î
@ A

ServicoNFe
Î
Î
A K
.
Î
Î
K L"
NfceAdministracaoCSC
Î
Î
L `
,
Î
Î
` a
ex
Î
Î
b d
)
Î
Î
d e
;
Î
Î
e f
}
Ï
Ï
 
var
Ó
Ó
 
retornoXmlString
Ó
Ó
  
=
Ó
Ó
! "
retorno
Ó
Ó
# *
.
Ó
Ó
* +
OuterXml
Ó
Ó
+ 3
;
Ó
Ó
3 4
var
Ô
Ô
 
retCsc
Ô
Ô
 
=
Ô
Ô
 
new
Ô
Ô
 
retAdmCscNFCe
Ô
Ô
 *
(
Ô
Ô
* +
)
Ô
Ô
+ ,
.
Ô
Ô
, -!
CarregarDeXmlString
Ô
Ô
- @
(
Ô
Ô
@ A
retornoXmlString
Ô
Ô
A Q
)
Ô
Ô
Q R
;
Ô
Ô
R S
return
Û
Û
 
new
Û
Û
 
RetornoAdmCscNFCe
Û
Û
 (
(
Û
Û
( )

admCscNFCe
Û
Û
) 3
.
Û
Û
3 4
ObterXmlString
Û
Û
4 B
(
Û
Û
B C
)
Û
Û
C D
,
Û
Û
D E
retCsc
Û
Û
F L
.
Û
Û
L M
ObterXmlString
Û
Û
M [
(
Û
Û
[ \
)
Û
Û
\ ]
,
Û
Û
] ^
retornoXmlString
Û
Û
_ o
,
Û
Û
o p
retCsc
Û
Û
q w
)
Û
Û
w x
;
Û
Û
x y
}
ˆ
ˆ
 	
private
˛
˛
 
bool
˛
˛
 
	_disposed
˛
˛
 
;
˛
˛
 
private
ÅÅ 
void
ÅÅ 
Dispose
ÅÅ 
(
ÅÅ 
bool
ÅÅ !
	disposing
ÅÅ" +
)
ÅÅ+ ,
{
ÇÇ 	
if
ÉÉ 
(
ÉÉ 
	_disposed
ÉÉ 
)
ÉÉ 
return
ÑÑ 
;
ÑÑ 
if
ÜÜ 
(
ÜÜ 
	disposing
ÜÜ 
)
ÜÜ 
if
áá 
(
áá 
!
áá 
_cFgServico
áá  
.
áá  !
Certificado
áá! ,
.
áá, - 
ManterDadosEmCache
áá- ?
)
áá? @
_certificado
àà  
.
àà  !
Reset
àà! &
(
àà& '
)
àà' (
;
àà( )
	_disposed
ââ 
=
ââ 
true
ââ 
;
ââ 
}
ää 	
public
åå 
void
åå 
Dispose
åå 
(
åå 
)
åå 
{
çç 	
Dispose
éé 
(
éé 
true
éé 
)
éé 
;
éé 
GC
èè 
.
èè 
SuppressFinalize
èè 
(
èè  
this
èè  $
)
èè$ %
;
èè% &
}
êê 	
~
íí 	
ServicosNFe
íí	 
(
íí 
)
íí 
{
ìì 	
Dispose
îî 
(
îî 
false
îî 
)
îî 
;
îî 
}
ïï 	
}
òò 
}ôô 